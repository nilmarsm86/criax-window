var AcceptEventAction=function(b){b=b||{};AcceptEventAction.baseConstructor.call(this,b)};JSFun.extend(AcceptEventAction,Rectangular);AcceptEventAction.prototype.getLinkCentered=function(o,p){if(this._selectedFigure){return AcceptEventAction.base.getLinkCentered.call(this,o,p)}if(o instanceof Point){p=o.getY();o=o.getX()}var q=this.getCentralPoint();var t=q.getX();var u=q.getY();var w,m,r,s;w=this.getX();m=this.getY();r=q.getX();s=this.getY();if(o<t){if(p<u){var v;v=(this.getY()-u)/(this.getX()-t);if(((p-u)==0)||Math.abs((p-u)/(o-t))<Math.abs(v)){r=this.getX()+25;s=this.getY()+this.getHeight()/2}else{r=this.getX()+this.getWidth();s=this.getY()}}else{var v;v=(this.getY()+this.getHeight()-u)/(this.getX()-t);if(((p-u)==0)||Math.abs((p-u)/(o-t))<Math.abs(v)){w=this.getX()+25;m=this.getY()+this.getHeight()/2;r=this.getX();s=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}}}else{if(p<u){var v;v=(this.getY()-u)/(this.getX()+this.getWidth()-t);if(((p-u)==0)||((p-u)/(o-t))<v){r=this.getX()+this.getWidth();s=this.getY()}else{w=this.getX()+this.getWidth();r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}}else{var v;v=(this.getY()+this.getHeight()-u)/(this.getX()+this.getWidth()-t);if(((p-u)==0)||((p-u)/(o-t))<v){w=this.getX()+this.getWidth();r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(w,m,r,s,o,p,q.getX(),q.getY())};AcceptEventAction.prototype.calculateSize=function(){if(this._selectedFigure){AcceptEventAction.base.calculateSize.call(this);return}if(this._components.length>0){var f;var g=0;var h=0;var e;for(e in this._components){f=this._components[e];if(f.getPosition()==Component.Float||f.getPosition()==Component.BottomLeft||f.getPosition()==Component.BottomRight){h+=f.getHeight();if(f.getWidth()>g){g=f.getWidth()}}}if(this._container){if(h>this._minHeight){this.setMinHeight(h)}if(g>this._minWidth){this.setMinWidth(g+25)}}else{if(h>0){this.setMinHeight(h)}if(g>0){this.setMinWidth(g+25)}}}};AcceptEventAction.prototype.updateComponents=function(){if(this._components.length>0){this.calculateSize();this.insertComponents(this._x+25,this._y,this._width-25,this._height);var b;for(b in this._relations){this._relations[b].notifyChange()}}};AcceptEventAction.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};AcceptEventAction.prototype.setName=function(b){this._components[1].setValue(b)};AcceptEventAction.prototype.getStereotypes=function(){var f=this._components[0]._childs;var e=[];for(var d=0;d<f.length;d++){e.push(f[d]._text)}return e};AcceptEventAction.prototype.getName=function(){return this._components[1].getValue()};AcceptEventAction.prototype.getStereotype=function(){return this._components[0]};var ActivityDiagram=function(b){ActivityDiagram.baseConstructor.call(this,b)};JSFun.extend(ActivityDiagram,Diagram);ActivityDiagram.prototype._instantiateElements=function(l,m,f){f=f||null;var h=this._instantiateObjectFromString(l.nodeName,f);if(h){m[l.getAttribute("id")]=h;var g;for(g=0;g<l.childNodes.length;g++){if(h instanceof SuperNode&&l.childNodes[g].nodeName=="Swimlane"){this._instantiateElements(l.childNodes[g],m,h)}else{this._instantiateElements(l.childNodes[g],m)}}}};ActivityDiagram.prototype._instantiateObjectFromString=function(elemName,parent){if(JSFun.isString(elemName)){parent=parent||null;var i;for(i in this._validElements){if(elemName==this._validElements[i]){if(elemName=="UMLHorizontalHierarchicalSwimlane"||elemName=="UMLVerticalHierarchicalSwimlane"||elemName=="UMLHorizontalSwimlane"||elemName=="UMLVerticalSwimlane"||elemName=="UMLFlow"){var setElementXml=true;return eval("new "+this._validElements[i]+"({ setElementXml: "+setElementXml+"})")}else{if(parent){return(new window[this._validElements[i]]({addComponent:false,parent:parent}))}else{return eval("new "+this._validElements[i]+"()")}}}}}else{return null}};ActivityDiagram.prototype.setXML=function(g,l){var l=l||[];var m=[];if(this._alone){var h=g.getElementsByTagName(this.getType())[0];if(!h){return false}}else{var h=g}this._name.setValue(h.getAttribute("name"));if(h.getAttribute("backgroundNodes")){this._backgroundNodes=h.getAttribute("backgroundNodes")}this._stereotypes=l;var n=h.childNodes;var o;for(o=0;o<n.length;o++){this._instantiateElements(n[o],m)}for(o=0;o<n.length;o++){this._addElementXML(n[o],m,null)}for(o=0;o<this._relations.length;o++){this._relations[o].notifyChange()}this._sortNodesByArea();return true};var ConnectorActivity=function(b){b=b||{};ConnectorActivity.baseConstructor.call(this,b)};JSFun.extend(ConnectorActivity,Elliptical);ConnectorActivity.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};ConnectorActivity.prototype.setName=function(b){this._components[1].setValue(b)};ConnectorActivity.prototype.getStereotypes=function(){return this._components[0]._childs};ConnectorActivity.prototype.getName=function(){return this._components[1].getValue()};ConnectorActivity.prototype.getStereotype=function(){return this._components[0]};var DataStore=function(b){b=b||{};DataStore.baseConstructor.call(this,b)};JSFun.extend(DataStore,Rectangular);DataStore.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};DataStore.prototype.setName=function(b){this._components[2].setValue(b)};DataStore.prototype.getStereotypes=function(){return this._components[0]._childs};DataStore.prototype.getName=function(){return this._components[2].getValue()};DataStore.prototype.getStereotype=function(){return this._components[0]};var Decision_MergeNode=function(b){b=b||{};Decision_MergeNode.baseConstructor.call(this,b)};JSFun.extend(Decision_MergeNode,Rhombus);Decision_MergeNode.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Decision_MergeNode.prototype.setName=function(b){this._components[1].setValue(b)};Decision_MergeNode.prototype.getStereotypes=function(){return this._components[0]._childs};Decision_MergeNode.prototype.getName=function(){return this._components[1].getValue()};Decision_MergeNode.prototype.getStereotype=function(){return this._components[0]};var ExceptionHandler=function(b){b=b||{};this._y=b.y||0;this._limitY=0;this._objA=null;this._objB=null;ExceptionHandler.baseConstructor.call(this,b)};JSFun.extend(ExceptionHandler,Relation);ExceptionHandler.prototype.select=function(e,f){this._deselectComponent();for(d=0;d<this._points.length;d++){if(Math.abs(e-this._points[d].getX())<=4&&Math.abs(f-this._points[d].getY())<=4){if(this._selected>-1){this._selectedBefore=true}this._selected=d;this._selectedPoint=true;return true}}if(this._selected>-1){if(this._isOverComponent(e,f)){this._selectedBefore=true;return true}}for(var d=0;d<this._points.length-1;d++){if(this._selectLine(this._points[d],this._points[d+1],e,f)){if(this._selected>-1){this._selectedBefore=true}this._selected=d;this._selectedLine=true;this._points.splice(this._selected+1,0,new Point(e,f));return true}}return false};ExceptionHandler.prototype.draw=function(z){ExceptionHandler.base.draw.call(this,z);z.save();z.strokeStyle="#000000";z.lineWidth=2;var t=this._points.length;var y=parseInt(t/2)-1;var A=this._points[y].getX();var p=this._points[y].getY();var q=this._points[y+1].getX();var s=this._points[y+1].getY();if(t%2!=0){var u=q;var w=s}else{var u=(A+q)/2;var w=(this._components.length)?this._components[0]._y-30:((p+s)/2-30)}var r=this._elemA.getCentralPoint();var v=r._x;var x=r._y;if(q<v){if(s<x){if(Math.abs(q-v)>Math.abs(s-x)){}else{var u=(this._components.length)?this._components[0]._x+30:((A+q)/2+30);var w=(p+s)/2}}else{if(Math.abs(q-v)>Math.abs(s-x)){}else{var u=(this._components.length)?this._components[0]._x+30:((A+q)/2+30);var w=(p+s)/2}}}else{if(s<x){if(Math.abs(q-v)<Math.abs(s-x)){var u=(this._components.length)?this._components[0]._x+30:((A+q)/2+30);var w=(p+s)/2}else{}}else{if(Math.abs(q-v)>Math.abs(s-x)){}else{var u=(this._components.length)?this._components[0]._x+30:((A+q)/2+30);var w=(p+s)/2}}}z.beginPath();z.moveTo(u-15,w);z.lineTo(u+15,w);z.lineTo(u-15,w+20);z.lineTo(u+15,w+20);z.stroke();z.restore()};ExceptionHandler.prototype.setName=function(b){this._components[1].setValue(b)};ExceptionHandler.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};ExceptionHandler.prototype.getName=function(){return this._components[1].getValue()};ExceptionHandler.prototype.getStereotypes=function(){return this._components[0]._childs};var Pin=function(b){b=b||{};Pin.baseConstructor.call(this,b);this.setAlone();this.setWidth(7);this.setHeight(14)};JSFun.extend(Pin,Rectangular);Pin.prototype.setAction=function(b){if(b instanceof Node){this._action=b}};Pin.prototype.drop=function(d,c){this.correctPosition();Pin.base.drop.call(this,d,c)};Pin.prototype.correctPosition=function(){if(!this._action){return}var s=this._action.getX();var n=this._action.getY();var r=this._action.getWidth();var q=this._action.getHeight();if(this.getHeight()>this.getWidth()){var p=this._action.getLinkCentered(this.getX()+this._width,this.getY()+this._height/2)}else{var p=this._action.getLinkCentered(this.getX()+this._width/2,this.getY()+this._height)}var h=p.getX();var o=p.getY();if(this.getHeight()>this.getWidth()){if((this._action.getY()==o)||((this._action.getY()+this._action.getHeight())==o)){var m=this.getHeight();this.setHeight(this.getWidth());this.setWidth(m)}}else{if(this.getWidth()>this.getHeight()){if((this._action.getX()==h)||((this._action.getX()+this._action.getWidth())==h)){var m=this.getHeight();this.setHeight(this.getWidth());this.setWidth(m)}}}if(this._action.getX()==h){this.setPosition(h-this._width,o-this._height/2)}else{if(this._action.getY()==o){this.setPosition(h-this._width/2,o-this._height)}else{if((this._action.getX()+this._action.getWidth())==h){this.setPosition(h,o-this._height/2)}else{if((this._action.getY()+this._action.getHeight())==o){this.setPosition(h-this._width/2,o)}}}}this.updatePositionComponents(h,o)};Pin.prototype.updatePositionComponents=function(e,g){var f=-1;if(e==this._action.getX()){f=Component.Left}else{if(e==this._action.getX()+this._action.getWidth()){f=Component.Right}else{if(g==this._action.getY()){f=Component.Top}else{if(g==this._action.getY()+this._action.getHeight()){f=Component.Bottom}}}}for(var h=0;h<this._components.length;h++){this._components[h]._setPosition(f)}this.updateComponents();this.resetMovement()};Pin.prototype.notifyChange=function(){this.updatePosition();this.correctPosition();if(this._container){this.updateContainer()}else{this.updateComponents()}};Pin.prototype.deleted=function(){Pin.base.deleted.call(this);if(this._parent){this._parent.notifyDeleted(this)}else{this._action.notifyDeleted(this)}};Pin.prototype.updatePosition=function(n,g,l){var o,h;l=l||false;if(n==undefined||g==undefined){var m=this.getMovement();var n=m.getX();var g=m.getY();for(o in this._relations){this._relations[o].updatePosition()}}else{this._x+=n;this._y+=g}this.resetMovement();for(o in this._components){this._components[o].updatePosition(n,g)}for(o in this._relations){if((this._relations[o].getParent()!==this._parent)||l){this._relations[o].notifyChange()}}if(this._container){for(o in this._nodeChilds){this._nodeChilds[o].updatePosition(n,g)}for(o in this._relationChilds){this._relationChilds[o].updatePosition(n,g)}}};Pin.prototype.calculateSize=function(){if(this._components.length>0){var h;var n=0;var o=0;var l;var m=false;var g;for(g in this._components){h=this._components[g];if(h._visible&&!(h instanceof RegionLine)&&(h.getPosition()==Component.Float||(h.getPosition()==Component.BottomLeft&&h._visible)||h.getPosition()==Component.BottomRight||h.getPosition()==Component.Xmovement)){if(h._orientation){n+=h.getWidth();if(h.getHeight()>o){o=h.getHeight()}}else{o+=h.getHeight();l=(h.getPosition()==Component.Xmovement)?(h.getWidth()+2*h._parent._Xmovement):h.getWidth();if(l>n){n=l}}}else{if(!h._visible){m=true}}}if(o==0&&m==true){o=7}if(n==0&&m==true){n=7}if(this._container&&!this._selectedFigure){if(o>this._minHeight){this.setMinHeight(o)}if(n>this._minWidth){this.setMinWidth(n)}}else{if(o>0){this.setMinHeight(o)}if(n>0){this.setMinWidth(n)}}}};Pin.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Pin.prototype.setName=function(b){this._components[1].setValue(b)};Pin.prototype.getStereotypes=function(){return this._components[0]._childs};Pin.prototype.getName=function(){return this._components[1].getValue()};Pin.prototype.getStereotype=function(){return this._components[0]};var ExpansionNode=function(b){b=b||{};ExpansionNode.baseConstructor.call(this,b);this.setWidth(7);this.setHeight(18)};JSFun.extend(ExpansionNode,Pin);ExpansionNode.prototype.correctPosition=function(){if(!this._action){return}var s=this._action.getX();var n=this._action.getY();var r=this._action.getWidth();var q=this._action.getHeight();if(this.getHeight()>this.getWidth()){var p=this._action.getLinkCentered(this.getX()+this._width,this.getY()+this._height/2)}else{var p=this._action.getLinkCentered(this.getX()+this._width/2,this.getY()+this._height)}var h=p.getX();var o=p.getY();if(this.getHeight()>this.getWidth()){if((this._action.getY()==o)||((this._action.getY()+this._action.getHeight())==o)){var m=this.getHeight();this.setHeight(this.getWidth());this.setWidth(m)}}else{if(this.getWidth()>this.getHeight()){if((this._action.getX()==h)||((this._action.getX()+this._action.getWidth())==h)){var m=this.getHeight();this.setHeight(this.getWidth());this.setWidth(m)}}}if(this._action.getX()==h){this.setPosition(h-this._width,o-this._height/2)}else{if(this._action.getY()==o){this.setPosition(h-this._width/2,o-this._height)}else{if((this._action.getX()+this._action.getWidth())==h){this.setPosition(h,o-this._height/2)}else{if((this._action.getY()+this._action.getHeight())==o){this.setPosition(h-this._width/2,o)}}}}this.updatePositionComponents(h,o)};ExpansionNode.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};ExpansionNode.prototype.setName=function(b){this._components[1].setValue(b)};ExpansionNode.prototype.getStereotypes=function(){return this._components[0]._childs};ExpansionNode.prototype.getName=function(){return this._components[1].getValue()};ExpansionNode.prototype.getStereotype=function(){return this._components[0]};var Flow=function(b){b=b||{};this._y=b.y||-1;this._x=b.x||-1;Flow.baseConstructor.call(this,b);if(b.setElementXml){}else{this._addComponents()}};JSFun.extend(Flow,Relation);Flow.prototype.setElementXML=function(o,q){var s=o.getAttribute("side_A");var m=o.getAttribute("side_B");this.setElements(q[s],q[m]);this._y=parseInt(o.getAttribute("y"));this._x=parseInt(o.getAttribute("x"));var r;var p=o.childNodes;var n=0;for(r=0;r<p.length;r++){if(p[r].nodeName=="point"){this._points[n]=new Point(parseInt(p[r].getAttribute("x")),parseInt(p[r].getAttribute("y")));n++}}this._addComponents();for(r=0;r<p.length;r++){if(p[r].nodeName=="item"){this.setValue(p[r].getAttribute("id"),p[r].getAttribute("value"))}else{if(p[r].nodeName=="superitem"){var l;for(l in this._components){if(this._components[l].getId()==p[r].getAttribute("id")){this._components[l].setComponentXML(p[r])}}}}}this._updateComponents()};Flow.prototype._addComponents=function(){this.addComponentStereotype();this.setComponentName("")};Flow.prototype.setComponentName=function(b){if(!this._name){if(this._elemA.getType()=="UMLDecision_MergeNode"){this._name=new GuardItem({id:"description",text:"[]"})}else{this._name=new TextArea({id:"name_node",text:""})}this._addComponent(this._name)}else{this._name.setText(b)}};Flow.prototype.updateName=function(){if(!this._name){return}if(this._elemA.getType()!="UMLDecision_MergeNode"&&this._name instanceof GuardItem){var b=this._name._text.join("\n");b=b.substring(1,b.length-1);this._delComponent(this._name);this._name=new TextArea({id:"name_node",text:b});this._addComponent(this._name)}else{if(this._elemA.getType()=="UMLDecision_MergeNode"&&!(this._name instanceof GuardItem)){var b="["+this._name._text.join("\n")+"]";this._delComponent(this._name);this._name=new GuardItem({id:"description",text:b});this._addComponent(this._name)}}};Flow.prototype._calculateLineEnds=function(){if(this._elemA.getType()=="UMLFork_JoinNode"||this._elemB.getType()=="UMLFork_JoinNode"){var e=this._elemA.getCentralPoint();var f=this._elemB.getCentralPoint();var g=this._points.length;var h=false;if(!this._selectedPoint&&this._elemA&&this._elemB){if(g>2){if(this._elemA.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[0].setPoint(this._elemA.getLink(this._points[1]._x,this._points[1]._y,this._elemA._x+this._x,e._y))}else{this._points[0].setPoint(this._elemA.getLink(this._points[1]._x,this._points[1]._y,e._x,this._elemA._y+this._y))}this._elemA.updateLimitSize()}else{this._points[0]=this._elemA.getLinkCentered(this._points[1])}if(this._elemB.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[g-1].setPoint(this._elemB.getLink(this._points[g-2]._x,this._points[g-2]._y,this._elemB._x+this._x,f._y))}else{this._points[g-1].setPoint(this._elemB.getLink(this._points[g-2]._x,this._points[g-2]._y,f._x,this._elemB._y+this._y))}this._elemB.updateLimitSize()}else{this._points[g-1]=this._elemB.getLinkCentered(this._points[g-2])}}else{if(this._elemA.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[0].setPoint(this._elemA.getLink(f._x,f._y,this._elemA._x+this._x,e._y))}else{this._points[0].setPoint(this._elemA.getLink(f._x,f._y,e._x,this._elemA._y+this._y))}this._elemA.updateLimitSize()}else{h=true}if(this._elemB.getType()=="UMLFork_JoinNode"){if(this._x!=-1){this._points[1].setPoint(this._elemB.getLink(e._x,e._y,this._elemB._x+this._x,f._y))}else{this._points[1].setPoint(this._elemB.getLink(e._x,e._y,f._x,this._elemB._y+this._y))}this._elemB.updateLimitSize()}else{this._points[1]=this._elemB.getLinkCentered(this._points[0].getX(),this._points[0].getY())}if(h){this._points[0]=this._elemA.getLinkCentered(this._points[1].getX(),this._points[1].getY())}}}}else{Flow.base._calculateLineEnds.call(this)}};Flow.prototype.drag=function(d,c){if(this._elemA.getType()=="UMLFork_JoinNode"||this._elemB.getType()=="UMLFork_JoinNode"){if(this._selectedLine){this._points[this._selected+1].setPoint(d,c);this._moved=true}else{if(this._selectedPoint){this._points[this._selected].setPoint(d,c);this._moved=true}}}else{Flow.base.drag.call(this,d,c)}};Flow.prototype.drop=function(f,g){if(this._moved){this._checkForNewNodes(f,g);var e;var h=this._points.length;if(this._elemA.getType()=="UMLFork_JoinNode"&&this._selected==0){e=this._elemA}else{if(this._elemB.getType()=="UMLFork_JoinNode"&&this._selected==h-1){e=this._elemB}}if(e){if(e._quadrant==1){this._x=f-e._x;this._x=(this._x>=0)?this._x:1}else{this._y=g-e._y;this._y=(this._y>=0)?this._y:1}}}else{if(this._selectedBefore){this._selectComponent(f,g)}}this._selectedLine=false;this._selectedPoint=false;this._moved=false;this._delUselessPoints();this.notifyChange()};Flow.prototype.exchangePosition=function(){var b;b=this._x;this._x=this._y;this._y=b;delete b};Flow.prototype._checkForNewNodes=function(g,h){if(this._selectedPoint&&(this._selected==0||this._selected==this._points.length-1)){var f=this._diagram.reassignRelationTo(this,g,h);if(f!=this){if(this._selected==0){if(f&&!(f.getType()=="UMLFork_JoinNode"&&this._elemB.getType()=="UMLFork_JoinNode")){var l=this._elemA;this.setElementA(f);if(l.getType()=="UMLFork_JoinNode"){l.updateLimitSize()}this.updateName()}}else{if(f&&!(f.getType()=="UMLFork_JoinNode"&&this._elemA.getType()=="UMLFork_JoinNode")){var m=this._elemB;this.setElementB(f);if(m.getType()=="UMLFork_JoinNode"){m.updateLimitSize()}}}}}};Flow.prototype.getElementXML=function(d){var c=Flow.base.getElementXML.call(this,d);c.setAttribute("y",this._y);c.setAttribute("x",this._x);return c};Flow.prototype.setName=function(b){this._components[1].setValue(b)};Flow.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Flow.prototype.getName=function(){return this._components[1].getValue()};Flow.prototype.getStereotypes=function(){return this._components[0]._childs};var FlowFinal=function(b){b=b||{};FlowFinal.baseConstructor.call(this,b)};JSFun.extend(FlowFinal,Elliptical);FlowFinal.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};FlowFinal.prototype.setName=function(b){this._components[1].setValue(b)};FlowFinal.prototype.getStereotypes=function(){return this._components[0]._childs};FlowFinal.prototype.getName=function(){return this._components[1].getValue()};FlowFinal.prototype.getStereotype=function(){return this._components[0]};var HierarchicalSwimlane=function(b){b=b||{};HierarchicalSwimlane.baseConstructor.call(this,b)};JSFun.extend(HierarchicalSwimlane,SuperNode);HierarchicalSwimlane.prototype.deleteRegion=function(l){var m;var f;if(this._orientation){var h=l.getWidth()}else{var h=l.getHeight()}for(m=0;m<this._nodeChilds.length;m++){if(this._nodeChilds[m]==l){break}}l.deleted();var g=m;if(g==(this._nodeChilds.length)){if(this._nodeChilds[g-1]._components[2]){this._nodeChilds[g-1]._components[2].notifyDelete()}}if(this._orientation){this._minWidth=this.getWidth()-h;this.setWidth(this.getWidth()-h)}else{this._minHeight=this.getHeight()-h;this.setHeight(this.getHeight()-h)}this.updateRegions();this.notifyChange(true);this.notifyDraw()};HierarchicalSwimlane.prototype.notifyChange=function(g,e,h){g=g||false;e=e||false;h=h||false;this.resetSizeComponentSwimlane();this.updateSizeComponentSwimlane();var f=this._nodeChilds;for(i=0;i<f.length;i++){if(f.length-1!=i){f[i].updateContainer(false)}else{f[i].updateContainer()}}HierarchicalSwimlane.base.notifyChange.call(this,g,e,h)};HierarchicalSwimlane.prototype.resetSizeComponentSwimlane=function(){var d=this._nodeChilds;for(var c=0;c<d.length;c++){d[c]._heightComp=(this._orientation)?(d[c]._components[0]._height+d[c]._components[1]._height):0;d[c]._widthComp=(this._orientation)?0:(d[c]._components[0]._width+d[c]._components[1]._width)}};HierarchicalSwimlane.prototype.updateSizeComponentSwimlane=function(){var d=this._nodeChilds;if(this._orientation){var e=0;for(var f=0;f<d.length;f++){if(d[f]._heightComp>e){e=d[f]._heightComp}}for(var f=0;f<d.length;f++){d[f]._heightComp=e}}else{var e=0;for(var f=0;f<d.length;f++){if(d[f]._widthComp>e){e=d[f]._widthComp}}for(var f=0;f<d.length;f++){d[f]._widthComp=e}}};HierarchicalSwimlane.prototype.updateRegions=function(x,r){x=x||false;r=r||false;var u=this._nodeChilds.length;if(this._orientation){var y=0;var s=this.getX();for(var w=0;w<u;w++){var o=this._nodeChilds[w];o.setMinHeight(this._minHeight-this._components[0].getHeight()-this._components[1].getHeight());o.setHeight(this.getHeight()-this._components[0].getHeight()-this._components[1].getHeight());if(o._components[2] instanceof RegionLine){o._components[2].setHeight(this.getHeight()-this._components[0].getHeight()-this._components[1].getHeight())}}for(w=0;w<u;w++){this._nodeChilds[w]._x=s;this._nodeChilds[w]._y=this.getY()+this._components[0].getHeight()+this._components[1].getHeight();if(w==u-1){if(x||(s+this._nodeChilds[w]._width)<(this.getWidth()+this.getX())){this._nodeChilds[w].setWidth(this.getWidth()+this.getX()-s)}else{this.setWidth(s+this._nodeChilds[w]._width-this.getX())}}s+=this._nodeChilds[w].getWidth()}for(w=0;w<u;w++){var p=this._nodeChilds[w]._x-this._nodeChilds[w]._prex;if(p>0||(p<0&&!r)){for(var v=0;v<this._nodeChilds[w]._nodeChilds.length;v++){this._nodeChilds[w]._nodeChilds[v].updatePosition(p,0,true)}}this._nodeChilds[w].resetMovement()}}else{var q=0;var t=this.getY();for(var w=0;w<u;w++){var o=this._nodeChilds[w];o.setMinWidth(this._minWidth-this._components[0].getWidth()-this._components[1].getWidth());o.setWidth(this.getWidth()-this._components[0].getWidth()-this._components[1].getWidth());if(o._components[2] instanceof RegionLine){o._components[2].setWidth(this.getWidth()-this._components[0].getWidth()-this._components[1].getWidth())}}for(w=0;w<u;w++){this._nodeChilds[w]._x=this.getX()+this._components[0].getWidth()+this._components[1].getWidth();this._nodeChilds[w]._y=t;if(w==u-1){if(x||(t+this._nodeChilds[w]._height)<(this.getHeight()+this.getY())){this._nodeChilds[w].setHeight(this.getHeight()+this.getY()-t)}else{this.setHeight(t+this._nodeChilds[w]._height-this.getY())}}t+=this._nodeChilds[w].getHeight()}var p;for(w=0;w<u;w++){p=this._nodeChilds[w]._y-this._nodeChilds[w]._prey;if(p>0||(p<0&&!r)){for(var v=0;v<this._nodeChilds[w]._nodeChilds.length;v++){this._nodeChilds[w]._nodeChilds[v].updatePosition(0,p,true)}}this._nodeChilds[w].resetMovement()}}this.updateComponents();for(w=0;w<this._nodeChilds.length;w++){this._nodeChilds[w].updateComponents()}};HierarchicalSwimlane.prototype.select=function(t,u){var z;var v=-1;this.deselectComponent();for(z=0;z<this._nodeChilds.length;z++){if(this._nodeChilds[z]._selected){v=z}this._nodeChilds[z].deselect()}if(this._diagram._activeMenu){this.removeContextualMenu()}if(this._diagram._pressMouse==true){if(this._selected){if(this._moveable&&Math.abs(t-(this._x+this._width+2.5))<=5&&Math.abs(u-(this._y+this._height+2.5))<=5){this._resizing=true;return true}var A=this._nodeChilds;for(z=0;z<A.length-1;z++){if(z==v){if(this._orientation){var r=A[z].getX()+A[z].getWidth()-7;var w=A[z].getY()+A[z]._heightComp+7;var s=A[z+1].getX()+A[z+1].getWidth()-7;var y=A[z+1].getY()+A[z+1]._heightComp+7}else{var r=A[z].getX()+A[z]._widthComp+7;var w=A[z].getY()+A[z].getHeight()-7;var s=A[z+1].getX()+A[z+1]._widthComp+7;var y=A[z+1].getY()+A[z+1].getHeight()-7}var x=this;var p=new Dialog({text:"Do you want to delete the region?",cancelable:true});if(Math.abs(t-(r))<=8&&Math.abs(u-(w))<=8){this._diagram._pressMouse=false;p.show(function(){x.deleteRegion(A[z])});return true}if(Math.abs(t-(s))<=8&&Math.abs(u-(y))<=8){this._diagram._pressMouse=false;p.show(function(){x.deleteRegion(A[z+1])});return true}}}for(z=0;z<this._nodeChilds.length;z++){var q=this._nodeChilds[z];if(q.isOverComponent(t,u)){if(q.isOverRegionLine(t,u)){q.selectComponent(t,u)}else{this._relx=t-this._x;this._rely=u-this._y;this._selectedBefore=true}return true}}if(this.isOverComponent(t,u)){this._relx=t-this._x;this._rely=u-this._y;this._selectedBefore=true;return true}}if(this.isOver(t,u)){this._relx=t-this._x;this._rely=u-this._y;this._selectedBefore=this._selected;this._selected=true;return true}else{return false}}else{if(this._diagram._pressMouseRight==true){if(this.isOver(t,u)){document.oncontextmenu=function(){return false};t=t+this._diagram._div.offsetLeft;u=u+this._diagram._div.offsetTop;this.showContextualMenu(t,u);return true}else{return false}}}};HierarchicalSwimlane.prototype.updateContainer=function(z){if(!(z==false||z==true)){z=true}if(this._container){var v;var E=(this._orientation)?(this._components[0]._height+this._components[1]._height):0;var B=(this._orientation)?0:(this._components[0]._width+this._components[1]._width);var y=this._x+B;var A=this._y+E;var D=this._x+B;var F=this._y+E;var w;var s,G,u,x;var t=this._nodeChilds.length;var C=false;for(v=0;v<t;v++){w=this._nodeChilds[v];if(w._visible){if(this._orientation){u=w._x;elemLeftY=w._y;if(v==(t-1)){s=w._x+w._minWidth}else{s=w._x+w._width}elemRigthY=w._y+w._minHeight}else{u=w._x;elemLeftY=w._y;s=w._x+w._minWidth;if(v==(t-1)){elemRigthY=w._y+w._minHeight}else{elemRigthY=w._y+w._height}s=w._x+w._minWidth}if(s>D){D=s}if(elemRigthY>F){F=elemRigthY}if(u<y){y=u}if(elemLeftY<A){A=elemLeftY}C=true}}if(C){if(y<(this._x+B)||A<(this._y+E)){this.setWidth(this._x+B-y+this._width);this.setHeight(this._y+E-A+this._height);this._x=y-B;this._y=A-E;this.setMinWidth(D-this._x);this.setMinHeight(F-this._y)}else{this.setMinWidth(D-this._x);this.setMinHeight(F-this._y)}}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&z){this._parent.updateContainer()}}};HierarchicalSwimlane.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};HierarchicalSwimlane.prototype.setName=function(b){this._components[1].setValue(b)};HierarchicalSwimlane.prototype.getStereotypes=function(){return this._components[0]._childs};HierarchicalSwimlane.prototype.getName=function(){return this._components[1].getValue()};HierarchicalSwimlane.prototype.getStereotype=function(){return this._components[0]};var UMLStereotypedElement=function(b){b=b||{};this._parent=b.parent||null;this._shownStereotype;this._appliedStereotypes=[]};UMLStereotypedElement.prototype.isDrawableStereotype=function(){var c=["UMLActor","UMLUseCase","UMLUseCaseExtended","UMLSystem","UMLSubSystem","UMLClass","UMLComponent","UMLInterfaceExtended","UMLPackage","UMLPackageContainer","UMLComComponent","UMLInterface","UMLOption","UMLAlternative","UMLLoop","UMLBreak","UMLAcceptEventAction","UMLTimeEvent","UMLSendSignalAction","UMLAction","UMLObject","UMLActivity","UMLDataStore","UMLConnectorActivity","UMLHorizontalHierarchicalSwimlane","UMLVerticalHierarchicalSwimlane","UMLSimpleState","UMLCompositeState","UMLVerticalRegion","UMLPin","UMLParameterNode","UMLExpansionNode","UMLHorizontalRegion","UMLPort","UMLTerminate","UMLEntryPoint","UMLExitPoint","UMLJunction","UMLFlowFinal"];for(var d=0;d<c.length;d++){if(this._parent.getType()==c[d]){return true}}return false};var setObjectsStereotype=function(c,d){d._stereotypes=c};UMLStereotypedElement.prototype.applyStereotype=function(f){if(!(f instanceof Stereotype)){return false}var l=this._parent;if(!l){return false}var m;var h=false;var g="\xAB"+f.getName()+"\xBB";for(m=0;m<l.getStereotype()._childs.length&&!h;m++){if(g==l.getStereotype()._childs[m]._text&&f._validMetaclass(l.getType())){h=true}}if(!h){l.addStereotype(f.getName());this._appliedStereotypes.push(f);l.setTagValues(f.getTagValues());l.notifyDraw();return true}return false};UMLStereotypedElement.prototype.showStereotype=function(f){if(!(f instanceof Stereotype)){return false}var h=this._parent;var g=false;if(!h){return false}for(var e=0;e<this._appliedStereotypes.length;e++){if(this._appliedStereotypes[e]==f){g=true;break}}if(g){if(!this.drawStereotype(f)){return false}h.notifyDraw();return true}return false};UMLStereotypedElement.prototype.drawStereotype=function(f){var h=this._parent;if(!h){return false}if(!f||!this.isDrawableStereotype()){h.setSelectedFigure(0);h.notifyDraw();h._stereotypeProperties._shownStereotype="";return false}var g=false;for(var e=0;e<h._figures.length&&!g;e++){if(h._figures[e].route&&h._figures[e].route==f.getPath()){if(!h._figures[e].foundInAssociatedStereotypes(f)){h._figures[e].addAssociatedStereotype(f)}h.setSelectedFigure(e);h._stereotypeProperties._shownStereotype="\xAB"+f.getName()+"\xBB";g=true}}if(!g&&f.getPath()){h.addFigure(new FromImageFigure({route:f.getPath(),parent:h}));h._figures[h._figures.length-1].addAssociatedStereotype(f);h.setSelectedFigure(h._figures.length-1);h.notifyDraw();h._stereotypeProperties._shownStereotype="\xAB"+f.getName()+"\xBB"}return true};UMLStereotypedElement.prototype.removeStereotype=function(e){if(!(e instanceof Stereotype)){return false}var f=false;for(var d=0;d<this._appliedStereotypes.length&&!f;d++){if(e==this._appliedStereotypes[d]){f=true}}if(f){this.removeTagValues(e);this.removeFigure(e);this.deleteStereotypeTag(e);this.removeAppliedStereotype(e)}return true};UMLStereotypedElement.prototype.removeTagValues=function(h){if(!(h instanceof Stereotype)){return false}var l=this._parent._tagValues;var m=h._components[3]._childs;var o,g;var n=false;o=0;while(l[o]){n=false;for(g=0;g<m.length&&!n;g++){if(l[o][0]==m[g].getNameTagValue()){n=true;l.splice(o,1)}}if(!n){o++}}return true};UMLStereotypedElement.prototype.removeFigure=function(d){if(!(d instanceof Stereotype)){return false}var c;for(c=0;c<this._parent._figures.length;c++){if(this._parent._figures[c] instanceof FromImageFigure&&this._parent._figures[c].foundInAssociatedStereotypes(d)){this._parent._figures[c].delAssociatedStereotype(d);if(this._parent._selectedFigure==c){this.drawStereotype(null)}if(!this._parent._figures[c]._associatedStereotypes.length){this._parent.delFigure(this._parent._figures[c]);if(this._parent._selectedFigure>c){this._parent.setSelectedFigure(this._parent._selectedFigure-1)}}return true}}return false};UMLStereotypedElement.prototype.deleteStereotypeTag=function(e){if(!(e instanceof Stereotype)){return false}var f=this._parent.getStereotype()._childs;var d;for(d in f){if(f[d]._text=="\xAB"+e.getName()+"\xBB"){f.splice(d,1);break}}this._parent.getStereotype().notifyChange()};UMLStereotypedElement.prototype.removeAppliedStereotype=function(d){for(var c=0;c<this._appliedStereotypes.length;c++){if(d==this._appliedStereotypes[c]){this._appliedStereotypes.splice(c,1)}break}};UMLStereotypedElement.prototype.changeNameStereotype=function(f,g){var h=false;for(var m=0;m<this._appliedStereotypes.length&&!h;m++){if(f==this._appliedStereotypes[m]){h=true}}if(h){var l=this._parent.getStereotype()._childs;for(m in l){if(l[m]._text=="\xAB"+f.getName()+"\xBB"){l[m].setText(g,true);if("\xAB"+f.getName()+"\xBB"==this._parent._stereotypeProperties._shownStereotype){this._parent._stereotypeProperties._shownStereotype=g}break}}this._parent.getStereotype().notifyChange()}};UMLStereotypedElement.prototype.updateElementStereotypes=function(){var h=this._parent.getStereotype()._childs;var n=[];var m=false;for(var o=0;o<this._appliedStereotypes.length;o++){m=false;if(this._appliedStereotypes[o]._validMetaclass(this._parent.getType())){for(var g=0;g<h.length&&!m;g++){if("\xAB"+this._appliedStereotypes[o].getName()+"\xBB"==h[g]._text){for(k=0;k<this._appliedStereotypes[o]._components[3]._childs.length;k++){n.push([this._appliedStereotypes[o]._components[3]._childs[k].getNameTagValue(),this._appliedStereotypes[o]._components[3]._childs[k].getDefaultValue()])}m=true}}}}var l=this._parent._tagValues;o=0;while(l[o]){m=false;for(g=0;g<n.length&&!m;g++){if(n[g][0]==l[o][0]){m=true;o++}}if(!m){l.splice(o,1)}}var l=this._parent._tagValues;for(o in n){m=false;for(g=0;g<l.length&&!m;g++){if(n[o][0]==l[g][0]){m=true}}if(!m){l.push(n[o])}}};UMLStereotypedElement.prototype.showTagValuesDialog=function(){var r=this._parent;var y=document.createElement("div");y.className="ud_popup";var x=document.createElement("form");var s=[];var u;for(u=0;u<r._tagValues.length;u++){s.push(document.createElement("input"))}var q=document.createElement("input");q.setAttribute("type","submit");q.setAttribute("value","ok");for(u=0;u<r._tagValues.length;u++){s[u].setAttribute("type","text");s[u].setAttribute("value",r._tagValues[u][1]||"")}var w=function(a){var b;for(b=0;b<r._tagValues.length;b++){r._tagValues[b][1]=s[b].value}document.body.removeChild(y)};var v=function(a){document.body.removeChild(y)};x.onsubmit=function(){return false};q.addEventListener("click",w,false);var p;var o;var t=[];for(u=0;u<s.length;u++){t.push(r._tagValues[u][0])}for(u=0;u<s.length;u++){o=document.createElement("div");p=document.createElement("label");p.appendChild(document.createTextNode(t[u]));o.appendChild(p);o.appendChild(s[u]);x.appendChild(o)}x.appendChild(q);y.appendChild(x);document.body.appendChild(y);y.style.top=(window.innerHeight-x.offsetHeight)/2+"px";y.style.left=(window.innerWidth-x.offsetWidth)/2+"px"};UMLStereotypedElement.prototype.showApplyStereotypesDialog=function(){var x=this._parent;var G=x._diagram._stereotypes;var H=document.createElement("div");H.className="ud_popup";var E=document.createElement("form");var y=[];var z,A,B;var I=[];var w=[];var u;for(z=0;z<x._components.length;z++){if(x._components[z] instanceof StereotypeFields){w=x._components[z]._childs;for(A=0;A<w.length;A++){if(!y[w[A].getValue()]){y[w[A].getValue()]=x}}}}if(x instanceof SuperNode){for(z=0;z<x._nodeChilds.length;z++){for(A=0;A<x._nodeChilds[z]._components.length;A++){if(x._nodeChilds[z]._components[A] instanceof StereotypeFields){w=x._nodeChilds[z]._components[A]._childs;for(B=0;B<w.length;B++){if(!y[w[B].getValue()]){y[w[B].getValue()]=x._nodeChilds[z]}}}}}}for(z=0;z<G.length;z++){I=G[z]._metaclass;for(A=0;A<I.length;A++){if(I[A].getName()==x.getType()){if(!y["\xAB"+G[z].getName()+"\xBB"]){y["\xAB"+G[z].getName()+"\xBB"]=x}}}}if(x instanceof SuperNode){for(B=0;B<x._nodeChilds.length;B++){u=x._nodeChilds[B];if(u._stereotypeProperties){for(z=0;z<x._diagram._stereotypes.length;z++){I=x._diagram._stereotypes[z]._metaclass;for(A=0;A<I.length;A++){if(I[A].getName()==u.getType()){if(!y["\xAB"+x._diagram._stereotypes[z].getName()+"\xBB"]){y["\xAB"+x._diagram._stereotypes[z].getName()+"\xBB"]=x._nodeChilds[B]}}}}}}}var t=false;for(z in y){t=true}if(!t){return}var D;textField=document.createElement("select");D=document.createElement("option");D.setAttribute("value","");D.appendChild(document.createTextNode("default"));textField.appendChild(D);for(z in y){D=document.createElement("option");D.setAttribute("value",z);D.appendChild(document.createTextNode(z));textField.appendChild(D)}var v=document.createElement("input");v.setAttribute("type","submit");v.setAttribute("value","ok");var F=function(a){var e=[];var f=false;var b;var c,d;for(c in y){if(textField.value==c){b=y[c];break}}for(c=0;c<G.length&&!f;c++){if(b&&G[c]._validMetaclass(b.getType())&&"\xAB"+G[c].getName()+"\xBB"==textField.value){if(b._stereotypeProperties){b._stereotypeProperties.applyStereotype(G[c])}f=true}}document.body.removeChild(H)};var C=function(a){document.body.removeChild(H)};E.onsubmit=function(){return false};v.addEventListener("click",F,false);E.appendChild(textField);E.appendChild(v);H.appendChild(E);document.body.appendChild(H);H.style.top=(window.innerHeight-E.offsetHeight)/2+"px";H.style.left=(window.innerWidth-E.offsetWidth)/2+"px"};UMLStereotypedElement.prototype.showStereotypesDialog=function(){var x=this._parent;var G=x._stereotypeProperties._appliedStereotypes;var H=document.createElement("div");H.className="ud_popup";var E=document.createElement("form");var y=[];var z,A,B;var I=[];var w=[];var u;for(z=0;z<G.length;z++){if(!y["\xAB"+G[z].getName()+"\xBB"]){y["\xAB"+G[z].getName()+"\xBB"]=x}}if(x instanceof SuperNode){for(B=0;B<x._nodeChilds.length;B++){u=x._nodeChilds[B];if(u._stereotypeProperties){for(z=0;z<G.length;z++){if(!y["\xAB"+G[z].getName()+"\xBB"]){y["\xAB"+G[z].getName()+"\xBB"]=x._nodeChilds[B]}}}}}var t=false;for(z in y){t=true}if(!t){return}var D;textField=document.createElement("select");D=document.createElement("option");D.setAttribute("value","");D.appendChild(document.createTextNode("default"));textField.appendChild(D);for(z in y){D=document.createElement("option");D.setAttribute("value",z);D.appendChild(document.createTextNode(z));if(x._stereotypeProperties._shownStereotype&&x._stereotypeProperties._shownStereotype==z){D.setAttribute("selected","selected")}textField.appendChild(D)}var v=document.createElement("input");v.setAttribute("type","submit");v.setAttribute("value","ok");var F=function(a){var e=[];var f=false;var b;var c,d;for(c in y){if(textField.value==c){b=y[c];break}}for(c=0;c<G.length&&!f;c++){if(b&&G[c]._validMetaclass(b.getType())&&"\xAB"+G[c].getName()+"\xBB"==textField.value){b._stereotypeProperties.showStereotype(G[c]);f=true}}if(!f){x._stereotypeProperties.drawStereotype(null)}document.body.removeChild(H)};var C=function(a){document.body.removeChild(H)};E.onsubmit=function(){return false};v.addEventListener("click",F,false);E.appendChild(textField);E.appendChild(v);H.appendChild(E);document.body.appendChild(H);H.style.top=(window.innerHeight-E.offsetHeight)/2+"px";H.style.left=(window.innerWidth-E.offsetWidth)/2+"px"};var setStereotypeProperties=function(b){b._stereotypeProperties=new UMLStereotypedElement({parent:b})};var setStereotypeObjects=function(c,d){if(d instanceof Diagram){d._stereotypes=c}};var StereotypeTag=function(b){b=b||{};StereotypeTag.baseConstructor.call(this,b)};JSFun.extend(StereotypeTag,StereotypeItem);StereotypeTag.prototype.setText=function(g,e){var e=e||false;var h;var f;if(JSFun.isString(g)){if(this._text!=g&&!e){if(this._parent&&this._parent instanceof SuperComponent&&this._parent._parent._stereotypeProperties){f=this._parent._parent._stereotypeProperties;for(h=0;h<f._appliedStereotypes.length;h++){if("\xAB"+f._appliedStereotypes[h].getName()+"\xBB"==this._text){this._parent._parent._stereotypeProperties.removeStereotype(f._appliedStereotypes[h]);break}}}else{if(this._parent&&this._parent._stereotypeProperties){f=this._parent._stereotypeProperties;for(h=0;h<f._appliedStereotypes.length;h++){if("\xAB"+f._appliedStereotypes[h].getName()+"\xBB"==this._text){f.removeStereotype(f._appliedStereotypes[h]);break}}}}}StereotypeTag.base.setText.call(this,g)}};StereotypeTag.prototype.setValue=function(b){this.setText(b)};StereotypeTag.prototype.getComponentXML=function(l){var f=l.createElement("item");if(this._id){f.setAttribute("id",this._id)}f.setAttribute("value",this.getValue());var g=this._parent._parent._diagram;var h=g._stereotypes;var m;for(m=0;m<h.length;m++){if("\xAB"+h[m].getName()+"\xBB"==this.getValue()){f.setAttribute("stereotypeObject",true);break}}return f};var StereotypeTagList=function(b){b=b||{};StereotypeTagList.baseConstructor.call(this,b)};JSFun.extend(StereotypeTagList,StereotypeFields);StereotypeTagList.prototype.notifyDelete=function(f){var d;var e=this._parent._stereotypeProperties;if(e){for(d=0;d<e._appliedStereotypes.length;d++){if("\xAB"+e._appliedStereotypes[d].getName()+"\xBB"==f._text){e.removeStereotype(e._appliedStereotypes[d]);break}}}this.delSubComponent(f);this.updateComponents()};StereotypeTagList.prototype.delSubComponent=function(c){var d;for(d in this._childs){if(this._childs[d]==c){this._childs.splice(d,1);break}}};StereotypeTagList.prototype.newItem=function(){return new StereotypeTag({text:"\xABstereotype\xBB",orientation:this._orientation||0})};StereotypeTagList.prototype.setComponentXML=function(g){var f;var h=g.childNodes;if(g.getAttribute("visibleSubComponents")=="true"){this._visibleSubComponents=true}else{this._visibleSubComponents=false}var e;var f;for(f=0;f<h.length;f++){if(h[f].getAttribute("stereotypeObject")=="true"){e=h[f].getAttribute("value");this.applyStereotype(e)}else{this.addField(h[f].getAttribute("value"))}}};StereotypeTagList.prototype.applyStereotype=function(h){var l=this._parent._diagram._stereotypes;var m;var h;var f,g;for(g=0;g<l.length;g++){m=l[g]._metaclass;for(f=0;f<m.length;f++){if(m[f].getName()==this._parent.getType()){if("\xAB"+l[g].getName()+"\xBB"==h){this._parent._stereotypeProperties.applyStereotype(l[g])}}}}};var Port=function(b){b=b||{};Port.baseConstructor.call(this,b);this.setAlone();this.setWidth(14);this.setHeight(14);setStereotypeProperties(this);this.addFigure(new RectangleFigure({color:"#eeeeee"}));this.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));this.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}))};JSFun.extend(Port,Rectangular);Port.prototype.drop=function(d,c){this.correctPosition();Port.base.drop.call(this,d,c)};Port.prototype.correctPosition=function(){if(!this._parent){return}var h=this._parent.getX();var m=this._parent.getY();var q=this._parent.getWidth();var p=this._parent.getHeight();var o=this._parent.getLinkCentered(this.getX()+7,this.getY()+7);var l=o.getX();var n=o.getY();this.setPosition(l-7,n-7);this.updatePositionComponents(l,n)};Port.prototype.updatePositionComponents=function(e,g){var f=-1;if(e==this._parent.getX()){f=Component.Left}else{if(e==this._parent.getX()+this._parent.getWidth()){f=Component.Right}else{if(g==this._parent.getY()){f=Component.Top}else{if(g==this._parent.getY()+this._parent.getHeight()){f=Component.Bottom}}}}for(var h=0;h<this._components.length;h++){this._components[h]._setPosition(f)}this.updateComponents()};Port.prototype.notifyChange=function(){var b;for(b in this._relations){this._relations[b].notifyChange()}this.correctPosition()};Port.prototype.deleted=function(){Port.base.deleted.call(this);this._parent.notifyDeleted(this)};Port.prototype.setName=function(b){this._components[1].setValue(b)};Port.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Port.prototype.getStereotype=function(){return this._components[0]};var NodeAction=function(b){b=b||{};NodeAction.baseConstructor.call(this,b);this._ports=[]};JSFun.extend(NodeAction,Node);NodeAction.prototype.addPort=function(b){if(b instanceof Pin){this._ports.push(b);this._diagram._addNode(b);if(this._container){b.setParent(this)}else{b.setAction(this)}b.correctPosition()}};NodeAction.prototype.setSelectedFigure=function(c){var d=NodePorts.base.setSelectedFigure.call(this,c);if(d){if(this._figures[c] instanceof FromImageFigure){for(i in this._ports){this._ports[i].setVisibility(false)}}else{for(i in this._ports){this._ports[i].setVisibility(true)}}}};NodeAction.prototype.setVisibility=function(d){NodePorts.base.setVisibility.call(this,d);var c=true;if(this._selectedFigure&&d){c=false}if(this._container&&c){for(i in this._ports){this._ports[i].setVisibility(d)}}};NodeAction.prototype.updatePosition=function(q,l,m){m=m||false;if(q==undefined&&l==undefined){var o=this.getMovement();var n=o.getX();var p=o.getY()}else{var n=q;var p=l}var h;for(h in this._ports){this._ports[h].updatePosition(n,p,m)}NodeAction.base.updatePosition.call(this,q,l,m)};NodeAction.prototype.notifyChange=function(){NodeAction.base.notifyChange.call(this);var b;for(b in this._ports){this._ports[b].correctPosition();this._ports[b].notifyChange()}};NodeAction.prototype.updateContainer=function(b){NodeAction.base.updateContainer.call(this,b);for(i in this._ports){this._ports[i].correctPosition();this._ports[i].notifyChange()}};NodeAction.prototype.deleted=function(){NodeAction.base.deleted.call(this);var b;for(b in this._ports){this._ports[b].deleted()}};NodeAction.prototype.getElementXML=function(d){var f=NodeAction.base.getElementXML.call(this,d);var e;for(e in this._ports){f.appendChild(this._ports[e].getElementXML(d))}return f};NodeAction.prototype.addChild=function(b){if(b instanceof Pin){this._ports.push(b);if(this._container){b.setParent(this)}else{b.setAction(this)}b.correctPosition();return}else{NodeAction.base.addChild.call(this,b)}};NodeAction.prototype.notifyDeleted=function(c){if(c instanceof Pin){var d;for(d in this._ports){if(this._ports[d]==c){this._ports.splice(d,1)}}}else{NodeAction.base.notifyDeleted.call(this,c)}};NodeAction.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};NodeAction.prototype.setName=function(b){this._components[1].setValue(b)};NodeAction.prototype.getStereotypes=function(){return this._components[0]._childs};NodeAction.prototype.getName=function(){return this._components[1].getValue()};NodeAction.prototype.getStereotype=function(){return this._components[0]};var NodeForkJoin=function(b){b=b||{};NodeForkJoin.baseConstructor.call(this,b);this._quadrant=1};JSFun.extend(NodeForkJoin,Rectangular);NodeForkJoin.prototype.getElementXML=function(d){var f=d.createElement(this.getType());f.setAttribute("id",this.getId());f.setAttribute("x",this.getX());f.setAttribute("y",this.getY());f.setAttribute("width",this.getWidth());f.setAttribute("height",this.getHeight());f.setAttribute("backgroundColor",this.getBackgroundColor());f.setAttribute("quadrant",this._quadrant);var e;for(e in this._components){if(this._components[e].getId()){f.appendChild(this._components[e].getComponentXML(d))}}for(e in this._nodeChilds){f.appendChild(this._nodeChilds[e].getElementXML(d))}for(e in this._relationChilds){f.appendChild(this._relationChilds[e].getElementXML(d))}return f};NodeForkJoin.prototype.setElementXML=function(g){this.setPosition(parseInt(g.getAttribute("x")),parseInt(g.getAttribute("y")));this.resetMovement();this._width=parseInt(g.getAttribute("width"));this._height=parseInt(g.getAttribute("height"));this.setBackgroundColor(g.getAttribute("backgroundColor"));if(parseInt(g.getAttribute("quadrant"))!=this._quadrant){this._minWidth=5;this._minHeight=50;this._quadrant=parseInt(g.getAttribute("quadrant"))}var e;var h=g.childNodes;for(e=0;e<h.length;e++){if(h[e].nodeName=="item"){this.setValue(h[e].getAttribute("id"),h[e].getAttribute("value"))}else{if(h[e].nodeName=="superitem"){var f;for(f in this._components){if(this._components[f].getId()==h[e].getAttribute("id")){this._components[f].setComponentXML(h[e])}}}}}};NodeForkJoin.prototype.setQuadrant=function(o){if(this._quadrant!=o){var l=this._height;var h=this._width;var n=this._minHeight;var g=this._minWidth;this.setMinHeight(g);this.setMinWidth(n);this.setHeight(h);this.setWidth(l);for(var m=this._relations.length;m--;){this._relations[m].exchangePosition()}this._quadrant=o}};NodeForkJoin.prototype.drag=function(h,l){if(this._resizing){var m=this._x;var o=this._y;if(h>m&&l>o){if(Math.abs(h-m)>Math.abs(l-o)){if(this._quadrant!=1){this.setQuadrant(1)}else{var n=h-this._x;n=Math.round(n);n=n-n%5;this.setWidth(n)}}else{if(this._quadrant!=2){this.setQuadrant(2)}else{var g=l-this._y;g=Math.round(g);g=g-g%5;this.setHeight(g)}}}else{if(this._quadrant==1){var n=h-this._x;n=Math.round(n);n=n-n%5;this.setWidth(n)}else{var g=l-this._y;g=Math.round(g);g=g-g%5;this.setHeight(g)}}}else{if(this._selected){var n=h-this._relx;var g=l-this._rely;n=Math.round(n);n=n-n%5;g=Math.round(g);g=g-g%5;this.setPosition(n,g);this._moved=true}}};NodeForkJoin.prototype.updateLimitSize=function(){var f;var d=this._relations;var e=40;if(this._quadrant==1){for(f=d.length;f--;){if(d[f]._x>e){e=d[f]._x}}this.setMinWidth(e+10)}else{for(f=d.length;f--;){if(d[f]._y>e){e=d[f]._y}}this.setMinHeight(e+10)}};NodeForkJoin.prototype.notifyDeleted=function(d){var c;for(c in this._relations){if(this._relations[c]==d){this._relations.splice(c,1)}}this.updateLimitSize()};var ObjectActivity=function(b){b=b||{};ObjectActivity.baseConstructor.call(this,b)};JSFun.extend(ObjectActivity,Rectangular);ObjectActivity.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};ObjectActivity.prototype.setName=function(b){this._components[1].setValue(b)};ObjectActivity.prototype.getStereotypes=function(){return this._components[0]._childs};ObjectActivity.prototype.getName=function(){return this._components[1].getValue()};ObjectActivity.prototype.getStereotype=function(){return this._components[0]};var ParameterNode=function(b){b=b||{};ParameterNode.baseConstructor.call(this,b);this.setWidth(60);this.setHeight(30)};JSFun.extend(ParameterNode,Pin);ParameterNode.prototype.correctPosition=function(){if(!this._parent){return}var h=this._parent.getX();var m=this._parent.getY();var q=this._parent.getWidth();var p=this._parent.getHeight();var o=this._parent.getLinkCentered(this.getX()+this._width/2,this.getY()+this._height/2);var l=o.getX();var n=o.getY();this.setPosition(l-this._width/2,n-this._height/2)};var SendSignalAction=function(b){b=b||{};SendSignalAction.baseConstructor.call(this,b)};JSFun.extend(SendSignalAction,Rectangular);SendSignalAction.prototype.getLinkCentered=function(o,p){if(this._selectedFigure){return SendSignalAction.base.getLinkCentered.call(this,o,p)}if(o instanceof Point){p=o.getY();o=o.getX()}var q=this.getCentralPoint();var t=q.getX();var u=q.getY();var w,m,r,s;var v;w=this.getX();m=this.getY();r=q.getX();s=this.getY();if(o<t){if(p<u){v=(this.getY()-u)/(this.getX()-t);if(((p-u)==0)||Math.abs((p-u)/(o-t))<Math.abs(v)){r=this.getX();s=this.getY()+this.getHeight()}else{r=this.getX()+this.getWidth();s=this.getY()}}else{v=(this.getY()+this.getHeight()-u)/(this.getX()-t);if(((p-u)==0)||Math.abs((p-u)/(o-t))<Math.abs(v)){r=this.getX();s=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}}}else{if(p<u){v=(this.getY()-u)/(this.getX()+this.getWidth()-25-t);if(((p-u)==0)||((p-u)/(o-t))<v){r=this.getX()+this.getWidth();s=this.getY()}else{w=this.getX()+this.getWidth()-25;r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()/2}}else{v=(this.getY()+this.getHeight()-u)/(this.getX()+this.getWidth()-25-t);if(((p-u)==0)||((p-u)/(o-t))<v){w=this.getX()+this.getWidth();m=this.getY()+this.getHeight()/2;r=this.getX()+this.getWidth()-25;s=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();r=this.getX()+this.getWidth()-25;s=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(w,m,r,s,o,p,q.getX(),q.getY())};SendSignalAction.prototype.calculateSize=function(){if(this._selectedFigure){SendSignalAction.base.calculateSize.call(this);return}if(this._components.length>0){var f;var g=0;var h=0;var e;for(e in this._components){f=this._components[e];if(f.getPosition()==Component.Float||f.getPosition()==Component.BottomLeft||f.getPosition()==Component.BottomRight){h+=f.getHeight();if(f.getWidth()>g){g=f.getWidth()}}}if(this._container){if(h>this._minHeight){this.setMinHeight(h)}if(g>this._minWidth){this.setMinWidth(g+25)}}else{if(h>0){this.setMinHeight(h)}if(g>0){this.setMinWidth(g+25)}}}};SendSignalAction.prototype.updateComponents=function(){if(this._components.length>0){this.calculateSize();this.insertComponents(this._x,this._y,this._width-25,this._height);var b;for(b in this._relations){this._relations[b].notifyChange()}}};SendSignalAction.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};SendSignalAction.prototype.setName=function(b){this._components[1].setValue(b)};SendSignalAction.prototype.getStereotypes=function(){return this._components[0]._childs};SendSignalAction.prototype.getName=function(){return this._components[1].getValue()};SendSignalAction.prototype.getStereotype=function(){return this._components[0]};var SwimlaneLine=function(b){b=b||{};SwimlaneLine.baseConstructor.call(this,b)};JSFun.extend(SwimlaneLine,RegionLine);SwimlaneLine.prototype.draw=function(b){b.save();b.beginPath();if(this._orientation){b.lineWidth=this._width;b.moveTo(this.getPixelX(),this.getPixelY());b.lineTo(this.getPixelX(),this.getPixelY()+this.getHeight())}else{b.lineWidth=this._height;b.moveTo(this.getPixelX(),this.getPixelY());b.lineTo(this.getPixelX()+this.getWidth(),this.getPixelY())}b.stroke();b.restore()};SwimlaneLine.prototype.drawShape=function(l){var f;var h;l.save();l.strokeStyle="#aaaaaa";if(this._parent.getParent()._orientation){l.strokeRect(this.getPixelX()-2,this.getPixelY(),this.getWidth()+4,this.getHeight())}else{l.strokeRect(this.getPixelX(),this.getPixelY()-4,this.getWidth(),this.getHeight()+6)}l.restore();l.save();l.fillStyle="#ff0000";l.beginPath();if(this._parent.getParent()._orientation){l.arc(this._parent.getX()+this._parent.getWidth()-10,this._parent.getY()+this._parent._heightComp+7,4,0,Math.PI*2,true)}else{l.arc(this._parent.getX()+this._parent._widthComp+7,this._parent.getY()+this._parent.getHeight()-10,4,0,Math.PI*2,true)}l.closePath();l.fill();l.restore();var g=this._parent.getParent()._nodeChilds;for(var m=0;m<g.length;m++){if(g[m]==this._parent){break}}l.save();l.fillStyle="#ff0000";l.beginPath();if(this._parent.getParent()._orientation){l.arc(g[m+1].getX()+g[m+1].getWidth()-10,g[m+1].getY()+g[m+1]._heightComp+7,4,0,Math.PI*2,true)}else{l.arc(g[m+1].getX()+g[m+1]._widthComp+7,g[m+1].getY()+g[m+1].getHeight()-10,4,0,Math.PI*2,true)}l.closePath();l.fill();l.restore()};var Swimlane=function(b){b=b||{};Swimlane.baseConstructor.call(this,b);this._type="Swimlane"};JSFun.extend(Swimlane,Region);Swimlane.prototype.addComponents=function(l){var l=(JSFun.isBoolean(l))?l:true;var n=this._parent._nodeChilds;var g=n.length;var o;if(g==0){if(this._parent._orientation){this.setWidth(this._parent._width)}else{this.setHeight(this._parent._height)}}if(this._parent._orientation){if(g>0&&l){n[g-1].setWidth(n[g-1].getWidth()/2);this._x=n[g-1].getX()+n[g-1].getWidth();this.setWidth(this._parent.getX()+this._parent.getWidth()-this._x)}this.addComponent(new StereotypeFields({id:"stereotypes",centered:true}));this.addComponent(new TextBox({id:"name",centered:true,margin:4}));if(g>0){var m=2.5;if(this._parent instanceof HierarchicalSwimlane){var h=this._parent.getHeight()-this._parent._components[0]._height-this._parent._components[1]._height}else{var h=this._parent.getHeight()}n[g-1].addComponent(new SwimlaneLine({id:"region",margin:0,width:m,height:h,position:Component.TopRight,orientation:1}))}}else{if(g>0&&l){n[g-1].setHeight(n[g-1].getHeight()/2);this._y=n[g-1].getY()+n[g-1].getHeight();this.setHeight(this._parent.getY()+this._parent.getHeight()-this._y)}this.addComponent(new StereotypeFields({id:"stereotypes",centered:true,orientation:1}));this.addComponent(new TextBox({id:"name",centered:true,margin:4,orientation:1}));if(g>0){var h=2.5;if(this._parent instanceof HierarchicalSwimlane){var m=this._parent.getWidth()-this._parent._components[0]._width-this._parent._components[1]._width}else{var m=this._parent.getWidth()}n[g-1].addComponent(new SwimlaneLine({id:"region",margin:0,width:m,height:h,position:Component.BottomLeft,orientation:0}))}}};Swimlane.prototype.notifyChange=function(){if(this._parent._orientation){this._heightComp=this._components[0]._height+this._components[1]._height;this._widthComp=0}else{this._heightComp=0;this._widthComp=this._components[0]._width+this._components[1]._width}this._parent.updateSizeComponentSwimlane();Swimlane.base.notifyChange.call(this)};Swimlane.prototype.updateContainer=function(D){if(!(D==false||D==true)){D=true}if(this._container){var x;this._widthComp=this._widthComp||0;this._heightComp=this._heightComp||0;var C=this._x+this._widthComp;var E=this._y+this._heightComp;var F=this._x+this._widthComp;var G=this._y+this._heightComp;var B;var u,v,w,y;for(x in this._nodeChilds){B=this._nodeChilds[x];if(B._visible){w=B._x;y=B._y;u=B._x+B._width;v=B._y+B._height;if(u>F){F=u}if(v>G){G=v}if(w<C){C=w}if(y<E){E=y}}}for(x=this._components.length;x--;){if(this._components[x] instanceof RegionLine){break}}if(x!=-1){if(this.getParent()._orientation){F+=this._components[x]._width+2}else{G+=this._components[x]._height+2}}var A=-1;var t=-1;if(this.getParent()._orientation){if((C<this._x)||(F>(this._x+this._width))){var z;for(x=0;x<this.getParent()._nodeChilds.length;x++){var I=this.getParent()._nodeChilds[x];if((I.getX()+I.getWidth())>C){if(A==-1){A=x}}if((I.getX())<F){t=x}}if((A!=-1)&&(C<this._x)){z=this._x-C+this.getParent().getWidth();this.getParent()._x=this.getParent()._x-(this._x-C);this.getParent().setWidth(z)}if(F>(this._x+this._width)){z=F-this._x-this._width+this.getParent().getWidth();this.getParent().setWidth(z)}}}else{if((E<this._y)||(G>(this._y+this._height))){for(x=0;x<this.getParent()._nodeChilds.length;x++){var I=this.getParent()._nodeChilds[x];if((I.getY()+I.getHeight())>E){if(A==-1){A=x}}if((I.getY())<G){t=x}}var H;if((A!=-1)&&(E<this._y)){H=this._y-E+this.getParent().getHeight();this.getParent()._y=this.getParent()._y-(this._y-E);this.getParent().setHeight(H)}if(G>(this._y+this._height)){H=G-this._y-this._height+this.getParent().getHeight();this.getParent().setHeight(H)}}}if(C<(this._x+this._widthComp)||E<(this._y+this._heightComp)){this.setWidth(this._x+this._widthComp-C+this._width);this.setHeight(this._y+this._heightComp-E+this._height);this._x=C-this._widthComp;this._y=E-this._heightComp;this.setMinWidth(F-this._x);this.setMinHeight(G-this._y)}else{this.setMinWidth(F-this._x);this.setMinHeight(G-this._y)}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&D){this._parent.updateContainer()}}};Swimlane.prototype.draw=function(b){if(!this._visible){return}Swimlane.base.draw.call(this,b);b.save();b.lineWidth=2.5;b.strokeStyle=ComponentStyle.component_color;b.beginPath();if(this._parent._orientation){b.moveTo(this._x,this._y+this._heightComp);b.lineTo(this._x+this._width,this._y+this._heightComp)}else{b.moveTo(this._x+this._widthComp,this._y);b.lineTo(this._x+this._widthComp,this._y+this._height)}b.closePath();b.stroke();b.restore()};Swimlane.prototype.getElementXML=function(d){var c=Swimlane.base.getElementXML.call(this,d);c.setAttribute("widthComp",this._widthComp);c.setAttribute("heightComp",this._heightComp);return c};Swimlane.prototype.setElementXML=function(b){Swimlane.base.setElementXML.call(this,b);this._widthComp=parseInt(b.getAttribute("widthComp"));this._heightComp=parseInt(b.getAttribute("heightComp"))};Swimlane.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Swimlane.prototype.setName=function(b){if(this._components[1]){this._components[1].setValue(b)}};Swimlane.prototype.getStereotypes=function(){return this._components[0]._childs};Swimlane.prototype.getName=function(){return this._components[1].getValue()};Swimlane.prototype.getStereotype=function(){return this._components[0]};var SwimlaneItem=function(b){b=b||{};SwimlaneItem.baseConstructor.call(this,b)};JSFun.extend(SwimlaneItem,RegionItem);SwimlaneItem.prototype.createRegion=function(){var d=this.getParent()._components.length;if(this.getParent()._orientation){if(this._parent instanceof HierarchicalSwimlane){var e=this.getParent()._components[0]._height+this.getParent()._components[1]._height}else{var e=0}this.getParent().addRegion(new Swimlane({parent:this.getParent(),y:this.getParent().getY()+e,x:this.getParent().getX()}))}else{if(this._parent instanceof HierarchicalSwimlane){var f=this.getParent()._components[0]._width+this.getParent()._components[1]._width}else{var f=0}this.getParent().addRegion(new Swimlane({parent:this.getParent(),y:this.getParent()._components[d-1]._getY(),x:this.getParent().getX()+f}))}};var TimeEvent=function(b){b=b||{};TimeEvent.baseConstructor.call(this,b)};JSFun.extend(TimeEvent,Rectangular);TimeEvent.prototype.getLinkCentered=function(o,p){if(this._selectedFigure){return TimeEvent.base.getLinkCentered.call(this,o,p)}if(o instanceof Point){p=o.getY();o=o.getX()}var q=this.getCentralPoint();var t=q.getX();var u=q.getY();var w,m,r,s;var v;w=this.getX();m=this.getY();r=q.getX();s=this.getY();if(o<t){if(p<u){v=(this.getY()-u)/(this.getX()-t);if(((p-u)==0)||Math.abs((p-u)/(o-t))<Math.abs(v)){r=this.getX()+this.getWidth()/2-2;s=this.getY()+this.getHeight()/2}else{r=this.getX()+this.getWidth();s=this.getY()}}else{v=(this.getY()+this.getHeight()-u)/(this.getX()-t);if(((p-u)==0)||Math.abs((p-u)/(o-t))<Math.abs(v)){w=this.getX()+this.getWidth()/2-2;m=this.getY()+this.getHeight()/2;r=this.getX();s=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}}}else{if(p<u){v=(this.getY()-u)/(this.getX()+this.getWidth()-t);if(((p-u)==0)||((p-u)/(o-t))<v){r=this.getX()+this.getWidth();s=this.getY()}else{w=this.getX()+this.getWidth();r=this.getX()+this.getWidth()/2+2;s=this.getY()+this.getHeight()/2}}else{v=(this.getY()+this.getHeight()-u)/(this.getX()+this.getWidth()-t);if(((p-u)==0)||((p-u)/(o-t))<v){w=this.getX()+this.getWidth()/2+2;m=this.getY()+this.getHeight()/2;r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();r=this.getX()+this.getWidth();s=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(w,m,r,s,o,p,q.getX(),q.getY())};TimeEvent.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};TimeEvent.prototype.setName=function(b){this._components[1].setValue(b)};TimeEvent.prototype.getStereotypes=function(){return this._components[0]._childs};TimeEvent.prototype.getName=function(){return this._components[1].getValue()};TimeEvent.prototype.getStereotype=function(){return this._components[0]};var UnhierarchicalSwimlane=function(b){b=b||{};UnhierarchicalSwimlane.baseConstructor.call(this,b)};JSFun.extend(UnhierarchicalSwimlane,SuperNode);UnhierarchicalSwimlane.prototype.deleteRegion=function(l){var m;var f;if(this._orientation){var h=l.getWidth()}else{var h=l.getHeight()}for(m=0;m<this._nodeChilds.length;m++){if(this._nodeChilds[m]==l){break}}l.deleted();var g=m;if(g==(this._nodeChilds.length)){if(this._nodeChilds[g-1]._components[2]){this._nodeChilds[g-1]._components[2].notifyDelete()}}if(this._orientation){this._minWidth=this.getWidth()-h;this.setWidth(this.getWidth()-h)}else{this._minHeight=this.getHeight()-h;this.setHeight(this.getHeight()-h)}this.notifyChange(true);this.notifyDraw()};UnhierarchicalSwimlane.prototype.notifyChange=function(f,e,d){f=f||false;e=e||false;d=d||false;this.resetSizeComponentSwimlane();this.updateSizeComponentSwimlane();UnhierarchicalSwimlane.base.notifyChange.call(this,f,e,d)};UnhierarchicalSwimlane.prototype.resetSizeComponentSwimlane=function(){var d=this._nodeChilds;for(var c=0;c<d.length;c++){d[c]._heightComp=(this._orientation)?(d[c]._components[0]._height+d[c]._components[1]._height):0;d[c]._widthComp=(this._orientation)?0:(d[c]._components[0]._width+d[c]._components[1]._width)}};UnhierarchicalSwimlane.prototype.updateSizeComponentSwimlane=function(){var d=this._nodeChilds;if(this._orientation){var e=0;for(var f=0;f<d.length;f++){if(d[f]._heightComp>e){e=d[f]._heightComp}}for(var f=0;f<d.length;f++){d[f]._heightComp=e}}else{var e=0;for(var f=0;f<d.length;f++){if(d[f]._widthComp>e){e=d[f]._widthComp}}for(var f=0;f<d.length;f++){d[f]._widthComp=e}}};UnhierarchicalSwimlane.prototype.updateRegions=function(x,r){x=x||false;r=r||false;var u=this._nodeChilds.length;if(this._orientation){var y=0;var s=this.getX();for(var w=0;w<u;w++){var o=this._nodeChilds[w];o.setMinHeight(this._minHeight);o.setHeight(this.getHeight());if(o._components[2] instanceof RegionLine){o._components[2].setHeight(this.getHeight())}}for(w=0;w<u;w++){this._nodeChilds[w]._x=s;this._nodeChilds[w]._y=this.getY();if(w==u-1){if(x||(s+this._nodeChilds[w]._width)<(this.getWidth()+this.getX())){this._nodeChilds[w].setWidth(this.getWidth()+this.getX()-s)}else{this.setWidth(s+this._nodeChilds[w]._width-this.getX())}}s+=this._nodeChilds[w].getWidth()}for(w=0;w<u;w++){var p=this._nodeChilds[w]._x-this._nodeChilds[w]._prex;if(p>0||(p<0&&!r)){for(var v=0;v<this._nodeChilds[w]._nodeChilds.length;v++){this._nodeChilds[w]._nodeChilds[v].updatePosition(p,0,true)}}this._nodeChilds[w].resetMovement()}}else{var q=0;var t=this.getY();for(var w=0;w<u;w++){var o=this._nodeChilds[w];o.setMinWidth(this._minWidth);o.setWidth(this.getWidth());if(o._components[2] instanceof RegionLine){o._components[2].setWidth(this.getWidth())}}for(w=0;w<u;w++){this._nodeChilds[w]._x=this.getX();this._nodeChilds[w]._y=t;if(w==u-1){if(x||(t+this._nodeChilds[w]._height)<(this.getHeight()+this.getY())){this._nodeChilds[w].setHeight(this.getHeight()+this.getY()-t)}else{this.setHeight(t+this._nodeChilds[w]._height-this.getY())}}t+=this._nodeChilds[w].getHeight()}for(w=0;w<u;w++){var p=this._nodeChilds[w]._y-this._nodeChilds[w]._prey;if(p>0||(p<0&&!r)){for(var v=0;v<this._nodeChilds[w]._nodeChilds.length;v++){this._nodeChilds[w]._nodeChilds[v].updatePosition(0,p,true)}}this._nodeChilds[w].resetMovement()}}this.updateComponents();for(w=0;w<this._nodeChilds.length;w++){this._nodeChilds[w].updateComponents()}};UnhierarchicalSwimlane.prototype.select=function(u,v){var A;var w=-1;this.deselectComponent();for(A=0;A<this._nodeChilds.length;A++){if(this._nodeChilds[A]._selected){w=A}this._nodeChilds[A].deselect()}if(this._diagram._activeMenu){this.removeContextualMenu()}if(this._diagram._pressMouse==true){if(this._selected){if(this._moveable&&Math.abs(u-(this._x+this._width+2.5))<=5&&Math.abs(v-(this._y+this._height+2.5))<=5){this._resizing=true;return true}var C=this._nodeChilds;for(A=0;A<C.length-1;A++){if(A==w){if(this._orientation){var s=C[A].getX()+C[A].getWidth()-7;var x=C[A].getY()+C[A]._heightComp+7;var t=C[A+1].getX()+C[A+1].getWidth()-7;var z=C[A+1].getY()+C[A+1]._heightComp+7}else{var B=C[A]._components[0]._width+C[A]._components[1]._width;var s=C[A].getX()+C[A]._widthComp+7;var x=C[A].getY()+C[A].getHeight()-7;var t=C[A+1].getX()+C[A+1]._widthComp+7;var z=C[A+1].getY()+C[A+1].getHeight()-7}var y=this;var q=new Dialog({text:"Do you want to delete the region?",cancelable:true});if(Math.abs(u-(s))<=8&&Math.abs(v-(x))<=8){this._diagram._pressMouse=false;q.show(function(){y.deleteRegion(C[A])});return true}if(Math.abs(u-(t))<=8&&Math.abs(v-(z))<=8){this._diagram._pressMouse=false;q.show(function(){y.deleteRegion(C[A+1])});return true}}}for(A=0;A<this._nodeChilds.length;A++){var r=this._nodeChilds[A];if(r.isOverComponent(u,v)){if(r.isOverRegionLine(u,v)){r.selectComponent(u,v)}else{this._relx=u-this._x;this._rely=v-this._y;this._selectedBefore=true}return true}}if(this.isOverComponent(u,v)){this._relx=u-this._x;this._rely=v-this._y;this._selectedBefore=true;return true}}if(this.isOver(u,v)){this._relx=u-this._x;this._rely=v-this._y;this._selectedBefore=this._selected;this._selected=true;return true}else{return false}}else{if(this._diagram._pressMouseRight==true){if(this.isOver(u,v)){document.oncontextmenu=function(){return false};u=u+this._diagram._div.offsetLeft;v=v+this._diagram._div.offsetTop;this.showContextualMenu(u,v);return true}else{return false}}}};UnhierarchicalSwimlane.prototype.updateContainer=function(w){if(!(w==false||w==true)){w=true}if(this._container){var s;var v=this._x;var x=this._y;var y=this._x;var z=this._y;var t;var p,A,r,u;var q=this._nodeChilds.length;for(s=0;s<q;s++){t=this._nodeChilds[s];if(this._orientation){r=t._x;elemLeftY=t._y;if(s==(q-1)){p=t._x+t._minWidth}else{p=t._x+t._width}elemRigthY=t._y+t._minHeight}else{r=t._x;elemLeftY=t._y;p=t._x+t._minWidth;if(s==(q-1)){elemRigthY=t._y+t._minHeight}else{elemRigthY=t._y+t._height}p=t._x+t._minWidth}if(p>y){y=p}if(elemRigthY>z){z=elemRigthY}if(r<v){v=r}if(elemLeftY<x){x=elemLeftY}}if(v<this._x||x<this._y){this.setWidth(this._x-v+this._width);this.setHeight(this._y-x+this._height);this._x=v;this._y=x;this.setMinWidth(y-this._x);this.setMinHeight(z-this._y)}else{this.setMinWidth(y-this._x);this.setMinHeight(z-this._y)}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&w){this._parent.updateContainer()}}};var UMLActivityDiagram=function(c){c=c||{};var d=new ActivityDiagram(c);d.setType("UMLActivityDiagram");d.setName("Activity diagram");setStereotypeObjects(c.stereotypes||[],d);d.setValidElements(["UMLAcceptEventAction","UMLTimeEvent","UMLAction","UMLObject","UMLActivity","UMLFlow","UMLActivityFinal","UMLInitialNode","UMLFlowFinal","UMLDecision_MergeNode","UMLDataStore","UMLFork_JoinNode","UMLSendSignalAction","UMLConnectorActivity","UMLHorizontalSwimlane","UMLVerticalSwimlane","UMLVerticalSwimlane","UMLHorizontalHierarchicalSwimlane","UMLVerticalHierarchicalSwimlane","UMLExceptionHandler","Region","Swimlane","UMLPin","UMLParameterNode","UMLExpansionNode","UMLNote","UMLLine"]);return d};var UMLAcceptEventAction=function(c){var c=c||{};var d=new AcceptEventAction(c);d.setType("UMLAcceptEventAction");setStereotypeProperties(d);d.setMoveable();d.setWidth(100);d.setHeight(55);d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",centered:true,margin:3}));d.addFigure(new AcceptEventActionFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLTimeEvent=function(c){var c=c||{};var d=new TimeEvent(c);d.setType("UMLTimeEvent");setStereotypeProperties(d);d.setMoveable();d.setWidth(40);d.setHeight(50);d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.addFigure(new TimeEventFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLAction=function(c){var c=c||{};var d=new NodeAction(c);d.setType("UMLAction");setStereotypeProperties(d);d.setWidth(100);d.setHeight(50);d.setMoveable();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",centered:true,margin:3}));d.addFigure(new RoundedRectangleFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLActivity=function(c){var c=c||{};var d=new NodeAction(c);d.setType("UMLActivity");setStereotypeProperties(d);d.setWidth(100);d.setHeight(50);d.setMoveable();d.setContainer();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",centered:true,margin:3}));d.addFigure(new RoundedRectangleFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLDataStore=function(c){var c=c||{};var d=new DataStore(c);d.setType("UMLDataStore");setStereotypeProperties(d);d.setWidth(100);d.setHeight(50);d.setMoveable();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new Text({centered:true,text:"\xABdatastore\xBB",margin:1}));d.addComponent(new DataStoreItem({id:"name",centered:true,margin:3}));d.addFigure(new RectangleFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLPin=function(c){var c=c||{};var d=new Pin(c);d.setType("UMLPin");setStereotypeProperties(d);d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.addFigure(new RectangleFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLParameterNode=function(c){var c=c||{};var d=new ParameterNode(c);d.setType("UMLParameterNode");d.setMoveable();setStereotypeProperties(d);d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",centered:true,margin:3}));d.addFigure(new RectangleFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLExpansionNode=function(c){var c=c||{};var d=new ExpansionNode(c);d.setType("UMLExpansionNode");setStereotypeProperties(d);d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.addFigure(new ExpansionNodeFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLObject=function(c){var c=c||{};var d=new ObjectActivity(c);d.setType("UMLObject");setStereotypeProperties(d);d.setWidth(100);d.setHeight(50);d.setMoveable();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new ObjectItem({id:"name",centered:true,margin:3}));d.addFigure(new RectangleFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLFlow=function(c){var d=new Flow(c);d.setType("UMLFlow");d.setLine(new SolidLine());d.setEnd(new OpenTip());return d};var UMLActivityFinal=function(c){var d=new Elliptical(c);d.setType("UMLActivityFinal");d.setWidth(16);d.setHeight(16);d.addFigure(new HalfFilledEllipseFigure({color:"#ffffff",changeFigureColor:false}));return d};var UMLInitialNode=function(c){var d=new Elliptical(c);d.setType("UMLInitialNode");d.setWidth(16);d.setHeight(16);d.addFigure(new EllipseFigure({color:"#000000",changeFigureColor:false}));return d};var UMLFlowFinal=function(c){var c=c||{};var d=new FlowFinal(c);d.setType("UMLFlowFinal");setStereotypeProperties(d);d.setWidth(16);d.setHeight(16);d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.addFigure(new CrossEllipseFigure({color:"#ffffff",changeFigureColor:false}));d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLDecision_MergeNode=function(c){var c=c||{};var d=new Decision_MergeNode(c);d.setType("UMLDecision_MergeNode");setStereotypeProperties(d);d.setMinWidth(35);d.setMinHeight(35);d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.addFigure(new RhombusFigure({color:"#bdd8e5"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLFork_JoinNode=function(c){var d=new NodeForkJoin(c);d.setType("UMLFork_JoinNode");d.setWidth(100);d.setMinWidth(50);d.setHeight(5);d.setMinHeight(5);d.setMoveable();d.addFigure(new RectangleFigure({color:"#000000",changeFigureColor:false}));return d};var UMLSendSignalAction=function(c){var c=c||{};var d=new SendSignalAction(c);d.setType("UMLSendSignalAction");setStereotypeProperties(d);d.setWidth(100);d.setHeight(50);d.setMoveable();d.setContainer();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextBox({id:"name",centered:true,margin:3}));d.addFigure(new SendSignalActionFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLConnectorActivity=function(c){var c=c||{};var d=new ConnectorActivity(c);d.setType("UMLConnectorActivity");setStereotypeProperties(d);d.setWidth(20);d.setHeight(20);d.setMoveable();d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new ConnectorItem({id:"name",centered:true,margin:3,width:20}));d.addFigure(new EllipseFigure({color:"#ffffbb"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLHorizontalSwimlane=function(c){var d=new UnhierarchicalSwimlane(c);d.setType("UMLHorizontalSwimlane");d.setWidth(150);d.setHeight(60);d.setMoveable();d.setContainer();d.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));d.addFigure(new SwimlaneFigure());if(c.setElementXml){}else{d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}));d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}))}return d};var UMLVerticalSwimlane=function(c){c=c||{};c.orientation=1;var d=new UnhierarchicalSwimlane(c);d.setType("UMLVerticalSwimlane");d.setWidth(60);d.setHeight(150);d.setMoveable();d.setContainer();d.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));d.addFigure(new VerticalSwimlaneFigure());if(c.setElementXml){}else{d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}));d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}))}return d};var UMLHorizontalHierarchicalSwimlane=function(c){var c=c||{};var d=new HierarchicalSwimlane(c);d.setType("UMLHorizontalHierarchicalSwimlane");setStereotypeProperties(d);d.setWidth(150);d.setHeight(60);d.setMoveable();d.setContainer();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true,orientation:1}));d.addComponent(new TextBox({id:"name",centered:true,margin:3,orientation:1}));d.addComponent(new Separator({id:"separator",centered:true,orientation:1,width:2.5}));d.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));d.addFigure(new SwimlaneFigure());if(c.setElementXml){}else{d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}));d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}))}d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLVerticalHierarchicalSwimlane=function(c){c=c||{};c.orientation=1;var d=new HierarchicalSwimlane(c);d.setType("UMLVerticalHierarchicalSwimlane");setStereotypeProperties(d);d.setWidth(60);d.setHeight(150);d.setMoveable();d.setContainer();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextBox({id:"name",centered:true,margin:3}));d.addComponent(new Separator({id:"separator",centered:true,height:2.5}));d.addComponent(new SwimlaneItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));d.addFigure(new VerticalSwimlaneFigure());if(c.setElementXml){}else{d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}));d.addRegion(new Swimlane({parent:d,y:d.getY(),x:d.getX()}))}d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLExceptionHandler=function(c){var d=new ExceptionHandler(c);d.setType("UMLExceptionHandler");d.addComponentStereotype();d.setComponentName();d.setLine(new SolidLine());d.setEnd(new OpenTip());return d};var Aggregation=function(b){b=b||{};Aggregation.baseConstructor.call(this,b)};JSFun.extend(Aggregation,Relation);Aggregation.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Aggregation.prototype.setName=function(b){this._components[1].setValue(b)};Aggregation.prototype.setRoleA=function(b){this._components[2].setValue(b)};Aggregation.prototype.setRoleB=function(b){this._components[3].setValue(b)};Aggregation.prototype.setMultiplicityA=function(b){this._components[4].setValue(b)};Aggregation.prototype.setMultiplicityB=function(b){this._components[5].setValue(b)};Aggregation.prototype.getStereotypes=function(){return this._components[0]._childs};Aggregation.prototype.getName=function(){return this._components[1].getValue()};Aggregation.prototype.getRoleA=function(){return this._components[2].getValue()};Aggregation.prototype.getRoleB=function(){return this._components[3].getValue()};Aggregation.prototype.getMultiplicityA=function(){return this._components[4].getValue()};Aggregation.prototype.getMultiplicityB=function(){return this._components[5].getValue()};var Association=function(b){b=b||{};Association.baseConstructor.call(this,b)};JSFun.extend(Association,Relation);Association.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Association.prototype.setName=function(b){this._components[1].setValue(b)};Association.prototype.setRoleA=function(b){this._components[2].setValue(b)};Association.prototype.setRoleB=function(b){this._components[3].setValue(b)};Association.prototype.setMultiplicityA=function(b){this._components[4].setValue(b)};Association.prototype.setMultiplicityB=function(b){this._components[5].setValue(b)};Association.prototype.getStereotypes=function(){return this._components[0]._childs};Association.prototype.getName=function(){return this._components[1].getValue()};Association.prototype.getRoleA=function(){return this._components[2].getValue()};Association.prototype.getRoleB=function(){return this._components[3].getValue()};Association.prototype.getMultiplicityA=function(){return this._components[4].getValue()};Association.prototype.getMultiplicityB=function(){return this._components[5].getValue()};var Class=function(b){b=b||{};Class.baseConstructor.call(this,b)};JSFun.extend(Class,Rectangular);Class.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Class.prototype.setName=function(b){this._components[1].setValue(b)};Class.prototype.addAttribute=function(b){var b=b||"";this._components[2].addField(b)};Class.prototype.addOperation=function(b){var b=b||"";this._components[3].addField(b)};Class.prototype.getStereotypes=function(){return this._components[0]._childs};Class.prototype.getName=function(){return this._components[1].getValue()};Class.prototype.getAttributes=function(){return this._components[2]._childs};Class.prototype.getOperations=function(){return this._components[3]._childs};Class.prototype.getStereotype=function(){return this._components[0]};var ClassDiagram=function(b){ClassDiagram.baseConstructor.call(this,b)};JSFun.extend(ClassDiagram,Diagram);ClassDiagram.prototype.setXML=function(g,l){var l=l||[];var m=[];if(this._alone){var h=g.getElementsByTagName(this.getType())[0];if(!h){return false}}else{var h=g}this._name.setValue(h.getAttribute("name"));if(h.getAttribute("backgroundNodes")){this._backgroundNodes=h.getAttribute("backgroundNodes")}this._stereotypes=l;var n=h.childNodes;var o;for(o=0;o<n.length;o++){this._instantiateElements(n[o],m)}for(o=0;o<n.length;o++){this._addElementXML(n[o],m,null)}for(o=0;o<this._relations.length;o++){this._relations[o].notifyChange()}this._sortNodesByArea();return true};var ComponentElement=function(b){b=b||{};ComponentElement.baseConstructor.call(this,b)};JSFun.extend(ComponentElement,Rectangular);ComponentElement.prototype.addStereotype=function(b){var b=b||"";this._components[1].addField("\xAB"+b+"\xBB")};ComponentElement.prototype.setName=function(b){this._components[3].setValue(b)};ComponentElement.prototype.addAttribute=function(b){var b=b||"";this._components[4].addField(b)};ComponentElement.prototype.addOperation=function(b){var b=b||"";this._components[5].addField(b)};ComponentElement.prototype.getStereotypes=function(){return this._components[1]._childs};ComponentElement.prototype.getName=function(){return this._components[3].getValue()};ComponentElement.prototype.getAttributes=function(){return this._components[4]._childs};ComponentElement.prototype.getOperations=function(){return this._components[5]._childs};ComponentElement.prototype.getStereotype=function(){return this._components[1]};var Composition=function(b){b=b||{};Composition.baseConstructor.call(this,b)};JSFun.extend(Composition,Relation);Composition.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Composition.prototype.setName=function(b){this._components[1].setValue(b)};Composition.prototype.setRoleA=function(b){this._components[2].setValue(b)};Composition.prototype.setRoleB=function(b){this._components[3].setValue(b)};Composition.prototype.setMultiplicityA=function(b){this._components[4].setValue(b)};Composition.prototype.setMultiplicityB=function(b){this._components[5].setValue(b)};Composition.prototype.getStereotypes=function(){return this._components[0]._childs};Composition.prototype.getName=function(){return this._components[1].getValue()};Composition.prototype.getRoleA=function(){return this._components[2].getValue()};Composition.prototype.getRoleB=function(){return this._components[3].getValue()};Composition.prototype.getMultiplicityA=function(){return this._components[4].getValue()};Composition.prototype.getMultiplicityB=function(){return this._components[5].getValue()};var Dependency=function(b){b=b||{};Dependency.baseConstructor.call(this,b)};JSFun.extend(Dependency,Relation);Dependency.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Dependency.prototype.setName=function(b){this._components[1].setValue(b)};Dependency.prototype.getStereotypes=function(){return this._components[0]._childs};Dependency.prototype.getName=function(){return this._components[1].getValue()};var Generalization=function(b){b=b||{};Generalization.baseConstructor.call(this,b)};JSFun.extend(Generalization,Relation);Generalization.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Generalization.prototype.setName=function(b){this._components[1].setValue(b)};Generalization.prototype.getStereotypes=function(){return this._components[0]._childs};Generalization.prototype.getName=function(){return this._components[1].getValue()};var InterfaceExtended=function(b){b=b||{};InterfaceExtended.baseConstructor.call(this,b)};JSFun.extend(InterfaceExtended,Rectangular);InterfaceExtended.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};InterfaceExtended.prototype.setName=function(b){this._components[2].setValue(b)};InterfaceExtended.prototype.addAttribute=function(b){var b=b||"";this._components[3].addField(b)};InterfaceExtended.prototype.addOperation=function(b){var b=b||"";this._components[4].addField(b)};InterfaceExtended.prototype.getStereotypes=function(){return this._components[0]._childs};InterfaceExtended.prototype.getName=function(){return this._components[2].getValue()};InterfaceExtended.prototype.getAttributes=function(){return this._components[3]._childs};InterfaceExtended.prototype.getOperations=function(){return this._components[4]._childs};InterfaceExtended.prototype.getStereotype=function(){return this._components[0]};var Package=function(b){b=b||{};Package.baseConstructor.call(this,b)};JSFun.extend(Package,Rectangular);Package.prototype.addStereotype=function(b){var b=b||"";this._components[1].addField("\xAB"+b+"\xBB")};Package.prototype.setName=function(b){this._components[2].setValue(b)};Package.prototype.getStereotypes=function(){return this._components[1]._childs};Package.prototype.getName=function(){return this._components[2].getValue()};Package.prototype.getStereotype=function(){return this._components[1]};var PackageContainer=function(b){b=b||{};PackageContainer.baseConstructor.call(this,b)};JSFun.extend(PackageContainer,Rectangular);PackageContainer.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};PackageContainer.prototype.setName=function(b){this._components[1].setValue(b)};PackageContainer.prototype.getStereotypes=function(){return this._components[0]._childs};PackageContainer.prototype.getName=function(){return this._components[1].getValue()};PackageContainer.prototype.getStereotype=function(){return this._components[0]};var Realization=function(b){b=b||{};Realization.baseConstructor.call(this,b)};JSFun.extend(Realization,Relation);Realization.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Realization.prototype.setName=function(b){this._components[1].setValue(b)};Realization.prototype.getStereotypes=function(){return this._components[0]._childs};Realization.prototype.getName=function(){return this._components[1].getValue()};var UMLClassDiagram=function(c){c=c||{};var d=new ClassDiagram(c);d.setType("UMLClassDiagram");d.setName("Class diagram");setStereotypeObjects(c.stereotypes||[],d);d.setValidElements(["UMLNote","UMLLine","UMLClass","UMLComponent","UMLInterfaceExtended","UMLPackage","UMLPackageContainer","UMLAggregation","UMLAssociation","UMLComposition","UMLDependency","UMLGeneralization","UMLRealization","UMLUsage","UMLPackageMerge","UMLPackagePublicImport","UMLPackagePrivateImport"]);return d};var UMLPackage=function(c){var c=c||{};var d=new Package(c);d.setType("UMLPackage");setStereotypeProperties(d);d.setMoveable();d.setWidth(100);d.setHeight(50);d.addFigure(new PackageFigure({color:"#c0e1c2"}));d.addComponent(new Space({height:16}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",text:"Package name",centered:true,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLPackageContainer=function(c){var c=c||{};var d=new PackageContainer(c);d.setType("UMLPackageContainer");setStereotypeProperties(d);d.setWidth(150);d.setHeight(75);d.setMoveable();d.setContainer();d.addFigure(new RectangleFigure({color:"#c0e1c2"}));d.addComponent(new StereotypeTagList({id:"stereotypes"}));d.addComponent(new Tab({id:"name",margin:5,text:"Package name"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLClass=function(c){var c=c||{};var d=new Class(c);d.setType("UMLClass");setStereotypeProperties(d);d.setMoveable();d.addFigure(new RectangleFigure({color:"#ffffbb"}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",text:"ClassName",centered:true,margin:3}));d.addComponent(new AttributeFields({id:"attributes",margin:3}));d.addComponent(new OperationFields({id:"operations",margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLComponent=function(c){var c=c||{};var d=new ComponentElement(c);d.setType("UMLComponent");setStereotypeProperties(d);d.setMoveable();d.setWidth(150);d.addFigure(new RectangleFigure({color:"#ffffbb"}));d.addComponent(new ComponentSymbol({position:Component.TopRight,margin:3}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new Text({text:"\xABcomponent\xBB",centered:true}));d.addComponent(new TextArea({id:"name",text:"Component Name",centered:true,margin:3}));d.addComponent(new AttributeFields({id:"attributes",visibleSubComponents:false,margin:3}));d.addComponent(new OperationFields({id:"operations",visibleSubComponents:false,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLInterfaceExtended=function(c){var c=c||{};var d=new InterfaceExtended(c);d.setType("UMLInterfaceExtended");setStereotypeProperties(d);d.setMoveable();d.setWidth(150);d.addFigure(new RectangleFigure({color:"#c0e1c2"}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new CircleSymbol({position:Component.TopRight,margin:3}));d.addComponent(new TextArea({id:"name",text:"Interface Name",centered:true,margin:3}));d.addComponent(new AttributeFields({id:"attributes",visibleSubComponents:false,margin:3}));d.addComponent(new OperationFields({id:"methods",visibleSubComponents:false,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLAggregation=function(c){var d=new Aggregation(c);d.setType("UMLAggregation");d.addComponentStereotype();d.setComponentName();d.setComponentRoleA();d.setComponentRoleB();d.setComponentMultiplicityA();d.setComponentMultiplicityB();d.setLine(new SolidLine());d.setStart(new AggregationEnd());d.setEnd(new OpenTip());return d};var UMLAssociation=function(c){var d=new Association(c);d.setType("UMLAssociation");d.addComponentStereotype();d.setComponentName();d.setComponentRoleA();d.setComponentRoleB();d.setComponentMultiplicityA();d.setComponentMultiplicityB();d.setLine(new SolidLine());d.setEnd(new OpenTip());return d};var UMLComposition=function(c){var d=new Composition(c);d.setType("UMLComposition");d.addComponentStereotype();d.setComponentName();d.setComponentRoleA();d.setComponentRoleB();d.setComponentMultiplicityA();d.setComponentMultiplicityB();d.setLine(new SolidLine());d.setStart(new CompositionEnd());d.setEnd(new OpenTip());return d};var UMLDependency=function(c){var d=new Dependency(c);d.setType("UMLDependency");d.addComponentStereotype();d.setComponentName();d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLGeneralization=function(c){var d=new Generalization(c);d.setType("UMLGeneralization");d.addComponentStereotype();d.setComponentName();d.setLine(new SolidLine());d.setEnd(new CloseTip());return d};var UMLRealization=function(c){var d=new Realization(c);d.setType("UMLRealization");d.addComponentStereotype();d.setComponentName();d.setLine(new DashedLine());d.setEnd(new CloseTip());return d};var UMLUsage=function(c){var d=new Relation(c);d.setType("UMLUsage");d.setStereotype("\xABuse\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLPackageMerge=function(c){var d=new Relation(c);d.setType("UMLPackageMerge");d.setStereotype("\xABmerge\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLPackagePublicImport=function(c){var d=new Relation(c);d.setType("UMLPackagePublicImport");d.setStereotype("\xABimport\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLPackagePrivateImport=function(c){var d=new Relation(c);d.setType("UMLPackagePrivateImport");d.setStereotype("\xABaccess\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var ComponentDiagram=function(b){ComponentDiagram.baseConstructor.call(this,b)};JSFun.extend(ComponentDiagram,Diagram);ComponentDiagram.prototype.setXML=function(g,l){var l=l||[];var m=[];if(this._alone){var h=g.getElementsByTagName(this.getType())[0];if(!h){return false}}else{var h=g}this._name.setValue(h.getAttribute("name"));if(h.getAttribute("backgroundNodes")){this._backgroundNodes=h.getAttribute("backgroundNodes")}this._stereotypes=l;var n=h.childNodes;var o;for(o=0;o<n.length;o++){this._instantiateElements(n[o],m)}for(o=0;o<n.length;o++){this._addElementXML(n[o],m,null)}for(o=0;o<this._relations.length;o++){this._relations[o].notifyChange()}this._sortNodesByArea();return true};var ConnectorRelation=function(b){b=b||{};ConnectorRelation.baseConstructor.call(this,b)};JSFun.extend(ConnectorRelation,Relation);ConnectorRelation.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};ConnectorRelation.prototype.setName=function(b){this._components[1].setValue(b)};ConnectorRelation.prototype.getStereotypes=function(){return this._components[0]._childs};ConnectorRelation.prototype.getName=function(){return this._components[1].getValue()};var InterfaceExtended=function(b){b=b||{};InterfaceExtended.baseConstructor.call(this,b)};JSFun.extend(InterfaceExtended,Rectangular);InterfaceExtended.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};InterfaceExtended.prototype.setName=function(b){this._components[2].setValue(b)};InterfaceExtended.prototype.addAttribute=function(b){var b=b||"";this._components[3].addField(b)};InterfaceExtended.prototype.addOperation=function(b){var b=b||"";this._components[4].addField(b)};InterfaceExtended.prototype.getStereotypes=function(){return this._components[0]._childs};InterfaceExtended.prototype.getName=function(){return this._components[2].getValue()};InterfaceExtended.prototype.getAttributes=function(){return this._components[3]._childs};InterfaceExtended.prototype.getOperations=function(){return this._components[4]._childs};InterfaceExtended.prototype.getStereotype=function(){return this._components[0]};var InterfaceRealization=function(b){b=b||{};InterfaceRealization.baseConstructor.call(this,b)};JSFun.extend(InterfaceRealization,Relation);InterfaceRealization.prototype.setName=function(b){this._components[0].setValue(b)};InterfaceRealization.prototype.getName=function(){return this._components[0].getValue()};var InterfaceUsage=function(b){b=b||{};InterfaceUsage.baseConstructor.call(this,b)};JSFun.extend(InterfaceUsage,Relation);InterfaceUsage.prototype.setName=function(b){this._components[0].setValue(b)};InterfaceUsage.prototype.getName=function(){return this._components[0].getValue()};var NodeInterface=function(b){b=b||{};NodeInterface.baseConstructor.call(this,b)};JSFun.extend(NodeInterface,Elliptical);NodeInterface.prototype.draw=function(e){var g=false;var h=false;if(this._relations.length<=0){g=true}var f;for(f in this._relations){if(this._relations[f].getType()=="UMLInterfaceRealization"){h=true;break}}if(g||h){NodeInterface.base.draw.call(this,e)}else{this.drawComponents(e);if(this._selected){this.drawComponentsShape(e)}}};NodeInterface.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};NodeInterface.prototype.setName=function(b){this._components[1].setValue(b)};NodeInterface.prototype.getStereotypes=function(){return this._components[0]._childs};NodeInterface.prototype.getName=function(){return this._components[1].getValue()};NodeInterface.prototype.getStereotype=function(){return this._components[0]};var NodePorts=function(b){b=b||{};NodePorts.baseConstructor.call(this,b);this._ports=[]};JSFun.extend(NodePorts,Node);NodePorts.prototype.addPort=function(b){if(b instanceof Node&&b.getType()=="UMLPort"){this._ports.push(b);this._diagram._addNode(b);b.setParent(this);b.correctPosition()}};NodePorts.prototype.setSelectedFigure=function(c){var d=NodePorts.base.setSelectedFigure.call(this,c);if(d){if(this._figures[c] instanceof FromImageFigure){for(i in this._ports){this._ports[i].setVisibility(false)}}else{for(i in this._ports){this._ports[i].setVisibility(true)}}}};NodePorts.prototype.setVisibility=function(d){NodePorts.base.setVisibility.call(this,d);var c=true;if(this._selectedFigure&&d){c=false}if(this._container&&c){for(i in this._ports){this._ports[i].setVisibility(d)}}};NodePorts.prototype.updatePosition=function(o,h){if(o==undefined&&h==undefined){var m=this.getMovement();var l=m.getX();var n=m.getY()}else{var l=o;var n=h}var g;for(g in this._ports){this._ports[g].updatePosition(l,n)}NodePorts.base.updatePosition.call(this,o,h)};NodePorts.prototype.notifyChange=function(){NodePorts.base.notifyChange.call(this);var b;for(b in this._ports){this._ports[b].correctPosition();this._ports[b].notifyChange()}};NodePorts.prototype.updateContainer=function(){NodePorts.base.updateContainer.call(this);for(i in this._ports){this._ports[i].correctPosition();this._ports[i].notifyChange()}};NodePorts.prototype.deleted=function(){NodePorts.base.deleted.call(this);var b;for(b in this._ports){this._ports[b].deleted()}};NodePorts.prototype.getElementXML=function(d){var f=NodePorts.base.getElementXML.call(this,d);var e;for(e in this._ports){f.appendChild(this._ports[e].getElementXML(d))}return f};NodePorts.prototype.addChild=function(b){if(b instanceof Port){this._ports.push(b);b.setParent(this);b.correctPosition();return}else{NodePorts.base.addChild.call(this,b)}};NodePorts.prototype.notifyDeleted=function(c){if(c instanceof Port){var d;for(d in this._ports){if(this._ports[d]==c){this._ports.splice(d,1)}}}else{NodePorts.base.notifyDeleted.call(this,c)}};NodePorts.prototype.addStereotype=function(b){var b=b||"";this._components[2].addField("\xAB"+b+"\xBB")};NodePorts.prototype.setName=function(b){this._components[3].setValue(b)};NodePorts.prototype.addInterface=function(b){var b=b||"";this._components[4].addField(b)};NodePorts.prototype.addRealization=function(b){var b=b||"";this._components[5].addField(b)};NodePorts.prototype.addArtifact=function(b){var b=b||"";this._components[6].addField(b)};NodePorts.prototype.getStereotypes=function(){return this._components[2]._childs};NodePorts.prototype.getName=function(){return this._components[3].getValue()};NodePorts.prototype.getInterfaces=function(){return this._components[4]._childs};NodePorts.prototype.getRealizations=function(){return this._components[5]._childs};NodePorts.prototype.getArtifacts=function(){return this._components[6]._childs};NodePorts.prototype.getStereotype=function(){return this._components[2]};var Package=function(b){b=b||{};Package.baseConstructor.call(this,b)};JSFun.extend(Package,Rectangular);Package.prototype.addStereotype=function(b){var b=b||"";this._components[1].addField("\xAB"+b+"\xBB")};Package.prototype.setName=function(b){this._components[2].setValue(b)};Package.prototype.getStereotypes=function(){return this._components[1]._childs};Package.prototype.getName=function(){return this._components[2].getValue()};Package.prototype.getStereotype=function(){return this._components[1]};var PackageContainer=function(b){b=b||{};PackageContainer.baseConstructor.call(this,b)};JSFun.extend(PackageContainer,Rectangular);PackageContainer.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};PackageContainer.prototype.setName=function(b){this._components[1].setValue(b)};PackageContainer.prototype.getStereotypes=function(){return this._components[0]._childs};PackageContainer.prototype.getName=function(){return this._components[1].getValue()};PackageContainer.prototype.getStereotype=function(){return this._components[0]};var UMLComponentDiagram=function(c){c=c||{};var d=new ComponentDiagram(c);d.setType("UMLComponentDiagram");d.setName("Component diagram");setStereotypeObjects(c.stereotypes||[],d);d.setValidElements(["UMLNote","UMLLine","UMLComComponent","UMLComposition","UMLInterface","UMLInterfaceExtended","UMLInterfaceUsage","UMLInterfaceRealization","UMLPort","UMLGeneralization","UMLRealization","UMLInterfaceExtended","UMLConnector","UMLPackage","UMLPackageContainer"]);return d};var UMLPackage=function(c){var c=c||{};var d=new Package(c);d.setType("UMLPackage");setStereotypeProperties(d);d.setMoveable();d.setWidth(100);d.setHeight(50);d.addFigure(new PackageFigure({color:"#c0e1c2"}));d.addComponent(new Space({height:16}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",text:"Package name",centered:true,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLPackageContainer=function(c){var c=c||{};var d=new PackageContainer(c);d.setType("UMLPackageContainer");setStereotypeProperties(d);d.setWidth(150);d.setHeight(75);d.setMoveable();d.setContainer();d.addFigure(new RectangleFigure({color:"#bdd8e5"}));d.addComponent(new StereotypeTagList({id:"stereotypes"}));d.addComponent(new Tab({id:"name",margin:5,text:"Package name"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLComComponent=function(c){var c=c||{};var d=new NodePorts(c);d.setType("UMLComComponent");setStereotypeProperties(d);d.setContainer();d.setMoveable();d.setWidth(150);d.addFigure(new RectangleFigure({color:"#ffffbb"}));d.addComponent(new ComponentSymbol({position:Component.TopRight,margin:3}));d.addComponent(new Text({text:"\xABcomponent\xBB",centered:true}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",text:"Component Name",centered:true,margin:3}));d.addComponent(new AttributeFields({id:"interfaces",text:"new_interface",visibleSubComponents:false,margin:3}));d.addComponent(new AttributeFields({id:"realizations",text:"new_realization",visibleSubComponents:false,margin:3}));d.addComponent(new AttributeFields({id:"artifacts",text:"new_artifact",visibleSubComponents:false,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLInterface=function(c){var c=c||{};var d=new NodeInterface(c);d.setType("UMLInterface");setStereotypeProperties(d);d.setWidth(16);d.setHeight(16);d.addFigure(new EllipseFigure({color:"#67ac88"}));d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLInterfaceExtended=function(c){var c=c||{};var d=new InterfaceExtended(c);d.setType("UMLInterfaceExtended");setStereotypeProperties(d);d.setMoveable();d.setWidth(150);d.addFigure(new RectangleFigure({color:"#c0e1c2"}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new CircleSymbol({position:Component.TopRight,margin:3}));d.addComponent(new TextArea({id:"name",text:"Interface Name",centered:true,margin:3}));d.addComponent(new AttributeFields({id:"attributes",visibleSubComponents:false,margin:3}));d.addComponent(new OperationFields({id:"methods",visibleSubComponents:false,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLInterfaceUsage=function(c){var d=new InterfaceUsage(c);d.setType("UMLInterfaceUsage");d.setComponentName();d.setLine(new SolidLine());d.setEnd(new InterfaceUsage());return d};var UMLInterfaceRealization=function(c){var d=new InterfaceRealization(c);d.setType("UMLInterfaceRealization");d.setComponentName();d.setLine(new SolidLine());return d};var UMLConnector=function(c){var d=new ConnectorRelation(c);d.setType("UMLConnector");d.addComponentStereotype();d.setComponentName();d.setLine(new SolidLine());return d};var UMLPort=function(c){var c=c||{};var d=new Port(c);d.setType("UMLPort");setStereotypeProperties(d);d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var Line=function(b){b=b||{};Line.baseConstructor.call(this,b)};JSFun.extend(Line,Relation);Line.prototype.draw=function(d){var f=this._points.length;if(this._line){this._line.draw(d,this._points,"#4f4f4f")}if(this._selected>=0){var e;for(e=0;e<this._points.length;e++){d.fillRect(parseInt(this._points[e].getX())-3,parseInt(this._points[e].pixelY())-3,6,6)}}if(this._selected>-1){this._drawComponentsShape(d)}this._drawComponents(d)};var Note=function(b){b=b||{};Note.baseConstructor.call(this,b)};JSFun.extend(Note,Rectangular);Note.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Note.prototype.setName=function(b){this._components[1].setValue(b)};Note.prototype.getStereotypes=function(){return this._components[0]._childs};Note.prototype.getName=function(){return this._components[1].getValue()};var UMLNote=function(c){var d=new Note(c);d.setType("UMLNote");d.setMoveable();d.setWidth(100);d.setHeight(50);d.addFigure(new NoteFigure({color:"#ffffbb"}));d.addComponent(new StereotypeFields({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"description",text:"Note",centered:true,margin:5}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"]]);return d};var UMLLine=function(c){var d=new Line(c);d.setType("UMLLine");d.setLine(new DashedLine());return d};var Extension=function(b){b=b||{};Extension.baseConstructor.call(this,b)};JSFun.extend(Extension,Relation);Extension.prototype.setElements=function(c,d){if(!((c instanceof Stereotype&&d instanceof Metaclass)||(d instanceof Stereotype&&c instanceof Metaclass))){return}if(c instanceof Element&&d instanceof Element){if(c instanceof Relation&&d instanceof Relation){return false}if(this._elemA){this._elemA.delRelation(this)}if(this._elemB){this._elemB.delRelation(this)}this._elemA=(c instanceof Stereotype)?c:d;this._elemB=(d instanceof Metaclass)?d:c;this._elemA.addRelation(this);this._elemB.addRelation(this);this.updateParent();this._calculateLineEnds();return true}else{return false}};Extension.prototype.setElementA=function(b){if(b.getType()=="UMLStereotype"){Extension.base.setElementA.call(this,b)}};Extension.prototype.setElementB=function(b){if(b.getType()=="UMLMetaclass"){Extension.base.setElementB.call(this,b)}};var Metaclass=function(b){b=b||{};Metaclass.baseConstructor.call(this,b);this._stereotypes=[]};JSFun.extend(Metaclass,Rectangular);Metaclass.prototype.setName=function(b){this._components[1].setValue(b)};Metaclass.prototype.addRelation=function(b){Metaclass.base.addRelation.call(this,b);this._stereotypes.push(b._elemA);b._elemA._metaclass.push(this)};Metaclass.prototype.delRelation=function(b){Metaclass.base.delRelation.call(this,b);b._elemA.delMetaclass(this);this.delStereotype(b._elemA)};Metaclass.prototype.deleted=function(){var d=this._relations;for(var c=0;c<d.length;c++){d[c]._elemA.delMetaclass(this)}Metaclass.base.deleted.call(this)};Metaclass.prototype.notifyDeleted=function(d){var c;for(c in this._relations){if(this._relations[c]==d){this.delStereotype(d._elemA);d._elemA.delMetaclass(this);this._relations.splice(c,1)}}};Metaclass.prototype.delStereotype=function(d){var c;for(c in this._stereotypes){if(this._stereotypes[c]==d){this._stereotypes.splice(c,1);break}}};Metaclass.prototype.getName=function(){for(var b=0;b<this._diagram._validMetaclassApp.length;b++){if(this._diagram._validMetaclassApp[b][0]==this._components[1].getValue()){return this._diagram._validMetaclassApp[b][1]}}};var MetaclassItem=function(b){b=b||{};MetaclassItem.baseConstructor.call(this,b)};JSFun.extend(MetaclassItem,TextBox);MetaclassItem.prototype.setText=function(m){if(JSFun.isString(m)){if(this._text!=m){var l=(this._parent)?this._parent._diagram._diagrams:[];var g=[];for(var n in l){g=l[n]._nodes;for(var o=0;o<g.length;o++){if(g[o]._stereotypeProperties&&this._parent){for(var h=0;h<this._parent._stereotypes.length;h++){g[o]._stereotypeProperties.removeStereotype(this._parent._stereotypes[h])}}}}}StereotypeTag.base.setText.call(this,m)}};MetaclassItem.prototype.showDialog=function(){if(this.active){return}var p=this;this.active=true;var u=document.createElement("div");var t=document.createElement("form");var r=document.createElement("input");var n=document.createElement("input");u.className="ud_popup";var s;r=document.createElement("select");s=document.createElement("option");s.setAttribute("value","Metaclass name");s.appendChild(document.createTextNode("none"));r.appendChild(s);var o=this._parent._diagram._validMetaclassApp;for(var q=0;q<o.length;q++){s=document.createElement("option");s.setAttribute("value",o[q][0]);s.appendChild(document.createTextNode(o[q][0]));if(this._parent.getName()==o[q][1]){s.setAttribute("selected","selected")}r.appendChild(s)}n.setAttribute("type","submit");n.setAttribute("value","ok");this.changeText=function(a){if(p.active){p.setText(p.encode(r.value));document.body.removeChild(u);p.active=false;p.notifyChange()}};this.closeDialog=function(a){if(p.active){document.body.removeChild(u);p.active=false;p.notifyChange()}};t.onsubmit=function(){return false};n.addEventListener("click",this.changeText,false);t.appendChild(r);t.appendChild(n);if(this.deletable){var m=document.createElement("input");m.setAttribute("type","submit");m.setAttribute("value","delete");this.deleteDialog=function(a){if(p.active){document.body.removeChild(u);p.active=false;p.notifyDelete();p.notifyChange()}};m.addEventListener("click",this.deleteDialog,false);t.appendChild(m)}u.appendChild(t);document.body.appendChild(u);r.focus();u.style.top=(window.innerHeight-t.offsetHeight)/2+"px";u.style.left=(window.innerWidth-t.offsetWidth)/2+"px"};var ProfileDiagram=function(b){b=b||{};ProfileDiagram.baseConstructor.call(this,b);this._visible=true;this.setValidMetaclass(b.validMetaclass||[]);this.setDiagrams(b.diagrams||[])};JSFun.extend(ProfileDiagram,Diagram);ProfileDiagram.prototype.setValidMetaclass=function(c){if(!JSFun.isArray(c)){return}this._validMetaclassLibrary=["UMLActor","UMLUseCase","UMLUseCaseExtended","UMLSystem","UMLSubSystem","UMLLine","UMLClass","UMLComponent","UMLInterfaceExtended","UMLPackage","UMLPackageContainer","UMLComComponent","UMLInterface","UMLLifeline","UMLOption","UMLAlternative","UMLLoop","UMLBreak","UMLAcceptEventAction","UMLTimeEvent","UMLSendSignalAction","UMLAction","UMLObject","UMLActivity","UMLDataStore","UMLConnectorActivity","UMLHorizontalHierarchicalSwimlane","UMLVerticalHierarchicalSwimlane","UMLSimpleState","UMLCompositeState","UMLVerticalRegion","UMLPin","UMLParameterNode","UMLExpansionNode","UMLHorizontalRegion","UMLPort","UMLTerminate","UMLEntryPoint","UMLExitPoint","UMLJunction","UMLFlowFinal"];this._validMetaclassApp=[];for(var d=0;d<c.length;d++){if(JSFun.isArray(c[d])&&c[d].length==2){if(this.foundInArray(this._validMetaclassLibrary,c[d][1])){this._validMetaclassApp.push(c[d])}}}this._validMetaclassApp=this._sortNamesMetaclass(this._validMetaclassApp)};ProfileDiagram.prototype._sortNamesMetaclass=function(b){b.sort(function(a,e){if(a[0]<e[0]){return -1}else{if(a[0]>e[0]){return 1}else{return 0}}});return b};ProfileDiagram.prototype.setDiagrams=function(b){this._diagrams=b};ProfileDiagram.prototype.foundInArray=function(f,d){for(var e=0;e<f.length;e++){if(d==f[e]){return true}}return false};ProfileDiagram.prototype.draw=function(){if(this._visible){ProfileDiagram.base.draw.call(this)}};ProfileDiagram.prototype.interaction=function(b){var b=(!this._visible)?false:b;ProfileDiagram.base.interaction.call(this,b)};ProfileDiagram.prototype.updateProfile=function(h){var f;var m=[];for(f=0;f<this._nodes.length;f++){if(this._nodes[f].getType()=="UMLMetaclass"){m.push(this._nodes[f])}}var g;var l=false;for(f=0;f<h.length;f++){g=h[f]._nodes;for(j=0;j<g.length;j++){if(g[j]._stereotypeProperties){g[j]._stereotypeProperties.updateElementStereotypes()}}}};ProfileDiagram.prototype.removeProfile=function(h){if(!h){return}var f;var m=[];for(f=0;f<this._nodes.length;f++){if(this._nodes[f].getType()=="UMLStereotype"){m.push(this._nodes[f])}}var g;var l=false;for(f=0;f<h.length;f++){g=h[f]._nodes;for(j=0;j<g.length;j++){if(g[j]._stereotypeProperties){for(k=0;k<m.length;k++){g[j]._stereotypeProperties.removeStereotype(m[k])}}}}};ProfileDiagram.prototype.setXML=function(e,g,h){g=g||[];h=h||[];ProfileDiagram.base.setXML.call(this,e);if(this._alone){var f=e.getElementsByTagName(this.getType())[0];if(!f){return false}}else{var f=e}if(f.getAttribute("visible")=="false"){this._visible=false}this.setDiagrams(g);this.setValidMetaclass(h)};ProfileDiagram.prototype.getXML=function(c){var d=ProfileDiagram.base.getXML.call(this,c);d.setAttribute("visible",this._visible);return d};ProfileDiagram.prototype.getElements=function(){var f=[];var d=[];for(var e=0;e<this._nodes.length;e++){if(this._nodes[e].getType()=="UMLMetaclass"){f.push(this._nodes[e])}else{if(this._nodes[e].getType()=="UMLStereotype"){d.push(this._nodes[e])}}}return[f,d]};var SrcItem=function(b){b=b||{};SrcItem.baseConstructor.call(this,b);this._parse=/^path(?:\:\/([a-zA-Z\:\_\.\/\\0-9 ]*))?$/;this.setMinWidth(50)};JSFun.extend(SrcItem,TextBox);SrcItem.prototype.encode=function(d){var c="";if(d[0]){c+="path:/"+d[0]}if(this._parse.exec(c)){return c}else{return"no icon "}};SrcItem.prototype.decode=function(c){var d=this._parse.exec(c);if(d){d.shift();return d}else{return[]}};SrcItem.prototype.showDialog=function(){if(this.active){return}var s=this;this.active=true;var u=document.createElement("div");var t=document.createElement("form");var q=document.createElement("input");var r=document.createElement("input");r.setAttribute("type","submit");r.setAttribute("value","ok");u.className="ud_popup";var o=this.decode(this.getValue());q.setAttribute("type","text");q.setAttribute("value",o[0]||"");this.changeText=function(b){if(s.active){var a=[];a.push(q.value);s.setText(s.encode(a));document.body.removeChild(u);s.active=false;s.notifyChange()}};this.closeDialog=function(a){if(s.active){document.body.removeChild(u);s.active=false;s.notifyChange()}};t.onsubmit=function(){return false};r.addEventListener("click",this.changeText,false);var p;var m;m=document.createElement("div");p=document.createElement("label");p.appendChild(document.createTextNode("Icon path (absolute path)"));m.appendChild(p);m.appendChild(q);t.appendChild(m);t.appendChild(r);if(this.deletable){var n=document.createElement("input");n.setAttribute("type","submit");n.setAttribute("value","delete");this.deleteDialog=function(a){if(s.active){document.body.removeChild(u);s.active=false;s.notifyDelete();s.notifyChange()}};n.addEventListener("click",this.deleteDialog,false);t.appendChild(n)}u.appendChild(t);document.body.appendChild(u);q.focus();u.style.top=(window.innerHeight-t.offsetHeight)/2+"px";u.style.left=(window.innerWidth-t.offsetWidth)/2+"px"};SrcItem.prototype.setText=function(p){if(JSFun.isString(p)){var o=(this._text!=p)?true:false;this._text=p;var q="";if(o){var n=(this._parent)?this._parent._diagram._diagrams:[];var l=[];for(var r in n){l=n[r]._nodes;for(var s=0;s<l.length;s++){if(l[s]._stereotypeProperties&&this._parent){if(this._parent._validMetaclass(l[s].getType())){q=l[s]._stereotypeProperties._shownStereotype;l[s]._stereotypeProperties.removeFigure(this._parent);if(q=="\xAB"+this._parent.getName()+"\xBB"){l[s]._stereotypeProperties.drawStereotype(this._parent)}}}}}}var m=(this._text.length>20)?20:this._text.length;if(p==""){if(this._orientation){this.setHeight(50)}else{this.setWidth(50)}}else{if(this._orientation){this.setHeight(m*ComponentStyle.font_width)}else{this.setWidth(m*ComponentStyle.font_width)}}if(this._orientation){this.setWidth(ComponentStyle.line_height)}else{this.setHeight(ComponentStyle.line_height)}}if(this._parent){this._parent.notifyDraw()}};SrcItem.prototype.draw=function(d){if(!this._visible){return}d.save();if(this.active){d.fillStyle="#ffc485";d.fillRect(this.getPixelX(),this.getPixelY(),this.getWidth(),this.getHeight())}d.restore();d.save();d.font=ComponentStyle.font_size+" monospace";d.textBaseline="middle";d.fillStyle=ComponentStyle.text_color;var c=this._text;if(c.length>20){c=c.substring(0,17);c+="..."}if(this._orientation){d.translate(this._getMX()+ComponentStyle.line_height/2,this._getMY());d.rotate((-90*Math.PI)/180);d.fillText(c,this._margin*2-this.getHeight(),0)}else{d.fillText(c,this._getMX(),this._getMY()+ComponentStyle.line_height/2)}d.restore()};var Stereotype=function(b){b=b||{};Stereotype.baseConstructor.call(this,b);this._metaclass=[]};JSFun.extend(Stereotype,Rectangular);Stereotype.prototype.addRelation=function(b){Stereotype.base.addRelation.call(this,b)};Stereotype.prototype.delRelation=function(b){Stereotype.base.delRelation.call(this,b);b._elemB.delStereotype(this);this.delMetaclass(b._elemB)};Stereotype.prototype.deleted=function(){var d=this._relations;for(var c=0;c<d.length;c++){d[c]._elemB.delStereotype(this)}Stereotype.base.deleted.call(this)};Stereotype.prototype.setName=function(b){this._components[1].setValue(b)};Stereotype.prototype.addTagValue=function(b){var b=b||"";this._components[3].addField(b)};Stereotype.prototype.setPath=function(b){this._components[4].setValue("path:/"+b)};Stereotype.prototype.getName=function(){return this._components[1].getValue()};Stereotype.prototype.getTagValues=function(){var d=this._components[3]._childs;var f=[];for(var e=0;e<d.length;e++){f.push(d[e].getValue())}return f};Stereotype.prototype.getPath=function(){return this._components[4].getValue().substring(5)};Stereotype.prototype._validMetaclass=function(c){for(var d=this._metaclass.length;d--;){if(this._metaclass[d].getName()==c){return true}}return false};Stereotype.prototype.delMetaclass=function(h){var e,f;var g=this._diagram._diagrams;for(e in g){for(var f=0;f<g[e]._nodes.length;f++){if(g[e]._nodes[f].getType()==h.getName()&&g[e]._nodes[f]._stereotypeProperties){g[e]._nodes[f]._stereotypeProperties.removeStereotype(this)}}}for(e in this._metaclass){if(this._metaclass[e]==h){this._metaclass.splice(e,1);break}}};var StereotypeNameItem=function(b){b=b||{};StereotypeNameItem.baseConstructor.call(this,b)};JSFun.extend(StereotypeNameItem,TextBox);StereotypeNameItem.prototype.setText=function(l){if(JSFun.isString(l)){if(this._text!=l){var h=(this._parent)?this._parent._diagram._diagrams:[];var g=[];for(var m in h){g=h[m]._nodes;for(var f=0;f<g.length;f++){if(g[f]._stereotypeProperties&&this._parent){if(this._parent._validMetaclass(g[f].getType())){g[f]._stereotypeProperties.changeNameStereotype(this._parent,"\xAB"+l+"\xBB")}}}}}StereotypeNameItem.base.setText.call(this,l)}};var TagValueItem=function(c){c=c||{};TagValueItem.baseConstructor.call(this,c);var d="^([a-zA-Z_0-9]*)?(?::([a-zA-Z_0-9]*))?$";this._parse=new RegExp(d);this.setMinWidth(40)};JSFun.extend(TagValueItem,TextBox);TagValueItem.prototype.encode=function(d){var c="";if(d[0]){c+=d[0]}if(d[1]){c+=":"+d[1]}if(this._parse.exec(c)){return c}else{return"wrong_attribute"}};TagValueItem.prototype.decode=function(c){var d=this._parse.exec(c);if(d){d.shift();return d}else{return[]}};TagValueItem.prototype.getNameTagValue=function(){return this.decode(this._text)[0]};TagValueItem.prototype.getDefaultValue=function(){return this.decode(this._text)[1]};TagValueItem.prototype.showDialog=function(){if(this.active){return}var t=this;this.active=true;var y=document.createElement("div");var x=document.createElement("form");var u=[];var w;y.className="ud_popup";for(w=0;w<2;w++){u.push(document.createElement("input"))}var s=document.createElement("input");s.setAttribute("type","submit");s.setAttribute("value","ok");var q=this.decode(this.getValue());for(w=0;w<u.length;w++){u[w].setAttribute("type","text");u[w].setAttribute("value",q[w]||"")}this.changeText=function(a){if(t.active){var c=[];var b;for(b=0;b<u.length;b++){c.push(u[b].value)}t.setText(t.encode(c));document.body.removeChild(y);t.active=false;t.notifyChange()}};this.closeDialog=function(a){if(t.active){document.body.removeChild(y);t.active=false;t.notifyChange()}};x.onsubmit=function(){return false};s.addEventListener("click",this.changeText,false);var v=["tag value","default value"];var r;var o;for(w=0;w<u.length;w++){o=document.createElement("div");r=document.createElement("label");r.appendChild(document.createTextNode(v[w]));o.appendChild(r);o.appendChild(u[w]);x.appendChild(o)}x.appendChild(s);if(this.deletable){var p=document.createElement("input");p.setAttribute("type","submit");p.setAttribute("value","delete");this.deleteDialog=function(a){if(t.active){document.body.removeChild(y);t.active=false;t.notifyDelete();t.notifyChange()}};p.addEventListener("click",this.deleteDialog,false);x.appendChild(p)}y.appendChild(x);document.body.appendChild(y);y.style.top=(window.innerHeight-x.offsetHeight)/2+"px";y.style.left=(window.innerWidth-x.offsetWidth)/2+"px"};TagValueItem.prototype.select=function(d,c){if(Math.abs(d-(this.getPixelX()+this.getSuperWidth()-20))<=5&&Math.abs(c-(this.getPixelY()+8.66))<=5){this.notifyToUp();this.notifyChange();return true}else{if(Math.abs(d-(this.getPixelX()+this.getSuperWidth()-30))<=5&&Math.abs(c-(this.getPixelY()+7.33))<=5){this.notifyToDown();this.notifyChange();return true}}return TagValueItem.base.select.call(this,d,c)};TagValueItem.prototype.drawShape=function(d){var e=this.getPixelX()+this.getSuperWidth()-35;var f=this.getPixelY()+3;d.save();d.fillStyle="#0000aa";d.beginPath();d.moveTo(e,f);d.lineTo(e+10,f);d.lineTo(e+5,f+7);d.closePath();d.fill();e=e+10;d.beginPath();d.moveTo(e+5,f);d.lineTo(e,f+7);d.lineTo(e+10,f+7);d.closePath();d.fill();d.restore()};var TagValueFields=function(b){b=b||{};TagValueFields.baseConstructor.call(this,b);this._default=b.text||"new_attribute"};JSFun.extend(TagValueFields,CollapsibleFields);TagValueFields.prototype.newItem=function(){return new TagValueItem({text:this._default})};var UMLProfile=function(c){var d=new ProfileDiagram(c);d.setType("UMLProfile");d.setName("Profile");d.setValidElements(["UMLNote","UMLLine","UMLMetaclass","UMLExtension","UMLStereotype"]);return d};var UMLMetaclass=function(c){var d=new Metaclass(c);d.setType("UMLMetaclass");d.setMoveable();d.setWidth(80);d.setHeight(30);d.addFigure(new RectangleFigure({color:"#c0e1c2"}));d.addComponent(new StereotypeItem({id:"stereotype",text:"\xABmetaclass\xBB",selected:true,centered:true}));d.addComponent(new MetaclassItem({id:"name",text:"MetaClass name",centered:true,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"]]);return d};var UMLStereotype=function(c){var d=new Stereotype(c);d.setType("UMLStereotype");d.setWidth(100);d.setHeight(40);d.setMoveable();d.addFigure(new RectangleFigure({color:"#c0e1c2"}));d.addComponent(new StereotypeItem({id:"stereotype",text:"\xABstereotype\xBB",selected:true,centered:true}));d.addComponent(new StereotypeNameItem({id:"name",text:"stereotype name",centered:true}));d.addComponent(new Separator({id:"separator",centered:true}));d.addComponent(new TagValueFields({id:"attributes",margin:3}));d.addComponent(new SrcItem({id:"src",text:"path:/",margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"]]);return d};var UMLExtension=function(c){var d=new Extension(c);d.setType("UMLExtension");d.setLine(new SolidLine());d.setEnd(new CloseTip({color:"#000000"}));return d};var Alternative=function(b){b=b||{};Alternative.baseConstructor.call(this,b)};JSFun.extend(Alternative,SuperNode);Alternative.prototype.drop=function(o,p){var t,u;if(this._moved){if(!this._alone){this._diagram.checkForParent(this)}var n=this._diagram._relations;var v=[];var s=[];var q=[];for(t=0;t<n.length;t++){if(this.isOverBeforePosition(n[t].getCentralPoint())&&n[t] instanceof Message){s.push(n[t].getCentralPoint());v.push(n[t])}}if(v.length){v=v[0]._sortRelByDistanceToLimitY(v)}for(t=0;t<v.length;t++){if(!v[t]._moved){v[t]._y=v[t]._y+(p-this._rely-this._prey);if(v[t]._y<v[t]._limitY){v[t]._y=v[t]._limitY}v[t]._moved=true;v[t]._calculateLineEnds(2)}}for(u=0;u<v.length;u++){var r=v[u]._sortAscendant(v[u].descendantMessages());for(t=0;t<r.length;t++){r[t]._moved=false;if(r[t]._objA){r[t]._objA.resetMovement()}if(r[t]._objB){r[t]._objB.resetMovement()}r[t].notifyChange()}}for(t=0;t<v.length;t++){v[t].updateRelatedLifeline()}if(v.length){v[0].updateDeleteMessages()}}Interaction.base.drop.call(this,o,p);var w=this._diagram._nodes;for(t=0;t<w.length;t++){if(w[t] instanceof Lifeline){w[t].updateLength()}}this._moved=false;this._resizing=false};Alternative.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Alternative.prototype.setName=function(b){this._components[1].setValue(b)};Alternative.prototype.getStereotypes=function(){return this._components[0]._childs};Alternative.prototype.getName=function(){return this._components[1].getValue()};Alternative.prototype.getStereotype=function(){return this._components[0]};var TimeInterval=function(b){b=b||{};TimeInterval.baseConstructor.call(this,b);this.setType("TimeInterval");this.setMoveable();this.setWidth(10);this.setMinHeight(30);this.setHeight(b.height||1);this.addFigure(new RectangleFigure({color:"#ffffff",changeFigureColor:false}))};JSFun.extend(TimeInterval,Rectangular);TimeInterval.prototype.drag=function(d,f){if(this._resizing){var e=f-this.getY();this.setHeight(e)}};TimeInterval.prototype.drop=function(d,c){if(this._moved){if(!this._alone){this._diagram.checkForParent(this)}this.updatePosition();if(this._parent){this._parent.updateContainer()}}else{if(this._resizing){this._message.notifyChange();this.notifyChange()}else{if(this._selectedBefore){this.selectComponent(d,c)}}}this._message.updateDeleteMessages();this._moved=false;this._resizing=false};TimeInterval.prototype.setMessage=function(b){if(b instanceof Message){this._message=b}else{this._message=null}};TimeInterval.prototype.getLineX=function(b){return this.getX()+this.getWidth()/2+(b*this.getWidth()/2)};TimeInterval.prototype.updateLength=function(){var m;var h=0;var g;var l;for(m in this._relations){if(this._relations[m]._elemA==this._relations[m]._elemB){l=this._relations[m].getY()+100}else{if(this._relations[m]._elemB==this){var o=(this._relations[m]._objB==0)?30:0;var l=this._relations[m].getY()+o}else{var n=(this._relations[m]._objA==0)?30:0;var l=this._relations[m].getY()+n}}if((this._relations[m] instanceof Message)&&l>h){h=l;g=this._relations[m]}}if(g){h=h-this._y;this.setMinHeight(h)}else{this.setMinHeight(30)}};TimeInterval.prototype.addRelation=function(d,c){var c=(JSFun.isNumber(c))?c:0;if(d._elemA==this&&d._objA&&(c==1||c==0)){d._objA.deleted();d._objA=0}if(d._elemB==this&&d._objB&&(c==2||c==0)){d._objB.deleted();d._objB=0}d.updateLimitY();if(d._y<d._limitY){d._y=d._limitY}if(!c){Lifeline.base.addRelation.call(this,d)}};TimeInterval.prototype.delRelation=function(f,h){var h=(JSFun.isNumber(h))?h:0;if(f._elemA==this&&f._objA==0&&(h==1||h==0)){f.setObjA(new TimeInterval());f._objA.setDiagram(f._diagram);f._diagram._addNode(f._objA)}if(f._elemB==this&&f._objB==0&&(h==2||h==0)){f.setObjB(new TimeInterval());f._objB.setDiagram(f._diagram);f._diagram._addNode(f._objB)}f._limitY=this._message._limitY;var e=this._diagram._nodes;for(var g=0;g<e.length;g++){if(e[g].getType()=="UMLLifeline"){e[g].updateLength()}}if(!h){TimeInterval.base.delRelation.call(this,f)}this.updateLength()};var SequenceDiagram=function(b){SequenceDiagram.baseConstructor.call(this,b)};JSFun.extend(SequenceDiagram,Diagram);SequenceDiagram.prototype._addNode=function(b){if(b instanceof Lifeline){b.setDiagram(this);b.updateLength()}SequenceDiagram.base._addNode.call(this,b)};SequenceDiagram.prototype._addRelation=function(b){if(b instanceof Message){b.setDiagram(this);if(b._elemA instanceof TimeInterval&&b._objA){b._objA.deleted();b._objA=0}if(b._elemB instanceof TimeInterval&&b._objB){b._objB.deleted();b._objB=0}this._relations.push(b);b.updateDeleteMessages();b.notifyChange()}else{SequenceDiagram.base._addRelation.call(this,b)}};SequenceDiagram.prototype.checkForParent=function(b){if((b instanceof Node)&&!(b instanceof Lifeline)&&!(b instanceof TimeInterval)){SequenceDiagram.base.checkForParent.call(this,b)}};SequenceDiagram.prototype.getXML=function(b){return SequenceDiagram.base.getXML.call(this,b)};SequenceDiagram.prototype._sortNodesByArea=function(){this._nodes.sort(function(b,h){var a=b.getArea();var g=h.getArea();if((b.getType()=="UMLLifeline"&&h.getType()!="TimeInterval")||(b.getType()!="TimeInterval"&&h.getType()=="UMLLifeline")){if(b.getType()=="UMLLifeline"){return -1}else{return 1}}else{if(a<g){return -1}else{if(a==g){return 0}else{return 1}}}})};SequenceDiagram.prototype._addElementOnly=function(b){if(b instanceof Node){b.setDiagram(this);this._nodes.push(b)}else{if(b instanceof Relation){b._diagram=this;this._relations.push(b)}}};SequenceDiagram.prototype._instantiateObjectFromString=function(elemName,parent){if(JSFun.isString(elemName)){parent=parent||null;var i;for(i in this._validElements){if(elemName==this._validElements[i]){if(elemName=="UMLAlternative"||elemName=="UMLCreate"||elemName=="UMLDestroy"||elemName=="UMLSendMessage"||elemName=="UMLCallMessage"||elemName=="UMLDeleteMessage"||elemName=="UMLReplyMessage"){var setElementXml=true;return eval("new "+this._validElements[i]+"({ setElementXml: "+setElementXml+"})")}else{if(parent){return(new window[this._validElements[i]]({addComponent:false,parent:parent}))}else{return eval("new "+this._validElements[i]+"()")}}}}}else{return null}};SequenceDiagram.prototype.setXML=function(g,l){var l=l||[];var m=[];if(this._alone){var h=g.getElementsByTagName(this.getType())[0];if(!h){return false}}else{var h=g}this._name.setValue(h.getAttribute("name"));if(h.getAttribute("backgroundNodes")){this._backgroundNodes=h.getAttribute("backgroundNodes")}this._stereotypes=l;var n=h.childNodes;var o;for(o=0;o<n.length;o++){this._instantiateElements(n[o],m)}for(o=0;o<n.length;o++){this._addElementXML(n[o],m,null)}for(o=0;o<this._relations.length;o++){this._relations[o].notifyChange()}this._sortNodesByArea();return true};var Message=function(b){b=b||{};this._y=b.y||0;this._limitY=0;this._objA=null;this._objB=null;Message.baseConstructor.call(this,b)};JSFun.extend(Message,Relation);Message.prototype.getElementXML=function(d){var c=Message.base.getElementXML.call(this,d);c.setAttribute("y",this._y);if(this._objA){c.setAttribute("a",this._objA.getId())}else{c.setAttribute("a",this._objA)}if(this._objB){c.setAttribute("b",this._objB.getId())}else{c.setAttribute("b",this._objB)}return c};Message.prototype.setElementXML=function(l,m){Message.base.setElementXML.call(this,l,m);this._y=parseInt(l.getAttribute("y"));var n=l.getAttribute("a");var g=l.getAttribute("b");var o=parseInt(n);if(JSFun.isNumber(o)){n=o}else{if(n=="null"){n=null}}var h=parseInt(g);if(JSFun.isNumber(h)){g=h}else{if(g=="null"){g=null}}if(n){this.setObjA(m[n])}else{this._objA=n}if(g){this.setObjB(m[g])}else{this._objB=g}};Message.prototype.setElements=function(c,d){this._points[0]=new Point();this._points[1]=new Point();if(c instanceof Element&&d instanceof Element){if(c instanceof Relation&&d instanceof Relation){return false}if(this._elemA&&this._elemA!=this._elemB){this._elemA.delRelation(this)}if(this._elemB){this._elemB.delRelation(this)}this._elemA=c;this._elemB=d;this._elemA.addRelation(this);if(c!=d){this._elemB.addRelation(this)}else{this._elemB.addRelation(this,2)}this.updateParent();this._calculateLineEnds();return true}else{return false}};Message.prototype.setElementA=function(b){if(b&&(b.getType()=="UMLLifeline"||b.getType()=="TimeInterval")){if(b instanceof Relation&&this._elemB instanceof Relation){return false}if(this._elemA){if(this._elemA!=this._elemB){this._elemA.delRelation(this)}else{this._elemA.delRelation(this,1)}}this._elemA=b;if(this._elemA!=this._elemB){this._elemA.addRelation(this)}else{this._elemA.addRelation(this,1)}this.updateParent();return true}else{return false}};Message.prototype.setElementB=function(b){if(b&&(b.getType()=="UMLLifeline"||b.getType()=="TimeInterval")){if(b instanceof Relation&&this._elemA instanceof Relation){return false}if(this._elemB){if(this._elemA!=this._elemB){this._elemB.delRelation(this)}else{this._elemB.delRelation(this,2)}}this._elemB=b;if(this._elemA!=this._elemB){this._elemB.addRelation(this)}else{this._elemB.addRelation(this,2)}this.updateParent();return true}else{return false}};Message.prototype.setLimitY=function(b){this._limitY=b};Message.prototype.getY=function(){return this._y};Message.prototype.select=function(e,f){this._deselectComponent();for(d=0;d<this._points.length;d++){if(Math.abs(e-this._points[d].getX())<=4&&Math.abs(f-this._points[d].getY())<=4){if(this._selected>-1){this._selectedBefore=true}this._selected=d;this._selectedPoint=true;return true}}if(this._selected>-1){if(this._isOverComponent(e,f)){this._selectedBefore=true;return true}}for(var d=0;d<this._points.length-1;d++){if(this._selectLine(this._points[d],this._points[d+1],e,f)){if(this._selected>-1){this._selectedBefore=true}this._selected=d;this._selectedLine=true;if(this._elemA==this._elemB){this._movementLine=f-this._points[0]._y}return true}}return false};Message.prototype.drag=function(e,f){if(this._selectedLine){var d;if(this._elemA==this._elemB){f-=this._movementLine}if(f>this._limitY){this._y=f}else{this._y=this._limitY}this._moved=true}else{if(this._selectedPoint){this._points[this._selected].setX(e);this._moved=true}}};Message.prototype.drop=function(d,c){if(this._moved){this._checkForNewNodes(d,c)}else{if(this._selectedBefore){this._selectComponent(d,c)}}this._selectedLine=false;this._selectedPoint=false;this._delUselessPoints();this.notifyChange();this.updateDeleteMessages();this.updateRelatedLifeline();this._moved=false};Message.prototype.updateRelatedLifeline=function(){var c=this.descendantMessages();for(var d=0;d<c.length;d++){if(c[d] instanceof CreateMessage){c[d]._elemB.updatePosition()}}};Message.prototype._checkForNewNodes=function(e,f){if(this._selectedPoint&&(this._selected==0||this._selected==this._points.length-1)){var d=this._diagram.reassignRelationTo(this,e,f);if(d!=this&&d!=this._objA&&d!=this._objB){if(this._selected==0){this.setElementA(d)}else{this.setElementB(d)}}}};Message.prototype.updateDeleteMessages=function(){var d=0;var f=[];var e=this._diagram._nodes;for(d=e.length;d--;){if((e[d] instanceof Lifeline)){f.push(e[d])}}f.sort(function(c,h){var a=c.getDelete();var b=h.getDelete();if(a<b){return -1}else{if(a==b){return 0}else{return 1}}});for(d=0;d<f.length;d++){f[d].updateDelete()}};Message.prototype._calculateLineEnds=function(t){var t=(t==false||t==0||t)?t:1;var z;if(!this._selectedPoint&&this._elemA&&this._elemB){if((this._y>=this._elemA.getY())&&(this._y<=(this._elemA.getY()+this._heightSmallRectangle))){this._y=this._elemA.getY()+this._heightSmallRectangle}var w=this;var s=function(a){if(a instanceof Lifeline){return a.getLineX()}else{if(a instanceof TimeInterval){if(a==w._elemA){if(a._x>w._elemB._x){return a.getLineX(-1)}else{return a.getLineX(1)}}else{if(a._x>w._elemA._x){return a.getLineX(-1)}else{return a.getLineX(1)}}}}};if(t==1){this.updateLimitY();if(this._y<this._limitY){this._y=this._limitY}}if(this._elemA==this._elemB){var r=(this._objA)?(this._objA.getHeight()+20):50;this._points[0].setPoint(s(this._elemA),this._y);this._points[1]=new Point(s(this._elemB)+50,this._y);this._points[2]=new Point(s(this._elemB)+50,this._y+r);this._points[3]=new Point(s(this._elemB),this._y+r)}else{this._points[0].setPoint(s(this._elemA),this._y);this._points[1].setPoint(s(this._elemB),this._y);while(this._points[2]){this._points.pop()}}if(t){this.updateObjects();var C;var q=[];if(t==1){this._moved=true}if(this._objA||(this._elemA instanceof TimeInterval&&this._objB)){var y=[];var u=(this._objA)?this._objA:this._elemA;if(this._objA){y=u._relations}else{for(var A=0;A<this._elemA._relations.length;A++){if(this._elemA._relations[A]._elemA==this._elemA._relations[A]._elemB){y.push(this._elemA._relations[A])}}}for(z=0;z<y.length;z++){if(!y[z]._moved){if(this._objA){C=(this._objA._y-this._objA._prey)}else{C=(this._objB)?(this._objB._y-this._objB._prey):0}y[z]._y=y[z]._y+C;y[z]._moved=true;y[z]._calculateLineEnds((!t)?t:2);y[z]._updateComponents()}}}if(this._objB||(this._elemB instanceof TimeInterval&&this._objA)){var B=[];var v=(this._objB)?this._objB:this._elemB;if(this._objB){B=v._relations}else{for(var A=0;A<this._elemB._relations.length;A++){if(this._elemB._relations[A]._elemA==this._elemB._relations[A]._elemB){B.push(this._elemB._relations[A])}}}for(z=0;z<B.length;z++){if(!B[z]._moved){if(this._objB){C=(this._objB)?(this._objB._y-this._objB._prey):(this._objA._y-this._objA._prey)}else{C=(this._objA)?(this._objA._y-this._objA._prey):0}B[z]._y=B[z]._y+C;B[z]._moved=true;B[z]._calculateLineEnds((!t)?t:2);B[z]._updateComponents()}}}if(t!=2){if(this._objA){this._objA.resetMovement()}if(this._objB){this._objB.resetMovement()}var x=this._sortAscendant(this.descendantMessages());for(z=0;z<x.length;z++){x[z]._moved=false;if(x[z]._objA){x[z]._objA.resetMovement()}if(x[z]._objB){x[z]._objB.resetMovement()}x[z].updateLimitY();if(x[z]._y<x[z]._limitY){x[z]._y=x[z]._limitY;x[z]._calculateLineEnds()}}}}}};Message.prototype.descendantMessages=function(c){var c=c||[];var d;if(!this.foundInArray(c)){c.push(this)}if(this._objA){for(d=0;d<this._objA._relations.length;d++){c=this._objA._relations[d].descendantMessages(c)}}else{if(this._elemA&&this._objB){for(d=0;d<this._elemA._relations.length;d++){if(this._elemA._relations[d]._elemA==this._elemA._relations[d]._elemB){c=this._elemA._relations[d].descendantMessages(c)}}}}if(this._objB){for(d=0;d<this._objB._relations.length;d++){c=this._objB._relations[d].descendantMessages(c)}}else{if(this._elemB&&this._objA){for(d=0;d<this._elemB._relations.length;d++){if(this._elemB._relations[d]._elemA==this._elemB._relations[d]._elemB){c=this._elemB._relations[d].descendantMessages(c)}}}}return c};Message.prototype._sortRelByCreateMessages=function(d,c){if(!(c==1||c==-1)){return d}d.sort(function(a,b){if(a instanceof CreateMessage&&b instanceof CreateMessage){if(a._y>b._y){return -1}else{return 1}}else{if(a instanceof CreateMessage&&!(b instanceof CreateMessage)){return c}else{if(!(a instanceof CreateMessage)&&b instanceof CreateMessage){return -c}else{return 0}}}});return d};Message.prototype._sortRelByDistanceToLimitY=function(b){b.sort(function(h,l){var a=h._y-h._limitY;var g=l._y-l._limitY;if(a>g){return -1}else{if(a<g){return 1}else{return 0}}});return b};Message.prototype._sortAscendant=function(b){b.sort(function(a,e){if(a._y>e._y){return 1}else{if(a._y<e._y){return -1}else{return 0}}});return b};Message.prototype.updateLimitY=function(){var c=0;var d=0;if(this._elemA){c=(this._elemA instanceof Lifeline)?(this._elemA.getY()+this._elemA._heightSmallRectangle+5):(this._elemA.getY()+5)}if(this._elemB){d=(this._elemB instanceof Lifeline)?(this._elemB.getY()+this._elemB._heightSmallRectangle+5):(this._elemB.getY()+5)}if(c>d||this instanceof CreateMessage){this.setLimitY(c)}else{this.setLimitY(d)}};Message.prototype.foundInArray=function(c){for(var d=c.length;d--;){if(c[d]==this){return true}}return false};Message.prototype.notifyChange=function(){var c;var d=(this._elemA._diagram)?this._elemA._diagram._nodes:[];Message.base.notifyChange.call(this);for(c=0;c<d.length;c++){if(((d[c].getType()=="UMLLifeline")&&!(d[c]._delete))||((d[c].getType()=="UMLLifeline")&&(d[c]._delete)&&((d[c]==this._elemA)||(d[c]==this._elemB)))||(d[c].getType()=="TimeInterval")){d[c].updateLength()}}};Message.prototype.deleted=function(){Message.base.deleted.call(this);if(this instanceof DeleteMessage){this._elemB.setDelete(0)}if(this._objA){this._objA.deleted()}if(this._objB){this._objB.deleted()}this.notifyChange()};Message.prototype.setObjA=function(b){this._objA=b;this._objA.setMessage(this);this.updateObjects()};Message.prototype.setObjB=function(b){this._objB=b;this._objB.setMessage(this);this.updateObjects()};Message.prototype.setDiagram=function(b){Message.base.setDiagram.call(this,b);if(this._objA){b._addNode(this._objA)}if(this._objB){b._addNode(this._objB)}};Message.prototype.updateObjects=function(){if(this._objA){this._objA.setPosition(this._points[0].getX()-this._objA.getWidth()/2,this._points[0].getY())}if(this._objB){if(this._elemA==this._elemB){this._objB.setPosition(this._points[3].getX()-this._objB.getWidth()/2,this._points[3].getY())}else{this._objB.setPosition(this._points[1].getX()-this._objB.getWidth()/2,this._points[1].getY())}}};Message.prototype.resetMovementObjects=function(){if(this._objA){this._objA.resetMovement()}if(this._objB){this._objB.resetMovement()}};Message.prototype._updateComponents=function(){if(!(this._elemA&&this._elemB)){return}var o=this._points[0].getX();var g=this._points[0].getY();var m=this._points[1].getX();var n=this._points[1].getY();if(this._elemA==this._elemB&&this._points.length==4){m=this._points[2].getX();n=this._points[2].getY()}var h=(o+m)/2;var l=(g+n)/2;if(this._name){if(this._elemA==this._elemB){this._name.setCoordinates(m,l-this._name.getHeight()/2)}else{this._name.setCoordinates(h-this._name.getWidth()/2,l-this._name.getHeight())}}if(this._stereotype){if(this._name){if(this._elemA==this._elemB){this._stereotype.setCoordinates(m,l-this._stereotype.getHeight()-this._name.getHeight()/2)}else{this._stereotype.setCoordinates(h-this._stereotype.getWidth()/2,l-this._stereotype.getHeight()-this._name.getHeight())}}else{if(this._elemA==this._elemB){this._stereotype.setCoordinates(m,l-(this._stereotype.getHeight())/2)}else{this._stereotype.setCoordinates(h-this._stereotype.getWidth()/2,l-this._stereotype.getHeight())}}if(this._stereotype instanceof SuperComponent){this._stereotype.updateComponents()}}};Message.prototype.drawShape=function(c){if(!(this._selectedPoint&&this._selected==0||this._selected==this._points.length-1)){this._calculateLineEnds(0)}c.save();c.lineWidth=2;c.strokeStyle=RelationStyle.shape_color;c.beginPath();c.moveTo(this._points[0].pixelX(),this._points[0].pixelY());var d;for(var d=1;d<this._points.length;d++){c.lineTo(this._points[d].pixelX(),this._points[d].pixelY())}c.stroke();c.restore()};var CallMessage=function(b){b=b||{};CallMessage.baseConstructor.call(this,b)};JSFun.extend(CallMessage,Message);CallMessage.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};CallMessage.prototype.setName=function(b){this._components[1].setValue(b)};CallMessage.prototype.getStereotypes=function(){return this._components[0]._childs};CallMessage.prototype.getName=function(){return this._components[1].getValue()};var CreateMessage=function(b){b=b||{};CreateMessage.baseConstructor.call(this,b)};JSFun.extend(CreateMessage,Message);CreateMessage.prototype.setElementXML=function(c,d){CreateMessage.base.setElementXML.call(this,c,d);this._elemB.setCreate(this._y);this._elemA.updatePosition();this._elemB.updatePosition()};CreateMessage.prototype.setElements=function(g,e){CreateMessage.base.setElements.call(this,g,e);var f;if(this._elemB){this._elemB.updatePosition()}var h=this.descendantsCreateMessages();for(f=0;f<h.length;f++){h[f].updatePosition()}};CreateMessage.prototype.deleted=function(){CreateMessage.base.deleted.call(this);this._elemB.setPosition(this._elemB.getX(),70);this._elemB.updatePosition();this._elemB.setCreate(0);if(this._elemA){this._elemA.updateLength()}if(this._elemB){this._elemB.updateLength()}var d=this._elemB._relations;for(var c=0;c<d.length;c++){if(d[c]._elemA._y>d[c]._elemB._y||d[c] instanceof CreateMessage){d[c].setLimitY(d[c]._elemA.getY()+d[c]._elemA._heightSmallRectangle+5)}else{d[c].setLimitY(d[c]._elemB.getY()+d[c]._elemB._heightSmallRectangle+5)}}};CreateMessage.prototype.drop=function(f,g){CreateMessage.base.drop.call(this,f,g);this._elemB.updatePosition();var h=this.descendantsCreateMessages();for(var e=0;e<h.length;e++){h[e].updatePosition()}};CreateMessage.prototype._calculateLineEnds=function(p){var p=(p==0||p)?p:1;var s;var u;if(!(!this._selectedPoint&&this._elemA&&this._elemB)||this._elemA==this._elemB){return}var n=this._sortRelByCreateMessages(this._elemB._relations,1);var q=[];var t,v,w;if((this._y>=this._elemA.getY())&&(this._y<=(this._elemA.getY()+this._heightSmallRectangle))){this._y=this._elemA.getY()+this._heightSmallRectangle}if(p==1){this.updateLimitY();if(this._y<this._limitY){this._y=this._limitY}}this._points[0].setPoint(this._elemA.getLineX((this._elemA._x>this._elemB._x)?-1:1),this._y);if(this._elemB.getX()>this._elemA.getX()){this._points[1].setPoint(this._elemB.getX(),this._y)}else{this._points[1].setPoint(this._elemB.getX()+this._elemB.getWidth(),this._y)}this._elemB._y=this._y-this._elemB._heightSmallRectangle/2;if(p){if(p==1){this._moved=true}for(t=0;t<n.length;t++){if(!n[t]._moved){n[t]._y=n[t]._y+this._y-this._elemB.getCreate();n[t].setLimitY(this._y+this._elemB._heightSmallRectangle/2+5);if(n[t]._limitY>n[t]._y){n[t]._y=n[t]._limitY}n[t]._moved=true;n[t]._calculateLineEnds((!p)?p:2);n[t]._updateComponents();if(n[t] instanceof DeleteMessage){n[t]._elemB.setDelete(n[t]._y)}}}this._elemB.setCreate(this._y);if(this._elemB.getCreate()!=0){for(t=0;t<n.length;t++){if(n[t]._y<this._elemB.getCreate()&&!(n[t]._elemA instanceof TimeInterval)&&!(n[t]._elemB instanceof TimeInterval)){var o=n[t]._y;n[t]._points[0].setY(o+this._elemB.getCreate()-this._elemA.getY());n[t]._points[1].setY(o+this._elemB.getCreate()-this._elemA.getY());n[t]._y=o+this._elemB.getCreate()-this._elemA.getY();n[t].setLimitY(this._y+this._elemB._heightSmallRectangle/2+5);if(n[t]._limitY>n[t]._y){n[t]._y=n[t]._limitY}n[t]._updateComponents();n[t].updateObjects();n[t].notifyChange()}}}if(p==1){var r=this._sortAscendant(this.descendantMessages());for(t=0;t<r.length;t++){r[t]._moved=false;if(r[t]._objA){r[t]._objA.resetMovement()}if(r[t]._objB){r[t]._objB.resetMovement()}r[t].updateLimitY();if(r[t]._y<r[t]._limitY){r[t]._y=r[t]._limitY;r[t]._calculateLineEnds()}}}this.updateObjects()}};CreateMessage.prototype.descendantMessages=function(c){var c=c||[];if(!this.foundInArray(c)){c.push(this)}if(this._elemB){for(var d=0;d<this._elemB._relations.length;d++){if(this._elemB._relations[d]!=this){c=this._elemB._relations[d].descendantMessages(c)}}}return c};CreateMessage.prototype.drag=function(e,f){if(this._selectedLine){var d;if(f>this._limitY){this._y=f}else{this._y=this._limitY}this._moved=true}else{if(this._selectedPoint){}}};CreateMessage.prototype.descendantsCreateMessages=function(){if(!this._elemB){return[]}var m=this._elemB._relations;var r;var s;var p=[];var n=[];var q=false;for(r=0;r<m.length;r++){if((m[r] instanceof CreateMessage)&&(m[r]._elemA==this._elemB)&&(m[r]._elemA!=m[r]._elemB)){q=false;for(s=0;s<p.length&&!q;s++){if(p[s]==m[r]._elemB){q=true}}if(!q){p.push(m[r]._elemB);n=m[r].descendantsCreateMessages();for(s=0;s<n.length;s++){p.push(n[s])}}}else{if(m[r]._elemA==this){var o=(m[r]._objA)?m[r]._objA._relations:[]}else{var o=(m[r]._objB)?m[r]._objB._relations:[]}for(s=0;s<o.length;s++){if((o[s] instanceof CreateMessage)){p.push(o[s]._elemB);n=o[s].descendantsCreateMessages();for(var l=0;l<n.length;l++){p.push(n[l])}}}}}return p};var DeleteMessage=function(b){b=b||{};DeleteMessage.baseConstructor.call(this,b)};JSFun.extend(DeleteMessage,Message);DeleteMessage.prototype._checkForNewNodes=function(e,f){if(this._selectedPoint&&(this._selected==0||this._selected==this._points.length-1)){var d=this._diagram.reassignRelationTo(this,e,f);if(d){if(this._selected==0){if(d!=this._elemB&&d!=this._objA&&((d.getType()=="UMLLifeline"&&!d.getDelete())||d.getType()=="TimeInterval")){this.setElementA(d)}}else{if(d!=this._elemA&&d.getType()=="UMLLifeline"&&!d.getDelete()){this.setElementB(d)}}this.notifyChange()}}};DeleteMessage.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};DeleteMessage.prototype.setName=function(b){this._components[1].setValue(b)};DeleteMessage.prototype.getStereotypes=function(){return this._components[0]._childs};DeleteMessage.prototype.getName=function(){return this._components[1].getValue()};var Interaction=function(b){b=b||{};Interaction.baseConstructor.call(this,b)};JSFun.extend(Interaction,Rectangular);Interaction.prototype.drop=function(o,p){var t,u;if(this._moved){if(!this._alone){this._diagram.checkForParent(this)}var n=this._diagram._relations;var v=[];var s=[];var q=[];for(t=0;t<n.length;t++){if(this.isOverBeforePosition(n[t].getCentralPoint())&&n[t] instanceof Message){s.push(n[t].getCentralPoint());v.push(n[t])}}if(v.length){v=v[0]._sortRelByDistanceToLimitY(v)}for(t=0;t<v.length;t++){if(!v[t]._moved){v[t]._y=v[t]._y+(p-this._rely-this._prey);if(v[t]._y<v[t]._limitY){v[t]._y=v[t]._limitY}v[t]._moved=true;v[t]._calculateLineEnds(2)}}for(u=0;u<v.length;u++){var r=v[u]._sortAscendant(v[u].descendantMessages());for(t=0;t<r.length;t++){r[t]._moved=false;if(r[t]._objA){r[t]._objA.resetMovement()}if(r[t]._objB){r[t]._objB.resetMovement()}r[t].notifyChange()}}for(t=0;t<v.length;t++){v[t].updateRelatedLifeline()}if(v.length){v[0].updateDeleteMessages()}}Interaction.base.drop.call(this,o,p);var w=this._diagram._nodes;for(t=0;t<w.length;t++){if(w[t] instanceof Lifeline){w[t].updateLength()}}this._moved=false;this._resizing=false};Interaction.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Interaction.prototype.setName=function(b){this._components[1].setValue(b)};Interaction.prototype.setGuard=function(b){if(this._components[2]){this._components[2].setValue("["+b+"]")}};Interaction.prototype.getStereotypes=function(){return this._components[0]._childs};Interaction.prototype.getName=function(){return this._components[1].getValue()};Interaction.prototype.getGuard=function(){var c=this._components[2].getValue();var d=(this._components[2])?c.substring(1,c.length-1):null;return d};Interaction.prototype.getStereotype=function(){return this._components[0]};var Lifeline=function(b){b=b||{};Lifeline.baseConstructor.call(this,b);this._delete=0;this._create=0;this._limitY=-1;this.setHeightSmallRectangle(b.heightSmallRectangle||25)};JSFun.extend(Lifeline,Rectangular);Lifeline.prototype.setHeightSmallRectangle=function(b){this._heightSmallRectangle=b};Lifeline.prototype.isOver=function(d,c){if(d instanceof Point){c=d.getY();d=d.getX()}if((d>=this._x&&d<=this._x+this._width&&c>=this._y&&c<=this._y+this._heightSmallRectangle)||(d>=(this.getLineX()-5)&&d<=(this.getLineX()+5)&&c>=(this._y+this._heightSmallRectangle)&&c<=(this._y+this._height))){return true}return false};Lifeline.prototype.notifyChange=function(){var m;var l=[];var g,h;var n=this._heightSmallRectangle;this.setHeightSmallRectangle(this._components[0].getHeight()+this._components[1].getHeight());var o=this._heightSmallRectangle-n;for(g=0;g<this._relations.length;g++){if(!(this._relations[g] instanceof CreateMessage)||((this._relations[g] instanceof CreateMessage)&&(this._relations[g]._elemA==this))){if(o){if(!(this._relations[g] instanceof CreateMessage)){if(this._relations[g]._elemA==this){if((this._relations[g]._elemB._y+this._relations[g]._elemB._heightSmallRectangle+5)<(this._y+this._heightSmallRectangle+5)){this._relations[g].setLimitY(this._y+this._heightSmallRectangle+5)}else{this._relations[g].setLimitY(this._relations[g]._elemB._y+this._relations[g]._elemB._heightSmallRectangle+5)}}else{if((this._relations[g]._elemA._y+this._relations[g]._elemA._heightSmallRectangle+5)<(this._y+this._heightSmallRectangle+5)){this._relations[g].setLimitY(this._y+this._heightSmallRectangle+5)}else{this._relations[g].setLimitY(this._relations[g]._elemA._y+this._relations[g]._elemA._heightSmallRectangle+5)}}}else{this._relations[g].setLimitY(this._y+this._heightSmallRectangle+5)}}if(this._relations[g]._y<(this._y+this._heightSmallRectangle+5)){this._relations[g]._y+=o;this._relations[g].notifyChange();if(this._relations[g] instanceof CreateMessage){this._relations[g]._elemB.updatePosition();m=this._relations[g].descendantsCreateMessages();for(h=0;h<m.length;h++){m[h].updatePosition()}}else{this._relations[g].updateRelatedLifeline()}}}if(o&&this._relations[g] instanceof CreateMessage&&(this._relations[g]._elemB==this)){this._relations[g].notifyChange()}if(o){this.resetMovement()}}if(o&&this._relations.length){this._relations[0].updateDeleteMessages()}if(this._container){this.updateContainer()}else{this.updateComponents();if(this._parent){this._parent.updateContainer()}}this.setWidth((this._minWidth>60)?this._minWidth:60);this.updateComponents()};Lifeline.prototype.getLineX=function(){return this.getX()+this.getWidth()/2};Lifeline.prototype.drag=function(e,f){if(!this.resizing&&this._selected){var d=e-this._relx;this.setPosition(d,this.getY());this._moved=true}else{Lifeline.base.drag.call(this,e,f)}};Lifeline.prototype.updateDelete=function(){if(!this._delete){return}var z,A;var q;var v;var t=20;var u,x;var p=this._relations;var r=0;var s;for(u=0;u<p.length;u++){if(p[u] instanceof Message){if(!(p[u] instanceof DeleteMessage)||(p[u] instanceof DeleteMessage&&p[u]._elemB!=this)){v=p[u].getY();if(p[u]._elemA==p[u]._elemB){v+=(p[u]._objA)?(p[u]._objA.getHeight()+20):50;q=(p[u]._objB)?p[u]._objB.getHeight():0}else{z=(p[u]._objA)?p[u]._objA.getHeight():0;A=(p[u]._objB)?p[u]._objB.getHeight():0;if(z>A){q=z}else{q=A}}if((v+q+t)>r){r=v+q+t}if(p[u]._objA){var w=p[u]._objA._relations;for(x=0;x<w.length;x++){v=w[x].getY();z=(w[x]._objA)?w[x]._objA.getHeight():0;A=(w[x]._objB)?w[x]._objB.getHeight():0;if(z>A){q=z}else{q=A}if((v+q+t)>r){r=v+q+t}}}if(p[u]._objB){var y=p[u]._objB._relations;for(x=0;x<y.length;x++){v=y[x].getY();z=(y[x]._objA)?y[x]._objA.getHeight():0;A=(y[x]._objB)?y[x]._objB.getHeight():0;if(z>A){q=z}else{q=A}if((v+q+t)>r){r=v+q+t}}}}else{s=p[u]}}}if(s._y<r){this._delete=r}else{this._delete=s._y}s._y=this._delete;s.notifyChange()};Lifeline.prototype.updateLength=function(){var q;var o=0;if(this._delete){for(q in this._relations){if((this._relations[q] instanceof Message)&&this._relations[q].getY()>o){o=this._relations[q].getY()}}}else{var m=this._diagram._relations;var u=this._diagram._nodes;var s,t;var r;var n=0;var p;for(q=0;q<m.length;q++){if(m[q] instanceof Message){r=m[q].getY();if(m[q]._elemA==m[q]._elemB){r+=(m[q]._objA)?(m[q]._objA.getHeight()+20):50;n=(m[q]._objB)?m[q]._objB.getHeight():0}else{s=(m[q]._objA)?m[q]._objA.getHeight():0;t=(m[q]._objB)?m[q]._objB.getHeight():0;if(s>t){n=s}else{n=t}}if((r+n)>o){o=r+n;p=m[q]}}}for(q=0;q<u.length;q++){if((u[q] instanceof Alternative)||(u[q] instanceof Interaction)){if((u[q].getY()+u[q]._height)>o){o=u[q].getY()+u[q]._height;p=null}}}}o=o-this.getY();if(o<=0){o=200}if(o<this._heightSmallRectangle+60&&!this._delete){o=this._heightSmallRectangle+60}if(p&&p instanceof CreateMessage){if(p._elemB==this){if(!p._elemA.getDelete()){if((p._elemA.getY()+p._elemA.getHeight())<(this.getY()+o+60)){p._elemA.setHeight(this.getY()+o+60-p._elemA.getY())}}}else{p._elemB.updateLength();if((p._elemB.getY()+p._elemB.getHeight())>(this.getY()+o+60)){o=p._elemB.getY()+p._elemB.getHeight()-this.getY()-60}}}if(this._delete){this.setHeight(o)}else{this.setHeight(o+60)}};Lifeline.prototype.setDelete=function(b){this._delete=b};Lifeline.prototype.getDelete=function(){return this._delete};Lifeline.prototype.setCreate=function(b){this._create=b};Lifeline.prototype.getCreate=function(){return this._create};Lifeline.prototype.addRelation=function(d,c){var c=(JSFun.isNumber(c))?c:0;if(d instanceof DeleteMessage&&d._elemB==this){this.setDelete(d._y)}if(d instanceof CreateMessage&&d._elemB==this){this.setCreate(d._y)}d.updateLimitY();if(d._y<d._limitY){d._y=d._limitY}if(!c){Lifeline.base.addRelation.call(this,d)}};Lifeline.prototype.updatePosition=function(l,f){var m,g;if(l==undefined||f==undefined){var h=this.getMovement();var l=h.getX();var f=h.getY();this.resetMovement();for(m in this._relations){this._relations[m].updatePosition()}}else{this._x+=l;this._y+=f}this.resetMovement();for(m in this._components){this._components[m].updatePosition(l,f)}for(m in this._relations){if(this._relations[m].getParent()!=this._parent){this._relations[m].notifyChange()}}if(this._container){for(m in this._nodeChilds){this._nodeChilds[m].updatePosition(l,f)}for(m in this._relationChilds){this._relationChilds[m].updatePosition(l,f)}}};Lifeline.prototype.delRelation=function(f,h){var h=(JSFun.isNumber(h))?h:0;if(f instanceof DeleteMessage&&f._elemB==this){this.setDelete(0)}if(f instanceof DeleteMessage){this._limitY=-1}if(f.getType()=="UMLCreate"&&f._elemB==this){this.setCreate(0)}var e=this._diagram._nodes;for(var g=0;g<e.length;g++){if(e[g].getType()=="UMLLifeline"){e[g].updateLength()}}if(!h){Lifeline.base.delRelation.call(this,f)}};Lifeline.prototype.draw=function(d){Lifeline.base.draw.call(this,d);if(this._delete){var e=this.getX()+this.getWidth()/2;var f=this.getY()+this.getHeight();d.save();d.strokeStyle="#000000";d.translate(e,f);d.beginPath();d.moveTo(-8.5,8.5);d.lineTo(8.5,-8.5);d.moveTo(8.5,8.5);d.lineTo(-8.5,-8.5);d.stroke();d.restore()}};Lifeline.prototype.drawShape=function(b){b.save();b.lineWidth=2.5;b.strokeStyle=NodeStyle.shape_color;b.strokeRect(JSGraphic.toPixel(this._x),JSGraphic.toPixel(this._y),this._width,this._heightSmallRectangle);b.beginPath();b.moveTo(this.getLineX(),JSGraphic.toPixel(this._y)+this._heightSmallRectangle);b.lineTo(this.getLineX(),JSGraphic.toPixel(this._y)+this._height);b.closePath();b.stroke();b.restore()};Lifeline.prototype.drawFigures=function(c){var d;for(d=0;d<this._figures.length;d+=1){this._figures[d].draw(c,this._x,this._y,this._width,this._height,this._heightSmallRectangle)}};Lifeline.prototype.setName=function(b){this._components[1].setValue(b)};Lifeline.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Lifeline.prototype.getStereotypes=function(){return this._components[0]._childs};Lifeline.prototype.getName=function(){return this._components[1].getValue()};Lifeline.prototype.getStereotype=function(){return this._components[0]};var RegionAlternative=function(b){b=b||{};RegionAlternative.baseConstructor.call(this,b)};JSFun.extend(RegionAlternative,Region);RegionAlternative.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};RegionAlternative.prototype.setGuard=function(b){if(this._components[1]){this._components[1].setValue("["+b+"]")}};RegionAlternative.prototype.getStereotypes=function(){return this._components[0]._childs};RegionAlternative.prototype.getGuard=function(){var c=this._components[1].getValue();var d=(this._components[1])?c.substring(1,c.length-1):null;return d};RegionAlternative.prototype.getStereotype=function(){return this._components[0]};var RegionAlternativeItem=function(b){b=b||{};RegionAlternativeItem.baseConstructor.call(this,b)};JSFun.extend(RegionAlternativeItem,RegionItem);RegionAlternativeItem.prototype.createRegion=function(){var b=this.getParent()._components.length;if(this.getParent()._orientation){this.getParent().addRegion(new RegionAlternative({parent:this.getParent()}))}else{this.getParent().addRegion(new RegionAlternative({parent:this.getParent()}))}};var ReplyMessage=function(b){b=b||{};ReplyMessage.baseConstructor.call(this,b)};JSFun.extend(ReplyMessage,Message);ReplyMessage.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};ReplyMessage.prototype.setName=function(b){this._components[1].setValue(b)};ReplyMessage.prototype.getStereotypes=function(){return this._components[0]._childs};ReplyMessage.prototype.getName=function(){return this._components[1].getValue()};var SendMessage=function(b){b=b||{};SendMessage.baseConstructor.call(this,b)};JSFun.extend(SendMessage,Message);SendMessage.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};SendMessage.prototype.setName=function(b){this._components[1].setValue(b)};SendMessage.prototype.getStereotypes=function(){return this._components[0]._childs};SendMessage.prototype.getName=function(){return this._components[1].getValue()};var UMLSequenceDiagram=function(c){c=c||{};var d=new SequenceDiagram(c);d.setType("UMLSequenceDiagram");d.setName("Sequence diagram");setStereotypeObjects(c.stereotypes||[],d);d.setValidElements(["UMLNote","UMLLine","UMLCreate","UMLDestroy","UMLLifeline","UMLCallMessage","UMLSendMessage","UMLDeleteMessage","UMLReplyMessage","UMLOption","UMLAlternative","UMLLoop","UMLBreak","Region","TimeInterval"]);return d};var UMLLifeline=function(c){var c=c||{};var d=new Lifeline(c);d.setType("UMLLifeline");setStereotypeProperties(d);d.setHeight(250);d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextBox({id:"name",centered:true,margin:3}));d.addFigure(new LifelineFigure({color:"#c6dbdc"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLCreate=function(c){var d=new CreateMessage(c);d.setType("UMLCreate");d.setStereotype("\xABcreate\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLDestroy=function(c){var d=new DeleteMessage(c);d.setType("UMLDestroy");d.setStereotype("\xABdestroy\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLSendMessage=function(c){var d=new SendMessage(c);d.setType("UMLSendMessage");d.addComponentStereotype();d.setComponentName();if(c.setElementXml){}else{d.setObjA(new TimeInterval());d.setObjB(new TimeInterval())}d.setLine(new SolidLine());d.setEnd(new OpenTip());return d};var UMLCallMessage=function(c){var d=new CallMessage(c);d.setType("UMLCallMessage");d.addComponentStereotype();d.setComponentName();if(c.setElementXml){}else{d.setObjA(new TimeInterval());d.setObjB(new TimeInterval())}d.setLine(new SolidLine());d.setEnd(new CloseTip({color:"#000000"}));return d};var UMLReplyMessage=function(c){var d=new ReplyMessage(c);d.setType("UMLReplyMessage");d.addComponentStereotype();d.setComponentName();if(c.setElementXml){}else{d.setObjB(new TimeInterval())}d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLDeleteMessage=function(c){var d=new DeleteMessage(c);d.setType("UMLDeleteMessage");d.addComponentStereotype();d.setComponentName();if(c.setElementXml){}else{d.setObjA(new TimeInterval())}d.setLine(new SolidLine());d.setEnd(new OpenTip());return d};var UMLOption=function(c){var c=c||{};var d=new Interaction(c);d.setType("UMLOption");setStereotypeProperties(d);d.setMoveable();d.setContainer();d.setWidth(200);d.setHeight(100);d.addComponent(new StereotypeTagList({id:"stereotypes"}));d.addComponent(new Tab({id:"name",text:"OPT",margin:4,selected:true}));d.addComponent(new GuardItem({id:"guard",text:"[]",margin:1}));d.addFigure(new RectangleFigure());d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLAlternative=function(c){var c=c||{};c=c||{};var d=new Alternative(c);d.setType("UMLAlternative");setStereotypeProperties(d);d.setMoveable();d.setWidth(200);d.setHeight(100);d.addComponent(new StereotypeTagList({id:"stereotypes"}));d.addComponent(new Tab({id:"name",text:"ALT",margin:4,selected:true}));d.addComponent(new RegionAlternativeItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));d.addFigure(new RectangleFigure());if(c.setElementXml){}else{d.addRegion(new RegionAlternative({parent:d,position:Component.BottomLeft}));d.addRegion(new RegionAlternative({parent:d,position:Component.BottomLeft}))}d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLLoop=function(c){var c=c||{};var d=new Interaction(c);d.setType("UMLLoop");setStereotypeProperties(d);d.setMoveable();d.setContainer();d.setWidth(200);d.setHeight(100);d.addComponent(new StereotypeTagList({id:"stereotypes"}));d.addComponent(new LoopItem({id:"name",text:"LOOP",margin:4}));d.addComponent(new GuardItem({id:"guard",text:"[]",margin:1}));d.addFigure(new RectangleFigure());d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLBreak=function(c){var c=c||{};var d=new Interaction(c);d.setType("UMLBreak");setStereotypeProperties(d);d.setMoveable();d.setContainer();d.setWidth(200);d.setHeight(100);d.addComponent(new StereotypeTagList({id:"stereotypes"}));d.addComponent(new Tab({id:"name",text:"BREAK",margin:4,selected:true}));d.addFigure(new RectangleFigure());d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var CompositeState=function(b){b=b||{};CompositeState.baseConstructor.call(this,b);this.setHeightSmallRectangle(b.heightSmallRectangle||15);this.setWidthSmallRectangle(b.widthSmallRectangle||75);this.setXmovement(b.Xmovement||15)};JSFun.extend(CompositeState,SuperNode);CompositeState.prototype.setHeightSmallRectangle=function(b){this._heightSmallRectangle=b};CompositeState.prototype.setWidthSmallRectangle=function(b){this._widthSmallRectangle=b};CompositeState.prototype.setXmovement=function(b){this._Xmovement=b};CompositeState.prototype.updateContainer=function(w){if(!(w==false||w==true)){w=true}if(this._container){var s;var v=this._x;var x=this._y+this._heightSmallRectangle;var y=this._x;var z=this._y+this._heightSmallRectangle;var t;var p,A,r,u;var q=this._nodeChilds.length;for(s=0;s<q;s++){t=this._nodeChilds[s];if(t._visible){if(this._orientation){r=t._x;elemLeftY=t._y;if(s==(q-1)){p=t._x+t._minWidth}else{p=t._x+t._width}elemRigthY=t._y+t._minHeight}else{r=t._x;elemLeftY=t._y;p=t._x+t._minWidth;if(s==(q-1)){elemRigthY=t._y+t._minHeight}else{elemRigthY=t._y+t._height}p=t._x+t._minWidth}if(p>y){y=p}if(elemRigthY>z){z=elemRigthY}if(r<v){v=r}if(elemLeftY<x){x=elemLeftY}}}if(v<this._x||x<(this._y+this._heightSmallRectangle)){this.setWidth(this._x-v+this._width);this.setHeight(this._y+this._heightSmallRectangle-x+this._height);this._x=v;this._y=x-this._heightSmallRectangle;this.setMinWidth(y-v);this.setMinHeight(z-this._y)}else{this.setMinWidth(y-this._x);this.setMinHeight(z-this._y)}this._prex=this._x;this._prey=this._y;this.updateComponents();if(this._parent&&w){this._parent.updateContainer()}}};CompositeState.prototype.notifyChange=function(m,g,f){m=m||false;g=g||false;f=f||false;var h=this._heightSmallRectangle;this.setHeightSmallRectangle(this._components[0].getHeight()+this._components[1].getHeight());var l=this._heightSmallRectangle-h;if(l){this._y=this._y-l;this.setHeight(this._height+l)}if(this._components[0].getWidth()>this._components[1].getWidth()){this.setWidthSmallRectangle(this._components[0].getWidth())}else{this.setWidthSmallRectangle(this._components[1].getWidth())}CompositeState.base.notifyChange.call(this,m,g,f)};CompositeState.prototype.getElementXML=function(l){var h=l.createElement(this.getType());var g=this._beforeHeight||this.getHeight();var m=this._beforeWidth||this.getWidth();h.setAttribute("id",this.getId());h.setAttribute("x",this.getX());h.setAttribute("y",this.getY()+this._components[0]._height-1);h.setAttribute("width",m);h.setAttribute("height",g-this._components[0]._height+1);h.setAttribute("backgroundColor",this.getBackgroundColor());h.setAttribute("orientation",this._orientation);h.setAttribute("includeComponentByRegion",this._includeComponentByRegion);var f;for(f in this._components){if(this._components[f].getId()){h.appendChild(this._components[f].getComponentXML(l))}}for(f in this._nodeChilds){h.appendChild(this._nodeChilds[f].getElementXML(l))}for(f in this._relationChilds){h.appendChild(this._relationChilds[f].getElementXML(l))}return h};CompositeState.prototype.setElementXML=function(g){this.setPosition(parseInt(g.getAttribute("x")),parseInt(g.getAttribute("y")));this.resetMovement();this.setWidth(parseInt(g.getAttribute("width")));this.setHeight(parseInt(g.getAttribute("height")));this.setBackgroundColor(g.getAttribute("backgroundColor"));this._orientation=parseInt(g.getAttribute("orientation"));this._includeComponentByRegion=g.getAttribute("includeComponentByRegion");this._includeComponentByRegion=(this._includeComponentByRegion=="true")?true:false;var e;var h=g.childNodes;for(e=0;e<h.length;e++){if(h[e].nodeName=="item"){if(h[e].getAttribute("behaviors")!=null&&(h[e].getAttribute("visible")=="true"||h[e].getAttribute("visible")=="false")){this.setValue(h[e].getAttribute("id"),h[e].getAttribute("value"),h[e].getAttribute("behaviors"),h[e].getAttribute("visible"))}else{this.setValue(h[e].getAttribute("id"),h[e].getAttribute("value"))}}else{if(h[e].nodeName=="superitem"){var f;for(f in this._components){if(this._components[f].getId()==h[e].getAttribute("id")){this._components[f].setComponentXML(h[e])}}}}}this.notifyChange()};CompositeState.prototype.getLinkCentered=function(p,q){if(this._selectedFigure){return CompositeState.base.getLinkCentered.call(this,p,q)}if(p instanceof Point){q=p.getY();p=p.getX()}var r=this.getCentralPoint();var v=r.getX();var w=r.getY();var y,m,s,t;y=this.getX();m=this.getY();s=r.getX();t=this.getY();var x;if(p<v){if(q<w){x=(this.getY()+this._heightSmallRectangle-w)/(this.getX()-v);if(((q-w)==0)||Math.abs((q-w)/(p-v))<Math.abs(x)){s=this.getX();t=this.getY()+this.getHeight()}else{x=(this.getY()+this._heightSmallRectangle-w)/(this.getX()+this._Xmovement-v);if(Math.abs((q-w)/(p-v))<Math.abs(x)){m=this.getY()+this._heightSmallRectangle;s=this.getX()+this.getWidth();t=this.getY()+this._heightSmallRectangle}else{x=(this.getY()-w)/(this.getX()+this._Xmovement-v);if(Math.abs((q-w)/(p-v))<Math.abs(x)){y=this.getX()+this._Xmovement;m=this.getY();s=this.getX()+this._Xmovement;t=this.getY()+this._heightSmallRectangle}else{var u=this.getX()+this._Xmovement+this._widthSmallRectangle;x=(this.getY()-w)/(u-v);if(Math.abs((q-w)/(p-v))<Math.abs(x)){y=this.getX();m=this.getY();s=this.getX()+this.getWidth();t=this.getY()}else{y=this.getX();m=this.getY()+this._heightSmallRectangle;s=this.getX()+this.getWidth();t=this.getY()+this._heightSmallRectangle}}}}}else{x=(this.getY()+this.getHeight()-w)/(this.getX()-v);if(((q-w)==0)||Math.abs((q-w)/(p-v))<Math.abs(x)){s=this.getX();t=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();s=this.getX()+this.getWidth();t=this.getY()+this.getHeight()}}}else{if(q<w){var u=this.getX()+this._Xmovement+this._widthSmallRectangle;x=(this.getY()+this._heightSmallRectangle-w)/(this.getX()+this.getWidth()-v);if(((q-w)==0)||((q-w)/(p-v))<x){x=(this.getY()-w)/(this.getX()+this._Xmovement+this._widthSmallRectangle-v);if((u>(this.getX()+this.getWidth()/2))&&Math.abs((q-w)/(p-v))>Math.abs(x)){s=this.getX()+this.getWidth();t=this.getY()}else{x=(this.getY()+this._heightSmallRectangle-w)/(u-v);if((u<(this.getX()+this.getWidth()/2))||Math.abs((q-w)/(p-v))<Math.abs(x)){y=this.getX();m=this.getY()+this._heightSmallRectangle;s=this.getX()+this.getWidth();t=this.getY()+this._heightSmallRectangle}else{y=this.getX()+this._Xmovement+this._widthSmallRectangle;m=this.getY();s=this.getX()+this._Xmovement+this._widthSmallRectangle;t=this.getY()+this._heightSmallRectangle}}}else{y=this.getX()+this.getWidth();s=this.getX()+this.getWidth();t=this.getY()+this.getHeight()}}else{x=(this.getY()+this.getHeight()-w)/(this.getX()+this.getWidth()-v);if(((q-w)==0)||((q-w)/(p-v))<x){y=this.getX()+this.getWidth();s=this.getX()+this.getWidth();t=this.getY()+this.getHeight()}else{m=this.getY()+this.getHeight();s=this.getX()+this.getWidth();t=this.getY()+this.getHeight()}}}return JSGraphic.lineIntersection(y,m,s,t,p,q,r.getX(),r.getY())};CompositeState.prototype.setVisibility=function(e){this._visible=e;var f=true;if(this._selectedFigure&&e){f=false}for(var d=0;d<this._components.length;d++){if((f||(!f&&this._components[d]._id=="name"))&&(!(this._components[d] instanceof SpecificationItem)||this._components[d] instanceof SpecificationItem&&this._components[d].getValue()!="")){this._components[d].setVisibility(e)}}if(this._container&&f){for(d=0;d<this._nodeChilds.length;d++){this._nodeChilds[d].setVisibility(e)}}};CompositeState.prototype.isOver=function(d,c){if(this._selectedFigure){return CompositeState.base.isOver.call(this,d,c)}if(d instanceof Point){c=d.getY();d=d.getX()}if((d>=this._x+this._Xmovement&&d<=this._x+this._Xmovement+this._widthSmallRectangle&&c>=this._y&&c<=this._y+this._heightSmallRectangle)||(d>=this._x&&d<=(this._x+this._width)&&c>=(this._y+this._heightSmallRectangle)&&c<=(this._y+this._height))){return true}return false};CompositeState.prototype.setValue=function(h,m,g,l){var f;for(f in this._components){if(!(this._components[f] instanceof SuperComponent)&&this._components[f].getId()==h){this._components[f].setValue(m,g,l);this.updateComponents();return true}}return false};CompositeState.prototype.drawFigures=function(c){var d;for(d=0;d<this._figures.length;d+=1){if(d==this._selectedFigure){this._figures[d].draw(c,this._x,this._y,this._width,this._height,this._heightSmallRectangle,this._widthSmallRectangle,this._Xmovement)}}};CompositeState.prototype.setName=function(b){this._components[1].setValue(b)};CompositeState.prototype.setSpecification=function(b){this._components[2].setVisibility(true);b=b.replace(/\n/gi,";");this._components[2].setText(b)};CompositeState.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};CompositeState.prototype.getStereotypes=function(){return this._components[0]._childs};CompositeState.prototype.getName=function(){return this._components[1].getValue()};CompositeState.prototype.getSpecification=function(){return this._components[2].getValue()};CompositeState.prototype.getStereotype=function(){return this._components[0]};var EntryPoint=function(b){b=b||{};EntryPoint.baseConstructor.call(this,b)};JSFun.extend(EntryPoint,Elliptical);EntryPoint.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};EntryPoint.prototype.setName=function(b){this._components[1].setValue(b)};EntryPoint.prototype.getStereotypes=function(){return this._components[0]._childs};EntryPoint.prototype.getName=function(){return this._components[1].getValue()};EntryPoint.prototype.getStereotype=function(){return this._components[0]};var ExitPoint=function(b){b=b||{};ExitPoint.baseConstructor.call(this,b)};JSFun.extend(ExitPoint,Elliptical);ExitPoint.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};ExitPoint.prototype.setName=function(b){this._components[1].setValue(b)};ExitPoint.prototype.getStereotypes=function(){return this._components[0]._childs};ExitPoint.prototype.getName=function(){return this._components[1].getValue()};ExitPoint.prototype.getStereotype=function(){return this._components[0]};var Junction=function(b){b=b||{};Junction.baseConstructor.call(this,b)};JSFun.extend(Junction,Elliptical);Junction.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Junction.prototype.setName=function(b){this._components[1].setValue(b)};Junction.prototype.getStereotypes=function(){return this._components[0]._childs};Junction.prototype.getName=function(){return this._components[1].getValue()};Junction.prototype.getStereotype=function(){return this._components[0]};var RegionState=function(b){b=b||{};RegionState.baseConstructor.call(this,b)};JSFun.extend(RegionState,Region);RegionState.prototype.addStereotype=function(b){if(this._components[0]){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")}};RegionState.prototype.setName=function(b){if(this._components[1]){this._components[1].setValue(b)}};RegionState.prototype.getStereotypes=function(){return this._components[0]._childs};RegionState.prototype.getName=function(){return this._components[1].getValue()};RegionState.prototype.getStereotype=function(){return this._components[0]};var RegionStateItem=function(b){b=b||{};RegionStateItem.baseConstructor.call(this,b)};JSFun.extend(RegionStateItem,RegionItem);RegionStateItem.prototype.createRegion=function(){var b=this.getParent()._components.length;if(this.getParent()._orientation){this.getParent().addRegion(new RegionState({parent:this.getParent()}))}else{this.getParent().addRegion(new RegionState({parent:this.getParent()}))}};var SimpleState=function(b){b=b||{};SimpleState.baseConstructor.call(this,b)};JSFun.extend(SimpleState,Rectangular);SimpleState.prototype.setElementXML=function(g){this.setPosition(parseInt(g.getAttribute("x")),parseInt(g.getAttribute("y")));this.resetMovement();this.setWidth(parseInt(g.getAttribute("width")));this.setHeight(parseInt(g.getAttribute("height")));this.setBackgroundColor(g.getAttribute("backgroundColor"));var e;var h=g.childNodes;for(e=0;e<h.length;e++){if(h[e].nodeName=="item"){if(h[e].getAttribute("behaviors")!=null&&(h[e].getAttribute("visible")=="true"||h[e].getAttribute("visible")=="false")){this.setValue(h[e].getAttribute("id"),h[e].getAttribute("value"),h[e].getAttribute("behaviors"),h[e].getAttribute("visible"))}else{this.setValue(h[e].getAttribute("id"),h[e].getAttribute("value"))}}else{if(h[e].nodeName=="superitem"){var f;for(f in this._components){if(this._components[f].getId()==h[e].getAttribute("id")){this._components[f].setComponentXML(h[e])}}}}}};SimpleState.prototype.setValue=function(h,m,g,l){var f;for(f in this._components){if(!(this._components[f] instanceof SuperComponent)&&this._components[f].getId()==h){this._components[f].setValue(m,g,l);this.updateComponents();return true}}return false};SimpleState.prototype.setVisibility=function(e){this._visible=e;var f=true;if(this._selectedFigure&&e){f=false}for(var d=0;d<this._components.length;d++){if((f||(!f&&this._components[d]._id=="name"))&&(!(this._components[d] instanceof SpecificationItem)||this._components[d] instanceof SpecificationItem&&this._components[d].getValue()!="")){this._components[d].setVisibility(e)}}if(this._container&&f){for(d=0;d<this._nodeChilds.length;d++){this._nodeChilds[d].setVisibility(e)}}};SimpleState.prototype.draw=function(b){if(!this._visible){return}SimpleState.base.draw.call(this,b);if(this._components[2]._visible){b.save();b.fillStyle="#000000";b.beginPath();b.moveTo(JSGraphic.toPixel(this.getX()),JSGraphic.toPixel(this.getY())+this._components[0].getHeight()+this._components[1].getHeight());b.lineTo(JSGraphic.toPixel(this.getX()+this.getWidth()),JSGraphic.toPixel(this.getY())+this._components[0].getHeight()+this._components[1].getHeight());b.closePath();b.fill();b.stroke();b.restore()}};SimpleState.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};SimpleState.prototype.setName=function(b){this._components[1].setValue(b)};SimpleState.prototype.setSpecification=function(b){this._components[2].setVisibility(true);b=b.replace(/\n/gi,";");this._components[2].setText(b)};SimpleState.prototype.getStereotypes=function(){return this._components[0]._childs};SimpleState.prototype.getName=function(){return this._components[1].getValue()};SimpleState.prototype.getSpecification=function(){return this._components[2].getValue()};SimpleState.prototype.getStereotype=function(){return this._components[0]};var StateMachineDiagram=function(b){StateMachineDiagram.baseConstructor.call(this,b)};JSFun.extend(StateMachineDiagram,Diagram);StateMachineDiagram.prototype.setXML=function(g,l){var l=l||[];var m=[];if(this._alone){var h=g.getElementsByTagName(this.getType())[0];if(!h){return false}}else{var h=g}this._name.setValue(h.getAttribute("name"));if(h.getAttribute("backgroundNodes")){this._backgroundNodes=h.getAttribute("backgroundNodes")}this._stereotypes=l;var n=h.childNodes;var o;for(o=0;o<n.length;o++){this._instantiateElements(n[o],m)}for(o=0;o<n.length;o++){this._addElementXML(n[o],m,null)}for(o=0;o<this._relations.length;o++){this._relations[o].notifyChange()}this._sortNodesByArea();return true};var Terminate=function(b){b=b||{};Terminate.baseConstructor.call(this,b)};JSFun.extend(Terminate,Elliptical);Terminate.prototype.getLinkCentered=function(n,o){if(n instanceof Point){o=n.getY();n=n.getX()}var p=this.getCentralPoint();var s=p.getX();var t=p.getY();var u,m,q,r;if(n<s){if(o<t){u=this.getX();m=this.getY();q=this.getX()+this.getWidth();r=this.getY()+this.getHeight()}else{u=this.getX()+this.getWidth();m=this.getY();q=this.getX();r=this.getY()+this.getHeight()}}else{if(o<t){u=this.getX()+this.getWidth();m=this.getY();q=this.getX();r=this.getY()+this.getHeight()}else{u=this.getX();m=this.getY();q=this.getX()+this.getWidth();r=this.getY()+this.getHeight()}}return JSGraphic.lineIntersection(u,m,q,r,n,o,p.getX(),p.getY())};Terminate.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Terminate.prototype.setName=function(b){this._components[1].setValue(b)};Terminate.prototype.getStereotypes=function(){return this._components[0]._childs};Terminate.prototype.getName=function(){return this._components[1].getValue()};Terminate.prototype.getStereotype=function(){return this._components[0]};var Transition=function(b){b=b||{};Transition.baseConstructor.call(this,b)};JSFun.extend(Transition,Relation);Transition.prototype.setComponentName=function(b){if(!this._name){this._name=new TransitionItem({id:"name"});this._addComponent(this._name)}else{this._name.setText(b)}};Transition.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Transition.prototype.setName=function(b){this._components[1].setValue(b)};Transition.prototype.getStereotypes=function(){return this._components[0]._childs};Transition.prototype.getName=function(){return this._components[1].getValue()};var UMLStateMachineDiagram=function(c){c=c||{};var d=new StateMachineDiagram(c);d.setType("UMLStateMachineDiagram");d.setName("State Machine diagram");setStereotypeObjects(c.stereotypes||[],d);d.setValidElements(["UMLNote","UMLLine","UMLInitialPseudostate","UMLFinalState","UMLTerminate","UMLEntryPoint","UMLExitPoint","UMLJunction","UMLSimpleState","UMLCompositeState","UMLVerticalRegion","UMLHorizontalRegion","UMLTransition","Region"]);return d};var UMLInitialPseudostate=function(c){var d=new Elliptical(c);d.setType("UMLInitialPseudostate");d.setWidth(16);d.setHeight(16);d.addFigure(new EllipseFigure({color:"#000000",changeFigureColor:false}));return d};var UMLFinalState=function(c){var d=new Elliptical(c);d.setType("UMLFinalState");d.setWidth(16);d.setHeight(16);d.addFigure(new HalfFilledEllipseFigure({color:"#ffffff",changeFigureColor:false}));return d};var UMLTerminate=function(c){var c=c||{};var d=new Terminate(c);d.setType("UMLTerminate");setStereotypeProperties(d);d.setWidth(20);d.setHeight(20);d.addFigure(new CrossFigure({color:"#000000",changeFigureColor:false}));d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLEntryPoint=function(c){var c=c||{};var d=new EntryPoint(c);d.setType("UMLEntryPoint");setStereotypeProperties(d);d.setWidth(14);d.setHeight(14);d.addFigure(new EllipseFigure({color:"#ffffff",changeFigureColor:false}));d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLExitPoint=function(c){var c=c||{};var d=new ExitPoint(c);d.setType("UMLExitPoint");setStereotypeProperties(d);d.setWidth(14);d.setHeight(14);d.addFigure(new CrossEllipseFigure({color:"#ffffff",changeFigureColor:false}));d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLJunction=function(c){var c=c||{};var d=new Junction(c);d.setType("UMLJunction");setStereotypeProperties(d);d.setWidth(14);d.setHeight(14);d.addFigure(new EllipseFigure({color:"#000000",changeFigureColor:false}));d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom,margin:3}));d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLSimpleState=function(c){var c=c||{};var d=new SimpleState(c);d.setType("UMLSimpleState");setStereotypeProperties(d);d.setWidth(75);d.setHeight(30);d.setMoveable();d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",centered:true,position:Component.Static,margin:5}));d.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));d.addFigure(new RoundedRectangleFigure({color:"#ffffbb"}));d.setMenu([[function(){for(var a=0;a<d._components.length;a++){if(d._components[a] instanceof SpecificationItem){d._components[a]._visible=true;d._components[a].showDialog();d.removeContextualMenu()}}},"Specifications"],[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLCompositeState=function(c){c=c||{};c.includeComponentByRegion=false;var d=new CompositeState(c);d.setType("UMLCompositeState");setStereotypeProperties(d);d.setWidth(150);d.setHeight(100);d.setMoveable();d.setContainer();d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Xmovement}));d.addComponent(new TextBox({id:"name",text:"StateName",margin:3,position:Component.Xmovement}));d.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));d.addFigure(new RegionFigure({color:"#ffffbb"}));d.setHeightSmallRectangle(d._components[0].getHeight()+d._components[1].getHeight());d.setWidthSmallRectangle(d._components[1].getWidth());if(c.setElementXml){}else{d.addRegion(new Region({parent:d}))}d.setMenu([[function(){for(var a=0;a<d._components.length;a++){if(d._components[a] instanceof SpecificationItem){d._components[a]._visible=true;d._components[a].showDialog();d.removeContextualMenu()}}},"Specifications"],[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLVerticalRegion=function(c){c=c||{};c.orientation=1;var d=new CompositeState(c);d.setType("UMLVerticalRegion");setStereotypeProperties(d);d.setWidth(320);d.setHeight(150);d.setMinHeight(50);d.setMoveable();d.setContainer();d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Xmovement}));d.addComponent(new TextBox({id:"name",text:"RegionName",margin:3,position:Component.Xmovement}));d.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));d.addComponent(new RegionStateItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));d.addFigure(new RegionFigure({color:"#ffffbb"}));d.setHeightSmallRectangle(d._components[0].getHeight()+d._components[1].getHeight());d.setWidthSmallRectangle(d._components[1].getWidth());if(c.setElementXml){}else{d.addRegion(new RegionState({parent:d}));d.addRegion(new RegionState({parent:d}))}d.setMenu([[function(){for(var a=0;a<d._components.length;a++){if(d._components[a] instanceof SpecificationItem){d._components[a]._visible=true;d._components[a].showDialog();d.removeContextualMenu()}}},"Specifications"],[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLHorizontalRegion=function(c){var c=c||{};var d=new CompositeState(c);d.setType("UMLHorizontalRegion");setStereotypeProperties(d);d.setWidth(320);d.setHeight(150);d.setMinHeight(50);d.setMoveable();d.setContainer();d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Xmovement}));d.addComponent(new TextBox({id:"name",text:"RegionName",margin:3,position:Component.Xmovement}));d.addComponent(new SpecificationItem({id:"specification",centered:false,position:Component.BottomLeft,margin:10}));d.addComponent(new RegionStateItem({id:"addRegion",text:"...",margin:1,position:Component.BottomRight}));d.addFigure(new RegionFigure({color:"#ffffbb"}));d.setHeightSmallRectangle(d._components[0].getHeight()+d._components[1].getHeight());d.setWidthSmallRectangle(d._components[1].getWidth());if(c.setElementXml){}else{d.addRegion(new RegionState({parent:d}));d.addRegion(new RegionState({parent:d}))}d.setMenu([[function(){for(var a=0;a<d._components.length;a++){if(d._components[a] instanceof SpecificationItem){d._components[a]._visible=true;d._components[a].showDialog();d.removeContextualMenu()}}},"Specifications"],[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLTransition=function(c){var d=new Transition(c);d.setType("UMLTransition");d.addComponentStereotype();d.setComponentName();d.setLine(new SolidLine());d.setEnd(new OpenTip());return d};var Actor=function(b){b=b||{};Actor.baseConstructor.call(this,b)};JSFun.extend(Actor,Rectangular);Actor.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Actor.prototype.setName=function(b){this._components[1].setValue(b)};Actor.prototype.getStereotypes=function(){return this._components[0]._childs};Actor.prototype.getName=function(){return this._components[1].getValue()};Actor.prototype.getStereotype=function(){return this._components[0]};var Communication=function(b){b=b||{};Communication.baseConstructor.call(this,b)};JSFun.extend(Communication,Relation);Communication.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Communication.prototype.setMultiplicityA=function(b){this._components[1].setValue(b)};Communication.prototype.setMultiplicityB=function(b){this._components[2].setValue(b)};Communication.prototype.getStereotypes=function(){return this._components[0]._childs};Communication.prototype.getMultiplicityA=function(){return this._components[1].getValue()};Communication.prototype.getMultiplicityB=function(){return this._components[2].getValue()};var Generalization=function(b){b=b||{};Generalization.baseConstructor.call(this,b)};JSFun.extend(Generalization,Relation);Generalization.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};Generalization.prototype.setName=function(b){this._components[1].setValue(b)};Generalization.prototype.getStereotypes=function(){return this._components[0]._childs};Generalization.prototype.getName=function(){return this._components[1].getValue()};var SubSystem=function(b){b=b||{};SubSystem.baseConstructor.call(this,b)};JSFun.extend(SubSystem,Rectangular);SubSystem.prototype.addStereotype=function(b){var b=b||"";this._components[1].addField("\xAB"+b+"\xBB")};SubSystem.prototype.setName=function(b){this._components[3].setValue(b)};SubSystem.prototype.getStereotypes=function(){return this._components[1]._childs};SubSystem.prototype.getName=function(){return this._components[3].getValue()};SubSystem.prototype.getStereotype=function(){return this._components[1]};var System=function(b){b=b||{};System.baseConstructor.call(this,b)};JSFun.extend(System,Rectangular);System.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};System.prototype.setName=function(b){this._components[1].setValue(b)};System.prototype.getStereotypes=function(){return this._components[0]._childs};System.prototype.getName=function(){return this._components[1].getValue()};System.prototype.getStereotype=function(){return this._components[0]};var UseCase=function(b){b=b||{};UseCase.baseConstructor.call(this,b)};JSFun.extend(UseCase,Elliptical);UseCase.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};UseCase.prototype.setName=function(b){this._components[1].setValue(b)};UseCase.prototype.getStereotypes=function(){return this._components[0]._childs};UseCase.prototype.getName=function(){return this._components[1].getValue()};UseCase.prototype.getStereotype=function(){return this._components[0]};var UseCaseDiagram=function(b){UseCaseDiagram.baseConstructor.call(this,b)};JSFun.extend(UseCaseDiagram,Diagram);UseCaseDiagram.prototype.setXML=function(g,l){var l=l||[];var m=[];if(this._alone){var h=g.getElementsByTagName(this.getType())[0];if(!h){return false}}else{var h=g}this._name.setValue(h.getAttribute("name"));if(h.getAttribute("backgroundNodes")){this._backgroundNodes=h.getAttribute("backgroundNodes")}this._stereotypes=l;var n=h.childNodes;var o;for(o=0;o<n.length;o++){this._instantiateElements(n[o],m)}for(o=0;o<n.length;o++){this._addElementXML(n[o],m,null)}for(o=0;o<this._relations.length;o++){this._relations[o].notifyChange()}this._sortNodesByArea();return true};var UseCaseExtended=function(b){b=b||{};UseCaseExtended.baseConstructor.call(this,b)};JSFun.extend(UseCaseExtended,Elliptical);UseCaseExtended.prototype.addStereotype=function(b){var b=b||"";this._components[0].addField("\xAB"+b+"\xBB")};UseCaseExtended.prototype.setName=function(b){this._components[1].setValue(b)};UseCaseExtended.prototype.addExtensionPoint=function(b){this._components[4].addField(b)};UseCaseExtended.prototype.getStereotypes=function(){return this._components[0]._childs};UseCaseExtended.prototype.getName=function(){return this._components[1].getValue()};UseCaseExtended.prototype.getExtensionPoints=function(){return this._components[4]._childs};UseCaseExtended.prototype.getStereotype=function(){return this._components[0]};var UMLUseCaseDiagram=function(c){c=c||{};var d=new UseCaseDiagram(c);d.setType("UMLUseCaseDiagram");d.setName("Use case diagram");setStereotypeObjects(c.stereotypes||[],d);d.setValidElements(["UMLNote","UMLLine","UMLActor","UMLUseCase","UMLUseCaseExtended","UMLSystem","UMLSubSystem","UMLCommunication","UMLExtend","UMLInclude","UMLGeneralization"]);return d};var UMLActor=function(c){var c=c||{};var d=new Actor(c);d.setType("UMLActor");setStereotypeProperties(d);d.setMinWidth(50);d.setMinHeight(70);d.setProportional();d.setMoveable();d.addFigure(new StickmanFigure());d.addComponent(new StereotypeTagList({id:"stereotypes",position:Component.Bottom}));d.addComponent(new TextArea({id:"name",position:Component.Bottom}));d.setMenu([[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLUseCase=function(c){var c=c||{};var d=new UseCase(c);d.setType("UMLUseCase");setStereotypeProperties(d);d.setWidth(100);d.setHeight(40);d.setMoveable();d.addFigure(new EllipseFigure());d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",centered:true,margin:3}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLUseCaseExtended=function(c){var c=c||{};var d=new UseCaseExtended(c);d.setType("UMLUseCaseExtended");setStereotypeProperties(d);d.setWidth(100);d.setHeight(40);d.setMoveable();d.addFigure(new EllipseFigure());d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new TextArea({id:"name",centered:true}));d.addComponent(new Separator());d.addComponent(new Text({text:"extension points",centered:true}));d.addComponent(new TextFields({id:"extension",centered:true}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLSystem=function(c){var c=c||{};var d=new System(c);d.setType("UMLSystem");setStereotypeProperties(d);d.setWidth(150);d.setHeight(100);d.setMoveable();d.setContainer();d.addFigure(new RectangleFigure({color:"#c6dbdc"}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new Tab({id:"name",margin:5,text:"System name"}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLSubSystem=function(c){var c=c||{};var d=new SubSystem(c);d.setType("UMLSubSystem");setStereotypeProperties(d);d.setMinWidth(150);d.setHeight(100);d.setMoveable();d.setContainer();d.addFigure(new RectangleFigure({color:"#c6dbdc"}));d.addComponent(new Text({centered:true,text:"\xABsubsystem\xBB",margin:1}));d.addComponent(new StereotypeTagList({id:"stereotypes",centered:true}));d.addComponent(new ComponentSymbol({position:Component.TopRight,margin:5}));d.addComponent(new TextBox({id:"name",centered:true,margin:2}));d.setMenu([[function(){d.showColorDialog({that:d});d.removeContextualMenu()},"Style"],[function(){d._stereotypeProperties.showTagValuesDialog();d.removeContextualMenu()},"Tag value"],[function(){d._stereotypeProperties.showApplyStereotypesDialog();d.removeContextualMenu()},"Apply Stereotype"],[function(){d._stereotypeProperties.showStereotypesDialog();d.removeContextualMenu()},"Show Stereotype"]]);return d};var UMLCommunication=function(c){var d=new Communication(c);d.setType("UMLCommunication");d.addComponentStereotype();d.setComponentMultiplicityA();d.setComponentMultiplicityB();d.setLine(new SolidLine());return d};var UMLExtend=function(c){var d=new Relation(c);d.setType("UMLExtend");d.setStereotype("\xABextend\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLInclude=function(c){var d=new Relation(c);d.setType("UMLInclude");d.setStereotype("\xABinclude\xBB");d.setLine(new DashedLine());d.setEnd(new OpenTip());return d};var UMLGeneralization=function(c){var d=new Generalization(c);d.setType("UMLGeneralization");d.addComponentStereotype();d.setComponentName();d.setLine(new SolidLine());d.setEnd(new CloseTip());return d};