var ApplicationValues={element_color:"#ffffbb",dialog:new Dialog()};var Application=function(b){b=b||{};if(!(b.id&&b.width&&b.height)){return}this._width=b.width;this._height=b.height;this._generateStructure(b.id);this.setProfileGenericMenu();this._generateGeneralMenu();this._selected=null;this._diagrams=[];this._tabs=[]};var _acceptedDiagrams=[];var _acceptedElementsUML=[];var _genericMenu=[];var _specificMenu=[];var _stereotypes=[];var _metaclass=[];var _delProfileElement=function(c){if(c.getType()=="UMLMetaclass"){for(var d in _metaclass){if(_metaclass[d]==c){_metaclass.splice(d,1)}}}if(c.getType()=="UMLStereotype"){for(var d in _stereotypes){if(_stereotypes[d]==c){_stereotypes.splice(d,1)}}}};Application.prototype._generateStructure=function(z){var u=document.getElementById(z);var x=document.createElement("div");x.setAttribute("id","ud_tools_div");var v=document.createElement("ul");v.setAttribute("id","ud_tools_ul1");var w=document.createElement("ul");w.setAttribute("id","ud_tools_ul2");x.appendChild(v);x.appendChild(w);u.appendChild(x);this._tools_div=x;this._tools_ul1=v;this._tools_ul2=w;var q=document.createElement("div");q.setAttribute("id","ud_container_div");var o=document.createElement("div");o.setAttribute("id","ud_selector_div");var A=document.createElement("ul");A.setAttribute("id","ud_selector_ul");o.appendChild(A);q.appendChild(o);this._selector_ul=A;var s=document.createElement("div");s.setAttribute("id","ud_diagram_div");s.setAttribute("class","ud_diagram_div");s.style.width=this._width+"px";s.style.height=this._height+"px";this._diagram_div=s;q.appendChild(s);u.appendChild(q);var y;y=document.createElement("canvas");y.setAttribute("class","ud_diagram_canvas");y.width=this._width;y.height=this._height;s.appendChild(y);this._mainContext=y.getContext("2d");this._mainCanvas=y;y=document.createElement("canvas");y.setAttribute("class","ud_diagram_canvas");y.width=this._width;y.height=this._height;y.onmousedown=function(){return false};s.appendChild(y);this._motionContext=y.getContext("2d");var t=document.createElement("div");t.setAttribute("id","ud_update_div");t.title="apply changes in profile to diagrams";t.style.right=15+"px";t.style.display="none";s.appendChild(t);var r=this;t.onclick=function(){ApplicationValues.dialog._text="Do you want to update the diagrams according to the changes of the profile?";ApplicationValues.dialog._cancelable=true;if(r._selected&&r._diagrams[r._selected].getType()=="UMLProfile"){ApplicationValues.dialog.show(function(){var a=[];for(i in r._diagrams){if(r._diagrams[i].getType()!="UMLProfile"){a.push(r._diagrams[i])}}r._diagrams[r._selected].updateProfile(a)})}};var p=document.createElement("div");p.setAttribute("id","ud_delete_div");s.appendChild(p);var r=this;p.onclick=function(){ApplicationValues.dialog._text='Do you want to delete the diagram "'+r._diagrams[r._selected].getName()+'"?';ApplicationValues.dialog._cancelable=true;if(r._selected){ApplicationValues.dialog.show(function(){r._delDiagram();r._generateSpecificMenu()})}}};Application.prototype._changeTabName=function(k){var h=this._diagrams[k].getName();if(h.length>20){h=h.substring(0,17);h+="..."}var f=this._tabs[k];var j=f.firstChild;var g=j.firstChild;j.removeChild(g);j.appendChild(document.createTextNode(h))};Application.prototype._addTab=function(e){var f=document.createElement("li");var g=document.createElement("a");g.appendChild(document.createTextNode(""));f.appendChild(g);this._selector_ul.appendChild(f);this._tabs[e]=f;var h=this;f.onclick=function(){if(h._selected==e){ApplicationValues.dialog._text="Diagram name:";ApplicationValues.dialog._cancelable=true;var a=h._diagrams[e];ApplicationValues.dialog.show(function(b){if(b==""){b="Untitle"}a.setName(b);h._changeTabName(e);a.draw()},a.getName())}else{h._selectDiagram(e)}};this._changeTabName(e)};Application.prototype._delTab=function(b){this._selector_ul.removeChild(this._tabs[b]);delete this._tabs[b]};Application.prototype._generateIndex=function(){var b=Math.random();while(true){if(b in this._diagrams){b=Math.random()}else{return b}}};Application.prototype.addDiagram=function(d){var c=this._generateIndex();d.initialize(c,this._diagram_div,this._mainContext,this._motionContext,this._width,this._height);this._diagrams[c]=d;this._diagrams[c].setUpdateHeightCanvas(true);if(d.isVisible()){this._addTab(c)}this._selectDiagram(c)};Application.prototype._delDiagram=function(){var e=this._selected;if(e){this._diagrams[e].interaction(false);this._delTab(e);if(this._diagrams[e].getType()=="UMLProfile"){var f=[];for(d in this._diagrams){if(this._diagrams[d].getType()!="UMLProfile"){f.push(this._diagrams[d])}}this._diagrams[e].removeProfile(f);for(d=0;d<this._diagrams[e]._nodes.length;d++){_delProfileElement(this._diagrams[e]._nodes[d])}}delete this._diagrams[e];this._selected=null;var d;for(d in this._diagrams){if(this._diagrams[d]._visible){this._selectDiagram(d);return}}this._clearCanvas()}};Application.prototype._clearCanvas=function(){this._mainContext.clearRect(0,0,this._width,this._height);this._motionContext.clearRect(0,0,this._width,this._height)};Application.prototype._selectDiagram=function(c){if(this._selected&&this._diagrams[c].isVisible()){this._diagrams[this._selected].interaction(false);this._tabs[this._selected].removeAttribute("class");this._diagrams[this._selected].deselect()}this._clearCanvas();this._diagrams[c].draw();this._diagrams[c].interaction(true);if(this._diagrams[c].isVisible()){this._selected=c;this._diagrams[c].select();this._tabs[c].setAttribute("class","active");this._generateSpecificMenu();var d=document.getElementById("ud_update_div");if(this._diagrams[c].getType()=="UMLProfile"){d.style.display="block"}else{d.style.display="none"}}};Application.prototype._getDiagramImage=function(){if(this._selected){this._diagrams[this._selected].stopEvents();this._diagrams[this._selected].draw();return this._mainCanvas.toDataURL("image/png")}};Application.prototype._generateGeneralMenu=function(){var m=this;var k=this._tools_div;var o=document.createElement("h1");var l=document.createTextNode("Actions");var h=document.createElement("img");h.setAttribute("src","img/app/vertical_flow.png");o.appendChild(h);o.appendChild(l);k.insertBefore(o,this._tools_ul1);o.onclick=function(){var a=document.getElementById("ud_tools_ul1");var b;if(a.style.display=="none"){a.style.display="block";this.childNodes[0].setAttribute("src","img/app/vertical_flow.png")}else{a.style.display="none";this.childNodes[0].setAttribute("src","img/app/horizontal_flow.png")}};this._addMenuItem(this._tools_ul1,"Export/Import to xml",function(f){var c=this;this._active=true;var x=document.createElement("div");var w=document.createElement("form");var v=document.createElement("textarea");var y=document.createElement("input");var b=document.createElement("input");var z=document.createElement("input");var A=document.createElement("input");x.className="ud_popup";v.setAttribute("rows",15);v.setAttribute("cols",90);y.setAttribute("type","submit");y.setAttribute("value","Import");b.setAttribute("type","submit");b.setAttribute("value","Export All");z.setAttribute("type","submit");z.setAttribute("value","Export Current Diagram");A.setAttribute("type","submit");A.setAttribute("value","x");var e=function(p){f.setXMLString(v.value);document.body.removeChild(x)};var a=function(p){v.value=f.getXMLString();v.select()};var g=function(p){v.value=f.getCurrentXMLString();v.select()};var d=function(p){document.body.removeChild(x)};w.onsubmit=function(){return false};b.addEventListener("click",a,false);z.addEventListener("click",g,false);y.addEventListener("click",e,false);A.addEventListener("click",d,false);w.appendChild(b);w.appendChild(z);w.appendChild(y);w.appendChild(A);w.appendChild(document.createElement("br"));w.appendChild(v);x.appendChild(w);document.body.appendChild(x);v.focus();x.style.top=(window.innerHeight-w.offsetHeight)/2+"px";x.style.left=(window.innerWidth-w.offsetWidth)/2+"px"},0,"import_export");this._addMenuItem(this._tools_ul1,"Generate image (png)",function(a,b){if(a._selected){var c=window.open(a._getDiagramImage(),"diagramImage","height="+(a._height+70)+",width="+(a._width+20));c.focus()}else{alert("You did not select any diagram")}},0,"generate_image");this._addMenuItem(this._tools_ul1,"Delete object",function(b,d,e){var g=b.getElementByPoint(d,e);if(g){var f=false;var a="";for(var c=0;c<g._components.length&&!f;c++){if(g._components[c].getId()=="name"){a=g._components[c]._text;f=true}}if(a!=""){a=' "'+a+'" '}ApplicationValues.dialog._text="Do you want to delete the object"+a+" ("+g.getType()+") ?";ApplicationValues.dialog._cancelable=true}if(g!=null&&g instanceof Element){ApplicationValues.dialog.show(function(){b.delElement(g);b.draw();_delProfileElement(g)})}},1,"delete_object");this._addMenuItem(this._tools_ul1,"Modify color",function(f){var V=ApplicationValues.element_color;var b=ApplicationValues.element_color.split("#")[1];var U=new Array(parseInt(b.slice(0,2),16),parseInt(b.slice(2,4),16),parseInt(b.slice(4,6),16));var Z=document.createElement("div");Z.className="ud_popupColor";var c=document.createElement("div");c.setAttribute("id","divBlock1");var e=document.createElement("div");e.setAttribute("id","divBlock2");var ab=document.createElement("div");ab.setAttribute("id","colorHtml");ab.style.color="#ffffff";var ag=document.createElement("div");ag.setAttribute("id","red");var d=document.createElement("canvas");d.setAttribute("id","R");d.width=150;d.height=20;ag.appendChild(d);var af=d.getContext("2d");var S=document.createElement("div");S.setAttribute("id","green");var X=document.createElement("canvas");X.setAttribute("id","G");X.width=150;X.height=20;S.appendChild(X);var R=X.getContext("2d");var N=document.createElement("div");N.setAttribute("id","blue");var T=document.createElement("canvas");T.setAttribute("id","B");T.width=150;T.height=20;N.appendChild(T);var L=T.getContext("2d");var P=document.createElement("div");P.setAttribute("id","divSelectColor");var M=document.createElement("canvas");M.setAttribute("id","selectColor");M.width=90;M.height=90;P.appendChild(M);var ad=M.getContext("2d");var ac=document.createElement("form");var a=document.createElement("input");a.setAttribute("type","submit");a.setAttribute("value","ok");var g=document.createElement("input");g.setAttribute("type","submit");g.setAttribute("value","cancel");var O=function(p){document.body.removeChild(Z)};var W=function(p){ApplicationValues.element_color=V;document.body.removeChild(Z)};a.addEventListener("click",O,false);g.addEventListener("click",W,false);ac.onsubmit=function(){return false};a.focus();ac.appendChild(a);ac.appendChild(g);c.appendChild(ab);c.appendChild(ag);c.appendChild(S);c.appendChild(N);c.appendChild(ac);Z.appendChild(c);e.appendChild(P);e.appendChild(document.createElement("div"));Z.appendChild(e);var Q=function(r,s,q,p){if(q==0){q=0.1}else{if(q==120){q=119.9}}s.save();s.font="12px monospace";s.textBaseline="middle";s.fillStyle="#ffffff";s.fillText(r.getAttribute("id"),0,r.height/2);s.restore();s.save();s.beginPath();s.fillStyle=p;s.fillRect(20,0,parseInt(r.width)-50,d.height);s.closePath();s.restore();s.fillStyle="#000000";s.beginPath();s.arc(20+(q*100)/255,parseInt(r.height)/2,4,0,Math.PI*2,true);s.closePath();s.fill();s.save();s.font="12px monospace";s.textBaseline="middle";s.fillStyle="#ffffff";s.fillText(parseInt(q),125,r.height/2);s.restore()};var Y=function(p){ad.save();ad.beginPath();ad.fillStyle=p;ad.fillRect(20,20,80,80);ad.closePath();ad.restore()};var aa=function(q){var r=function(s){var u="0123456789ABCDEF";var v=parseInt(s)%16;var t=(parseInt(s)-v)/16;hex=""+u.charAt(t)+u.charAt(v);return hex};var p=r(q[0])+r(q[1])+r(q[2]);while(ab.hasChildNodes()){ab.removeChild(ab.lastChild)}ab.appendChild(document.createTextNode("#"));ab.appendChild(document.createTextNode(p));ApplicationValues.element_color="#"+p};var ae=function(q){var r=q.pageX-Z.offsetLeft-this.offsetLeft;var p=q.pageY-this.offsetTop;if(this.getAttribute("id")=="red"){U[0]=((r-20)*255)/100;if(U[0]>255){U[0]=255}if(U[0]<0){U[0]=0}af.clearRect(0,0,parseInt(d.width),d.height);Q(d,af,U[0],"#ff0000")}if(this.getAttribute("id")=="green"){U[1]=((r-20)*255)/100;if(U[1]>255){U[1]=255}if(U[1]<0){U[1]=0}R.clearRect(0,0,parseInt(X.width),X.height);Q(X,R,U[1],"#00ff00")}if(this.getAttribute("id")=="blue"){U[2]=((r-20)*255)/100;if(U[2]>255){U[2]=255}if(U[2]<0){U[2]=0}L.clearRect(0,0,parseInt(T.width),T.height);Q(T,L,U[2],"#0000ff")}aa(U);Y(ApplicationValues.element_color);f.updateBackgroundElementDiagram()};Q(d,af,U[0],"#ff0000");Q(X,R,U[1],"#00ff00");Q(T,L,U[2],"#0000ff");Y(ApplicationValues.element_color);aa(U);ag.addEventListener("mousedown",ae,false);S.addEventListener("mousedown",ae,false);N.addEventListener("mousedown",ae,false);document.body.appendChild(Z);Z.style.top=(window.innerHeight-parseInt(Z.offsetHeight))/2+"px";Z.style.left=(window.innerWidth-parseInt(Z.offsetWidth))/2+"px"},0,"modify_color");var j=_genericMenu;var n;for(n in j){if(j[n].length==3){this._addMenuItem(this._tools_ul1,j[n][0],j[n][1],j[n][2])}else{if(j[n].length==4){this._addMenuItem(this._tools_ul1,j[n][0],j[n][1],j[n][2],j[n][3])}}}k=this._tools_div;o=document.createElement("h1");l=document.createTextNode("Diagram elements");o.onclick=function(){var a=document.getElementById("ud_tools_ul2");var b;if(a.style.display=="none"){a.style.display="block";this.childNodes[0].setAttribute("src","img/app/vertical_flow.png")}else{a.style.display="none";this.childNodes[0].setAttribute("src","img/app/horizontal_flow.png")}};h=document.createElement("img");h.setAttribute("src","img/app/vertical_flow.png");o.appendChild(h);o.appendChild(l);k.insertBefore(o,this._tools_ul2)};Application.prototype._generateSpecificMenu=function(){var h;var g=this._tools_ul2;while(g.hasChildNodes()){g.removeChild(g.firstChild)}if(this._selected){var h,e;var f=_specificMenu[this._diagrams[this._selected].getType()];for(h in f){if(f[h].length==4){this._addMenuItem(this._tools_ul2,f[h][0],f[h][1],f[h][2],f[h][3])}else{if(f[h].length==3){this._addMenuItem(this._tools_ul2,f[h][0],f[h][1],f[h][2])}}}this._addMenuItem(this._tools_ul2,"Note",function(b,c,a){b.addElement(new UMLNote({x:c,y:a}))},1,"UMLNote");this._addMenuItem(this._tools_ul2,"Anchor",function(c,d,a,n,b){var o=c.getElementByPoint(d,a);var p=c.getElementByPoint(n,b);if(o!=null){if(!p){p=new UMLNote({x:n,y:b});c.addElement(p)}var q=new UMLLine({a:o,b:p});c.addElement(q)}},2,"UMLAnchor")}};Application.prototype.updateBackgroundElementDiagram=function(){for(i in this._diagrams){this._diagrams[i].setBackgroundNodes(ApplicationValues.element_color)}};Application.prototype._interactionSingleClick=function(g){var e=this._diagrams[this._selected];e.interaction(false);var h=this;var f=function(a){var b=a.pageX-h._diagram_div.offsetLeft;var c=a.pageY-h._diagram_div.offsetTop;g(e,b,c);h._diagram_div.onclick=false;e.draw();e.interaction(true)};this._diagram_div.onclick=f};Application.prototype._interactionDoubleClick=function(k){var o=this._diagrams[this._selected];o.interaction(false);var h=0,n=0;var l=true;var m=this;var j=function(a){var b=a.pageX-m._diagram_div.offsetLeft;var c=a.pageY-m._diagram_div.offsetTop;if(l){l=false;h=b;n=c}else{k(o,h,n,b,c);m._diagram_div.onclick=false;o.draw();o.interaction(true)}};this._diagram_div.onclick=j};Application.prototype._addMenuItem=function(u,o,p,l,t){var n=document.createElement("li");var q=document.createElement("a");var m=document.createTextNode(o);if(t){var s=document.createElement("img");s.setAttribute("src","img/app/"+t+".png");n.appendChild(s)}q.appendChild(m);n.appendChild(q);u.appendChild(n);var r=this;switch(l){case 0:n.addEventListener("click",function(){if(r._selected){p(r,r._diagrams[r._selected])}else{p(r)}},false);break;case 1:n.addEventListener("click",function(){if(r._selected){r._interactionSingleClick(p)}},false);break;case 2:n.addEventListener("click",function(){if(r._selected){r._interactionDoubleClick(p)}},false);break;default:break}};Application.prototype.getXML=function(){var e=(new DOMParser()).parseFromString("<umldiagrams/>","text/xml");var g=e.getElementsByTagName("umldiagrams")[0];var f;var h;for(h in this._diagrams){f=this._diagrams[h].getXML(e);g.appendChild(f)}return e};Application.prototype.getCurrentXML=function(){var d=(new DOMParser()).parseFromString("<umldiagrams/>","text/xml");var f=d.getElementsByTagName("umldiagrams")[0];var e;e=this._diagrams[this._selected].getXML(d);f.appendChild(e);return d};Application.prototype.getXMLString=function(){return(new XMLSerializer()).serializeToString(this.getXML())};Application.prototype.getCurrentXMLString=function(){return(new XMLSerializer()).serializeToString(this.getCurrentXML())};Application.prototype.setXML=function(xml){var application=xml.getElementsByTagName("umldiagrams")[0];if(!application){alert("Not found a valid XML string");return}var xmlnodes=application.childNodes;var aux,nodeName;var i,j;for(i=0;i<xmlnodes.length;i++){nodeName=xmlnodes[i].nodeName;for(j in _acceptedDiagrams){if(nodeName==_acceptedDiagrams[j]){aux=eval("new "+nodeName+"()");if(nodeName!="UMLProfile"){aux.setXML(xmlnodes[i],_stereotypes)}else{aux.setXML(xmlnodes[i],this._diagrams,_acceptedElementsUML);this.storeInformationProfile(aux)}this.addDiagram(aux);break}}}};Application.prototype.storeInformationProfile=function(d){var f=d.getElements();for(var e=0;e<f[0].length;e++){_metaclass.push(f[0][e])}for(e=0;e<f[1].length;e++){_stereotypes.push(f[1][e])}};Application.prototype.foundInArray=function(f,d){for(var e=0;e<f.length;e++){if(d==f[e]){return true}}return false};Application.prototype.setXMLString=function(b){b=b.replace(/\n/gi,"");this.setXML((new DOMParser()).parseFromString(b,"text/xml"))};_acceptedDiagrams.push("UMLClassDiagram");_acceptedElementsUML.push(["Class","UMLClass"],["Component (Class diagram)","UMLComponent"],["Interface Extended","UMLInterfaceExtended"],["UMLPackage","Package"],["Package Container","UMLPackageContainer"]);_genericMenu.push(["New class diagram",function(b){b.addDiagram(new UMLClassDiagram({backgroundNodes:ApplicationValues.element_color,stereotypes:_stereotypes}))},0,"UMLClassDiagram"]);_specificMenu.UMLClassDiagram=[["Class",function(e,f,g){var h=new UMLClass({x:f,y:g});e.addElement(h)},1,"UMLClass"],["Component",function(e,f,g){var h=new UMLComponent({x:f,y:g});e.addElement(h)},1,"UMLComponent"],["Interface",function(e,f,g){var h=new UMLInterfaceExtended({x:f,y:g});e.addElement(h)},1,"UMLInterfaceExtended"],["Package",function(e,f,g){var h=new UMLPackage({x:f,y:g});e.addElement(h)},1,"UMLPackage"],["Package container",function(e,f,g){var h=new UMLPackageContainer({x:f,y:g});e.addElement(h)},1,"UMLPackageContainer"],["Generalization",function(k,f,h,g,j){k.addRelationFromPoints(new UMLGeneralization(),f,h,g,j)},2,"UMLGeneralization"],["Association",function(k,f,h,g,j){k.addRelationFromPoints(new UMLAssociation(),f,h,g,j)},2,"UMLAssociation"],["Aggregation",function(k,f,h,g,j){k.addRelationFromPoints(new UMLAggregation(),f,h,g,j)},2,"UMLAggregation"],["Composition",function(k,f,h,g,j){k.addRelationFromPoints(new UMLComposition(),f,h,g,j)},2,"UMLComposition"],["Dependency",function(k,f,h,g,j){k.addRelationFromPoints(new UMLDependency(),f,h,g,j)},2,"UMLDependency"],["Realization",function(k,f,h,g,j){k.addRelationFromPoints(new UMLRealization(),f,h,g,j)},2,"UMLRealization"],["Usage",function(k,f,h,g,j){k.addRelationFromPoints(new UMLUsage(),f,h,g,j)},2,"UMLUsage"],["Package merge",function(k,f,h,g,j){k.addRelationFromPoints(new UMLPackageMerge(),f,h,g,j)},2,"UMLPackageMerge"],["Package public import",function(k,f,h,g,j){k.addRelationFromPoints(new UMLPackagePublicImport(),f,h,g,j)},2,"UMLPackagePublicImport"],["Package private import",function(k,f,h,g,j){k.addRelationFromPoints(new UMLPackagePrivateImport(),f,h,g,j)},2,"UMLPackagePrivateImport"]];_acceptedDiagrams.push("UMLUseCaseDiagram");_acceptedElementsUML.push(["Actor","UMLActor"],["Use Case","UMLUseCase"],["UseCaseExtended","UMLUseCaseExtended"],["System","UMLSystem"],["SubSystem","UMLSubSystem"]);_genericMenu.push(["New use case diagram",function(b){b.addDiagram(new UMLUseCaseDiagram({backgroundNodes:ApplicationValues.element_color,stereotypes:_stereotypes}))},0,"UMLUseCaseDiagram"]);_specificMenu.UMLUseCaseDiagram=[["Actor",function(e,f,g){var h=new UMLActor({x:f,y:g});e.addElement(h)},1,"UMLActor"],["Use case",function(e,f,g){var h=new UMLUseCase({x:f,y:g});e.addElement(h)},1,"UMLUseCase"],["UseCaseExtended",function(e,f,g){var h=new UMLUseCaseExtended({x:f,y:g});e.addElement(h)},1,"UMLUseCaseExtended"],["System",function(e,f,g){var h=new UMLSystem({x:f,y:g});e.addElement(h)},1,"UMLSystem"],["SubSystem",function(e,f,g){var h=new UMLSubSystem({x:f,y:g});e.addElement(h)},1,"UMLSubSystem"],["Communication",function(k,f,h,g,j){k.addRelationFromPoints(new UMLCommunication(),f,h,g,j)},2,"UMLCommunication"],["Extend",function(k,f,h,g,j){k.addRelationFromPoints(new UMLExtend(),f,h,g,j)},2,"UMLExtend"],["Include",function(k,f,h,g,j){k.addRelationFromPoints(new UMLInclude(),f,h,g,j)},2,"UMLInclude"],["Generalization",function(k,f,h,g,j){k.addRelationFromPoints(new UMLGeneralization(),f,h,g,j)},2,"UMLGeneralization"]];_acceptedDiagrams.push("UMLComponentDiagram");_acceptedElementsUML.push(["Component (Component diagram)","UMLComComponent"],["Interface","UMLInterface"]);_genericMenu.push(["New component diagram",function(b){b.addDiagram(new UMLComponentDiagram({backgroundNodes:ApplicationValues.element_color,stereotypes:_stereotypes}))},0,"UMLComponentDiagram"]);_specificMenu.UMLComponentDiagram=[["Package",function(e,f,g){var h=new UMLPackage({x:f,y:g});e.addElement(h)},1,"UMLPackage"],["Package container",function(e,f,g){var h=new UMLPackageContainer({x:f,y:g});e.addElement(h)},1,"UMLPackageContainer"],["Component",function(e,f,g){var h=new UMLComComponent({x:f,y:g});e.addElement(h)},1,"UMLComponent"],["Add Port",function(f,g,h){var j=f.getElementByPoint(g,h);if(j!=null&&j.getType()=="UMLComComponent"){var k=new UMLPort();j.addPort(k)}},1,"UMLPort"],["Interface",function(e,f,g){var h=new UMLInterface({x:f,y:g});e.addElement(h)},1,"UMLInterface"],["Interface Extended",function(e,f,g){var h=new UMLInterfaceExtended({x:f,y:g});e.addElement(h)},1,"UMLInterfaceExtended"],["Interface usage",function(k,f,h,g,j){k.addRelationFromPoints(new UMLInterfaceUsage(),f,h,g,j)},2,"UMLInterfaceUsage"],["Interface realization",function(k,f,h,g,j){k.addRelationFromPoints(new UMLInterfaceRealization(),f,h,g,j)},2,"UMLInterfaceRealization"],["Generalization",function(k,f,h,g,j){k.addRelationFromPoints(new UMLGeneralization(),f,h,g,j)},2,"UMLGeneralization"],["Component Realization",function(k,f,h,g,j){k.addRelationFromPoints(new UMLRealization(),f,h,g,j)},2,"UMLRealization"],["Connector",function(k,f,h,g,j){k.addRelationFromPoints(new UMLConnector(),f,h,g,j)},2,"UMLConnector"],];_acceptedDiagrams.push("UMLSequenceDiagram");_acceptedElementsUML.push(["Lifeline","UMLLifeline"],["Option","UMLOption"],["Alternative","UMLAlternative"],["Loop","UMLLoop"],["Break","UMLBreak"]);_genericMenu.push(["New sequence diagram",function(b){b.addDiagram(new UMLSequenceDiagram({backgroundNodes:ApplicationValues.element_color,stereotypes:_stereotypes}))},0,"UMLSequenceDiagram"]);_specificMenu.UMLSequenceDiagram=[["Lifeline",function(e,f,g){var h=new UMLLifeline({x:f,y:70});e.addElement(h)},1,"UMLLifeline"],["Create",function(m,n,k,o,l){var h=m.getElementByPoint(n,k);var j=m.getElementByPoint(o,l);if(h&&j&&h!=j&&(h.getType()=="UMLLifeline"||h.getType()=="TimeInterval")&&j.getType()=="UMLLifeline"&&!j.getCreate()){m.addElement(new UMLCreate({a:h,b:j,y:k}))}},2,"UMLCreate"],["Destroy",function(m,n,k,o,l){var h=m.getElementByPoint(n,k);var j=m.getElementByPoint(o,l);if(h&&j&&h!=j&&(h.getType()=="UMLLifeline"||h.getType()=="TimeInterval")&&j.getType()=="UMLLifeline"&&!j.getDelete()){m.addElement(new UMLDestroy({a:h,b:j,y:k}))}},2,"UMLDestroy"],["Option",function(e,f,g){var h=new UMLOption({x:f,y:g});e.addElement(h)},1,"UMLInteraction"],["Alternative",function(e,f,g){var h=new UMLAlternative({x:f,y:g});e.addElement(h)},1,"UMLInteraction"],["Loop",function(e,f,g){var h=new UMLLoop({x:f,y:g});e.addElement(h)},1,"UMLInteraction"],["Break",function(e,f,g){var h=new UMLBreak({x:f,y:g});e.addElement(h)},1,"UMLInteraction"],["Send Message",function(m,n,k,o,l){var h=m.getElementByPoint(n,k);var j=m.getElementByPoint(o,l);if(h&&j&&(h.getType()=="UMLLifeline"||h.getType()=="TimeInterval")&&(j.getType()=="UMLLifeline"||j.getType()=="TimeInterval")){m.addElement(new UMLSendMessage({a:h,b:j,y:k}))}},2,"UMLSendMessage"],["Call Message",function(m,n,k,o,l){var h=m.getElementByPoint(n,k);var j=m.getElementByPoint(o,l);if(h&&j&&(h.getType()=="UMLLifeline"||h.getType()=="TimeInterval")&&(j.getType()=="UMLLifeline"||j.getType()=="TimeInterval")){m.addElement(new UMLCallMessage({a:h,b:j,y:k}))}},2,"UMLCallMessage"],["Reply Message",function(m,n,k,o,l){var h=m.getElementByPoint(n,k);var j=m.getElementByPoint(o,l);if(h!=j&&h!=null&&(h.getType()=="UMLLifeline"||h.getType()=="TimeInterval")&&(j.getType()=="UMLLifeline"||j.getType()=="TimeInterval")){m.addElement(new UMLReplyMessage({a:h,b:j,y:k}))}},2,"UMLReplyMessage"],["Delete Message",function(m,n,k,o,l){var h=m.getElementByPoint(n,k);var j=m.getElementByPoint(o,l);if(h&&j&&h!=j&&(h.getType()=="UMLLifeline"||h.getType()=="TimeInterval")&&j.getType()=="UMLLifeline"&&!j.getDelete()){m.addElement(new UMLDeleteMessage({a:h,b:j,y:k}))}},2,"UMLDeleteMessage"],];_acceptedDiagrams.push("UMLStateMachineDiagram");_acceptedElementsUML.push(["SimpleState","UMLSimpleState"],["CompositeState","UMLCompositeState"],["VerticalRegion","UMLVerticalRegion"],["HorizontalRegion","UMLHorizontalRegion"]);_genericMenu.push(["New State Machine diagram",function(b){b.addDiagram(new UMLStateMachineDiagram({backgroundNodes:ApplicationValues.element_color,stereotypes:_stereotypes}))},0,"UMLStateMachineDiagram"]);_specificMenu.UMLStateMachineDiagram=[["Initial State",function(d,e,f){d.addElement(new UMLInitialPseudostate({x:e,y:f}))},1,"UMLInitialPseudostate"],["Final State",function(d,e,f){d.addElement(new UMLFinalState({x:e,y:f}))},1,"UMLFinalState"],["Terminate",function(e,f,g){var h=new UMLTerminate({x:f,y:g});e.addElement(new UMLTerminate({x:f,y:g}))},1,"UMLTerminate"],["Entry Point",function(e,f,g){var h=new UMLEntryPoint({x:f,y:g});e.addElement(h)},1,"UMLEntryPoint"],["Exit Point",function(e,f,g){var h=new UMLExitPoint({x:f,y:g});e.addElement(h)},1,"UMLExitPoint"],["Junction",function(e,f,g){var h=new UMLJunction({x:f,y:g});e.addElement(h)},1,"UMLJunction"],["Simple State",function(e,f,g){var h=new UMLSimpleState({x:f,y:g});e.addElement(h)},1,"UMLSimpleState"],["Composite State",function(e,f,g){var h=new UMLCompositeState({x:f,y:g});e.addElement(h)},1,"UMLCompositeState"],["Vertical Region",function(e,f,g){var h=new UMLVerticalRegion({x:f,y:g});e.addElement(h)},1,"UMLVerticalRegion"],["Horizontal Region",function(e,f,g){var h=new UMLHorizontalRegion({x:f,y:g});e.addElement(h)},1,"UMLHorizontalRegion"],["Transition",function(k,f,h,g,j){k.addRelationFromPoints(new UMLTransition(),f,h,g,j)},2,"UMLTransition"]];_acceptedDiagrams.push("UMLActivityDiagram");_acceptedElementsUML.push(["AcceptEventAction","UMLAcceptEventAction"],["TimeEvent","UMLTimeEvent"],["SendSignalAction","UMLSendSignalAction"],["Action","UMLAction"],["ObjectNode","UMLObject"],["Activity","UMLActivity"],["DataStore","UMLDataStore"],["Connector","UMLConnectorActivity"],["HorizontalSwimlane","UMLHorizontalSwimlane"],["VerticalSwimlane","UMLVerticalSwimlane"],["Horizontal Hierarchical Swimlane","UMLHorizontalHierarchicalSwimlane"],["Vertical Hierarchical Swimlane","UMLVerticalHierarchicalSwimlane"]);_genericMenu.push(["New activity diagram",function(b){b.addDiagram(new UMLActivityDiagram({backgroundNodes:ApplicationValues.element_color,stereotypes:_stereotypes}))},0,"UMLActivityDiagram"]);_specificMenu.UMLActivityDiagram=[["AcceptEventAction",function(e,f,g){var h=new UMLAcceptEventAction({x:f,y:g});e.addElement(h)},1,"UMLAcceptEventAction"],["TimeEvent",function(e,f,g){var h=new UMLTimeEvent({x:f,y:g});e.addElement(h)},1,"UMLTimeEvent"],["SendSignalAction",function(e,f,g){var h=new UMLSendSignalAction({x:f,y:g});e.addElement(h)},1,"UMLSendSignalAction"],["Action",function(e,f,g){var h=new UMLAction({x:f,y:g});e.addElement(h)},1,"UMLAction"],["ObjectNode",function(e,f,g){var h=new UMLObject({x:f,y:g});e.addElement(h)},1,"UMLObject"],["Activity",function(e,f,g){var h=new UMLActivity({x:f,y:g});e.addElement(h)},1,"UMLActivity"],["DataStore",function(e,f,g){var h=new UMLDataStore({x:f,y:g});e.addElement(h)},1,"UMLDataStore"],["Connector",function(e,f,g){var h=new UMLConnectorActivity({x:f,y:g});e.addElement(h)},1,"UMLConnector2"],["HorizontalSwimlane",function(d,e,f){d.addElement(new UMLHorizontalSwimlane({x:e,y:f}))},1,"UMLHorizontalSwimlane"],["VerticalSwimlane",function(d,e,f){d.addElement(new UMLVerticalSwimlane({x:e,y:f}))},1,"UMLVerticalSwimlane"],["HorizontalHierarchicalSwimlane",function(e,f,g){var h=new UMLHorizontalHierarchicalSwimlane({x:f,y:g});e.addElement(h)},1,"UMLHorizontalHierarchicalSwimlane"],["VerticalHierarchicalSwimlane",function(e,f,g){var h=new UMLVerticalHierarchicalSwimlane({x:f,y:g});e.addElement(h)},1,"UMLVerticalHierarchicalSwimlane"],["Add Pin",function(f,g,h){var j=f.getElementByPoint(g,h);if(j!=null&&j.getType()=="UMLAction"){var k=new UMLPin();j.addPort(k)}},1,"UMLPin"],["Parameter Node",function(f,g,h){var j=f.getElementByPoint(g,h);if(j!=null&&j.getType()=="UMLActivity"){var k=new UMLParameterNode();j.addPort(k)}},1,"UMLParameterNode"],["Expansion Node",function(f,g,h){var j=f.getElementByPoint(g,h);if(j!=null&&j.getType()=="UMLAction"){var k=new UMLExpansionNode();j.addPort(k)}},1,"UMLExpansionNode"],["Flow/Edge",function(q,r,n,s,o){var k=q.getElementByPoint(r,n);var l=q.getElementByPoint(s,o);var m=0;var p=0;if(k instanceof NodeForkJoin){m=(k._quadrant==1)?(r-k._x):0;p=(k._quadrant==2)?(n-k._y):0}else{if(l instanceof NodeForkJoin){m=(l._quadrant==1)?(s-l._x):0;p=(l._quadrant==2)?(o-l._y):0}}if(k&&l&&!(k instanceof NodeForkJoin&&l instanceof NodeForkJoin)){q.addElement(new UMLFlow({a:k,b:l,y:p,x:m}))}},2,"UMLFlow"],["ExceptionHandler",function(k,f,h,g,j){k.addRelationFromPoints(new UMLExceptionHandler(),f,h,g,j)},2,"UMLExceptionHandler"],["ActivityFinal",function(d,e,f){d.addElement(new UMLActivityFinal({x:e,y:f}))},1,"UMLActivityFinal"],["InitialNode",function(d,e,f){d.addElement(new UMLInitialNode({x:e,y:f}))},1,"UMLInitialNode"],["FlowFinal",function(e,f,g){var h=new UMLFlowFinal({x:f,y:g});e.addElement(h)},1,"UMLFlowFinal"],["Decision/Merge Node",function(e,f,g){var h=new UMLDecision_MergeNode({x:f,y:g});e.addElement(h)},1,"UMLDecision_MergeNode"],["Fork/Join Node",function(d,e,f){d.addElement(new UMLFork_JoinNode({x:e,y:f}))},1,"UMLFork_JoinNode"]];_acceptedDiagrams.push("UMLProfile");Application.prototype.setProfileGenericMenu=function(){var b=this;_genericMenu.push(["New profile",function(a){a.addDiagram(new UMLProfile({backgroundNodes:ApplicationValues.element_color,diagrams:b._diagrams,validMetaclass:_acceptedElementsUML}))},0,"UMLProfile"])};_specificMenu.UMLProfile=[["Metaclass",function(h,f,g){var e=new UMLMetaclass({x:f,y:g});_metaclass.push(e);h.addElement(e)},1,"UMLMetaclass"],["Stereotype",function(e,f,g){var h=new UMLStereotype({x:f,y:g});_stereotypes.push(h);e.addElement(h)},1,"UMLStereotype"],["Extension",function(k,f,h,g,j){k.addRelationFromPoints(new UMLExtension(),f,h,g,j)},2,"UMLExtension"]];